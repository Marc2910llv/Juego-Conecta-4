000018FA Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 14/01/2023 21:31:42

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       : CUATRO EN RAYA
00000000                             3  ; AUTHOR      :
00000000                             4  ; ==============================================================================
00000000                             5  
00001000                             6              ORG     $1000
00001000                             7              
00001000                             8              INCLUDE "CONST.X68"
00001000                             9  ; ==============================================================================
00001000                            10  ; GAME CONSTANTS
00001000                            11  ; ==============================================================================
00001000                            12  
00001000                            13  ; --- BOX RELATED CONTANTS ----------------------------------------------------
00001000                            14  
00001000  =00000007                 15  BOXNCOL     EQU     7                       ; NUMBER OF BOXES IN A COLUMN
00001000  =00000006                 16  BOXNROW     EQU     6                       ; NUMBER OF BOXES IN A ROW
00001000  =00AA0000                 17  BOXPCOL     EQU     $00AA0000               ; BOXCONTOUR COLOR
00001000  =00000000                 18  BOXFCOL     EQU     $00000000               ; BOX FILL COLOR
00001000  =0000002D                 19  BOXRAD      EQU     45                      ; BOX RADIUS
00001000                            20  
00001000                            21  ; --- PIECE RELATED CONTANTS ----------------------------------------------------
00001000                            22  
00001000  =000000AA                 23  PIEPCOL1    EQU     $000000AA               ; PIECE CONTOUR COLOR TURN 1
00001000  =000000FF                 24  PIEFCOL1    EQU     $000000FF               ; PIECE FILL COLOR TURN 1
00001000  =0000AAAA                 25  PIEPCOL2    EQU     $0000AAAA               ; PIECE CONTOUR COLOR TURN 2
00001000  =0000FFFF                 26  PIEFCOL2    EQU     $0000FFFF               ; PIECE FILL COLOR TURN 2               
00001000  =00000000                 27  PIEPCOL3    EQU     $00000000               ; PIECE CONTOUR COLOR WIN
00001000  =003FEB1D                 28  PIEFCOL3    EQU     $003FEB1D               ; PIECE FILL COLOR WIN
00001000  =00000003                 29  PIESPEED    EQU     3                       ; MAGNITUDE OF THE FALL VEL.
00001000  =00000023                 30  PIERAD      EQU     35                      ; PIECE RADIUS
00001000                            31  
00001000                            32  ; --- TABLE RELATED CONSTANTS ----------------------------------------------------
00001000                            33  
00001000  =00FF0000                 34  TABPCOL     EQU     $00FF0000               ; TAB CONTOUR COLOR
00001000  =00AA0000                 35  TABFCOL     EQU     $00AA0000               ; TAB FILL COLOR
00001000                            36  
00001000                            37  ; --- BOARD RELATED CONSTANTS ---------------------------------------------
00001000                            38  
00001000  =00000000                 39  BOAFCOL     EQU     $00000000               ; TEXT BACKGROUND COLOR
00001000  =00000000                 40  BOALINE1    EQU     $0000                   ; FIRST TEXT LINE COORDINATES
00001000                            41  
00001000                            42  ; --- STATE RELATED CONSTANTS ---------------------------------------------------
00001000                            43  
00001000  =FFFFFFFF                 44  STANONE     EQU     -1                      ;NON-EXISTENT STATE NUMBER
00001000                            45  
00001000                            46  
00001000                            47  
00001000                            48  
00001000                            49  
00001000                            50  
00001000                            51  
00001000                            52  -------------------- end include --------------------
00001000                            53              INCLUDE "SYSCONST.X68"
00001000                            54  ; ==============================================================================
00001000                            55  ; SYSTEM CONSTANTS
00001000                            56  ; ==============================================================================
00001000                            57  
00001000                            58  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001000                            59  
00001000  =000003C0                 60  SCRWIDTH    EQU     960                     ; SCREEN WIDTH
00001000  =000002D0                 61  SCRHEIGH    EQU     720                     ; SCREEN HEIGHT
00001000                            62  
00001000                            63  ; --- KEYCODES -----------------------------------------------------------------
00001000                            64  
00001000  =00000025                 65  KBDLEFT     EQU     $25
00001000  =00000026                 66  KBDUP       EQU     $26
00001000  =00000027                 67  KBDRIGHT    EQU     $27
00001000  =00000028                 68  KBDDOWN     EQU     $28
00001000  =00000020                 69  KBDFIRE1    EQU     ' '
00001000  =0000004D                 70  KBDFIRE2    EQU     'M'
00001000  =00000010                 71  KBDFIRE3    EQU     $10
00001000  =00000050                 72  KBDPAUSE    EQU     'P'
00001000                            73  
00001000                            74  
00001000                            75  
00001000                            76  
00001000                            77  
00001000                            78  -------------------- end include --------------------
00001000                            79              INCLUDE "SYSTEM.X68"
00001000                            80  ; ==============================================================================
00001000                            81  ; SYSTEM
00001000                            82  ; ==============================================================================
00001000                            83              
00001000                            84  ; ------------------------------------------------------------------------------
00001000                            85  SYSINIT
00001000                            86  ; INITIALIZE SYSTEM.
00001000                            87  ; INPUT    : NONE
00001000                            88  ; OUTPUT   : NONE
00001000                            89  ; MODIFIES : NONE
00001000                            90  ; ------------------------------------------------------------------------------
00001000  4EB9 00001024             91              JSR     SCRINIT
00001006  4EB9 0000106C             92              JSR     KBDINIT
0000100C                            93              
0000100C  21FC 00001052 0080        94              MOVE.L  #SCRPLOT,($80)
00001014  21FC 0000107A 0084        95              MOVE.L  #KBDUPDATE,($84)
0000101C                            96              
0000101C  40E7                      97              MOVE.W  SR,-(A7)
0000101E  0257 DFFF                 98              ANDI.W  #$DFFF,(A7)
00001022  4E73                      99              RTE
00001024                           100              
00001024                           101  ; ------------------------------------------------------------------------------
00001024                           102  SCRINIT
00001024                           103  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN.
00001024                           104  ; INPUT    : NONE
00001024                           105  ; OUTPUT   : NONE
00001024                           106  ; MODIFIES : NONE
00001024                           107  ; ------------------------------------------------------------------------------
00001024                           108  
00001024  48E7 C000                109              MOVEM.L D0-D1,-(A7)
00001028                           110  
00001028                           111              ; SET SCREEN RESOLUTION
00001028  103C 0021                112              MOVE.B  #33,D0
0000102C  223C 03C002D0            113              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001032  4E4F                     114              TRAP    #15
00001034                           115              
00001034                           116              ; SET WINDOWED MODE
00001034  7201                     117              MOVE.L  #1,D1
00001036  4E4F                     118              TRAP    #15
00001038                           119              
00001038                           120              ; CLEAR SCREEN
00001038  103C 000B                121              MOVE.B  #11,D0
0000103C  323C FF00                122              MOVE.W  #$FF00,D1
00001040  4E4F                     123              TRAP    #15
00001042                           124              
00001042                           125              ; ENABLE DOUBLE BUFFER
00001042  103C 005C                126              MOVE.B #92,D0
00001046  123C 0011                127              MOVE.B #17,D1
0000104A  4E4F                     128              TRAP #15
0000104C                           129              
0000104C  4CDF 0003                130              MOVEM.L (A7)+,D0-D1
00001050                           131              
00001050  4E75                     132              RTS
00001052                           133              
00001052                           134  ; ------------------------------------------------------------------------------
00001052                           135  SCRPLOT
00001052                           136  ; UPDATES DOBLE BUFFER
00001052                           137  ; INPUT    : NONE
00001052                           138  ; OUTPUT   : NONE
00001052                           139  ; MODIFIES : NONE
00001052                           140  ; ------------------------------------------------------------------------------
00001052  48A7 C000                141              MOVEM.W D0-D1,-(A7)
00001056                           142  
00001056                           143              ; SWITCH BUFFERS
00001056  103C 005E                144              MOVE.B  #94,D0
0000105A  4E4F                     145              TRAP    #15
0000105C                           146              
0000105C                           147              ; CLEAR HIDDEN BUFFER
0000105C  103C 000B                148              MOVE.B  #11,D0
00001060  323C FF00                149              MOVE.W  #$FF00,D1
00001064  4E4F                     150              TRAP    #15
00001066                           151              
00001066  4C9F 0003                152              MOVEM.W (A7)+,D0-D1
0000106A                           153              
0000106A  4E73                     154              RTE 
0000106C                           155  
0000106C                           156              
0000106C                           157  ; ------------------------------------------------------------------------------
0000106C                           158  KBDINIT
0000106C                           159  ; INIT KEYBOOARD
0000106C                           160  ; INPUT    : NONE
0000106C                           161  ; OUTPUT   : NONE
0000106C                           162  ; MODIFIES : NONE
0000106C                           163  ; ------------------------------------------------------------------------------
0000106C  4239 000019E4            164              CLR.B   (KBDVAL)
00001072  4239 000019E5            165              CLR.B   (KBDEDGE)
00001078  4E75                     166              RTS
0000107A                           167              
0000107A                           168  ; ------------------------------------------------------------------------------
0000107A                           169  KBDUPDATE
0000107A                           170  ; UPDATE KEYBOARD INFO.  
0000107A                           171  ; 7 -> PAUSE
0000107A                           172  ; 6 -> FIRE 3
0000107A                           173  ; 5 -> FIRE 2
0000107A                           174  ; 4 -> FIRE 1
0000107A                           175  ; 3 -> DOWN
0000107A                           176  ; 2 -> RIGHT
0000107A                           177  ; 1 -> UP
0000107A                           178  ; 0 -> LEFT
0000107A                           179  ; INPUT    : NONE
0000107A                           180  ; OUTPUT   : NONE
0000107A                           181  ; MODIFIES : NONE
0000107A                           182  ; ------------------------------------------------------------------------------
0000107A                           183  
0000107A  48E7 F000                184              MOVEM.L D0-D3,-(A7)
0000107E                           185  
0000107E                           186              ; READ FIRST PART
0000107E  103C 0013                187              MOVE.B  #19,D0
00001082  223C 50104D20            188              MOVE.L  #KBDPAUSE<<24|KBDFIRE3<<16|KBDFIRE2<<8|KBDFIRE1,D1
00001088  4E4F                     189              TRAP    #15
0000108A                           190              
0000108A                           191              ; CONVERT TO DESIRED FORMAT
0000108A  4EB9 000010BA            192              JSR     .PACK
00001090                           193  
00001090                           194              ; READ SECOND PART
00001090  223C 28272625            195              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
00001096  4E4F                     196              TRAP    #15
00001098                           197  
00001098                           198              ; CONVERT TO DESIRED FORMAT
00001098  4EB9 000010BA            199              JSR     .PACK
0000109E                           200              
0000109E                           201              ; COMPUTE KBDEDGE
0000109E  1039 000019E4            202              MOVE.B  (KBDVAL),D0
000010A4  4600                     203              NOT.B   D0
000010A6  C002                     204              AND.B   D2,D0
000010A8  13C0 000019E5            205              MOVE.B  D0,(KBDEDGE)
000010AE                           206              
000010AE                           207              ; STORE KBDVAL
000010AE  13C2 000019E4            208              MOVE.B  D2,(KBDVAL)
000010B4                           209              
000010B4  4CDF 000F                210              MOVEM.L (A7)+,D0-D3
000010B8                           211  
000010B8  4E73                     212              RTE
000010BA                           213              
000010BA  363C 0003                214  .PACK       MOVE.W  #3,D3
000010BE  E189                     215  .LOOP       LSL.L   #8,D1
000010C0  E312                     216              ROXL.B  #1,D2
000010C2  51CB FFFA                217              DBRA.W  D3,.LOOP
000010C6  4E75                     218              RTS
000010C8                           219  
000010C8                           220              
000010C8                           221              
000010C8                           222  
000010C8                           223  
000010C8                           224  -------------------- end include --------------------
000010C8                           225              INCLUDE "LIB/UTLCONST.X68"
000010C8                           226  ;----------------------------------------------------------------
000010C8                           227  ;UTIL CONSTANTS
000010C8                           228  ;----------------------------------------------------------------
000010C8  =00000008                229  UTLCHRWD    EQU     8                       ;CHARACTER WIDTH IN PIXELS
000010C8  =00000008                230  -------------------- end include --------------------
000010C8                           231              INCLUDE "LIB/UTLCODE.X68"
000010C8                           232  ; =============================================================================
000010C8                           233  ; UTILITY CODE
000010C8                           234  ; =============================================================================
000010C8                           235  
000010C8                           236  ; -----------------------------------------------------------------------------
000010C8                           237  UTLINIT
000010C8                           238  ; INITIALIZES UTILITY CODE
000010C8                           239  ; INPUT    - NONE
000010C8                           240  ; OUTPUT   - NONE
000010C8                           241  ; MODIFIES - NONE
000010C8                           242  ; -----------------------------------------------------------------------------
000010C8  48E7 C000                243              MOVEM.L D0-D1,-(A7)
000010CC  103C 0008                244              MOVE.B  #8,D0
000010D0  4E4F                     245              TRAP    #15
000010D2  13C1 00001106            246              MOVE.B  D1,(UTLRNDIX)
000010D8  4CDF 0003                247              MOVEM.L (A7)+,D0-D1
000010DC  4E75                     248              RTS
000010DE                           249  ; -----------------------------------------------------------------------------
000010DE                           250  UTLPRINT
000010DE                           251  ; PRINT SCREEN CENTERED TEXT
000010DE                           252  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
000010DE                           253  ;            D0.B SCREEN ROW TO PRINT TEXT
000010DE                           254  ; OUTPUT   : D0.B NEXT ROW
000010DE                           255  ; MODIFIES : NONE (ASIDE OF OUTPUT)
000010DE                           256  ; -----------------------------------------------------------------------------
000010DE  48E7 C0C0                257              MOVEM.L D0-D1/A0-A1,-(A7)
000010E2                           258              
000010E2  4201                     259              CLR.B   D1
000010E4  2248                     260              MOVE.L  A0,A1
000010E6  4A18                     261  .LOOP       TST.B   (A0)+
000010E8  6700 0006                262              BEQ     .ENDLOOP
000010EC  5201                     263              ADDQ.B  #1,D1
000010EE  60F6                     264              BRA     .LOOP
000010F0                           265              
000010F0  E209                     266  .ENDLOOP    LSR.B   #1,D1
000010F2  0401 003C                267              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
000010F6  4401                     268              NEG.B   D1
000010F8  E141                     269              ASL.W   #8,D1
000010FA  8240                     270              OR.W    D0,D1
000010FC  4E4F                     271              TRAP    #15
000010FE                           272              
000010FE  4CDF 0303                273              MOVEM.L (A7)+,D0-D1/A0-A1
00001102  5200                     274              ADDQ.B  #1,D0
00001104  4E75                     275              RTS
00001106                           276  
00001106                           277  ; -----------------------------------------------------------------------------
00001106                           278  
00001106                           279  
00001106                           280  
00001106                           281  -------------------- end include --------------------
00001106                           282              INCLUDE "LIB/UTLVARS.X68"
00001106                           283  ; =============================================================================
00001106                           284  ; UTILITY VARIABLES
00001106                           285  ; =============================================================================
00001106                           286  
00001106                           287  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001108                           288              DS.W    0
00001108                           289  -------------------- end include --------------------
00001108                           290              INCLUDE "BOX.X68"
00001108                           291  ; ==============================================================================
00001108                           292  ; BOX MANAGEMENT
00001108                           293  ; ==============================================================================
00001108                           294              
00001108                           295  ; ------------------------------------------------------------------------------
00001108                           296  BOXINIT
00001108                           297  ; INITIALIZE BOX.
00001108                           298  ; INPUT    : NONE 
00001108                           299  ; OUTPUT   : NONE
00001108                           300  ; MODIFIES : NONE
00001108                           301  ; ------------------------------------------------------------------------------
00001108                           302              
00001108  33FC 0083 00001920       303              MOVE.W  #BOXRAD*2+41,(BOXPOSX)
00001110  33FC 0064 00001922       304              MOVE.W  #BOXRAD*2+10,(BOXPOSY)
00001118                           305              
00001118  4E75                     306              RTS
0000111A                           307              
0000111A                           308  ; ------------------------------------------------------------------------------
0000111A                           309  BOXUPD
0000111A                           310  ; UPDATES THE BOX.
0000111A                           311  ; INPUT    : NONE 
0000111A                           312  ; OUTPUT   : NONE
0000111A                           313  ; MODIFIES : NONE
0000111A                           314  ; ------------------------------------------------------------------------------
0000111A  4E75                     315              RTS
0000111C                           316              
0000111C                           317  ; ------------------------------------------------------------------------------
0000111C                           318  BOXPLOT
0000111C                           319  ; PLOT THE BOX.
0000111C                           320  ; INPUT    : NONE 
0000111C                           321  ; OUTPUT   : NONE
0000111C                           322  ; MODIFIES : NONE
0000111C                           323  ; ------------------------------------------------------------------------------
0000111C  48E7 FE40                324              MOVEM.L D0-D6/A1,-(A7)
00001120                           325  
00001120                           326              ; SET PEN COLOR
00001120  103C 0050                327              MOVE.B  #80,D0
00001124  223C 00AA0000            328              MOVE.L  #BOXPCOL,D1
0000112A  4E4F                     329              TRAP    #15
0000112C                           330              
0000112C                           331              ; SET FILL COLOR
0000112C  103C 0051                332              MOVE.B  #81,D0
00001130  7200                     333              MOVE.L  #BOXFCOL,D1                                                                     
00001132  4E4F                     334              TRAP    #15                                                                             
00001134                           335              
00001134                           336              ; DEFINE COORDINATES
00001134  3239 00001920            337              MOVE.W  (BOXPOSX),D1
0000113A  3439 0000191C            338              MOVE.W  (BOXCOL),D2
00001140  C3C2                     339              MULS.W  D2,D1
00001142  0441 005A                340              SUB.W   #BOXRAD*2,D1
00001146                           341              
00001146  3439 00001922            342              MOVE.W  (BOXPOSY),D2
0000114C  3639 0000191E            343              MOVE.W  (BOXROW),D3
00001152  C5C3                     344              MULS.W  D3,D2
00001154  0642 005A                345              ADD.W   #PIERAD*2+20,D2
00001158  0442 0055                346              SUB.W   #BOXRAD*2-5,D2
0000115C                           347              
0000115C  3601                     348              MOVE.W  D1,D3
0000115E  0643 005A                349              ADD.W   #BOXRAD*2,D3
00001162                           350              
00001162  3802                     351              MOVE.W  D2,D4
00001164  0644 005A                352              ADD.W   #BOXRAD*2,D4
00001168                           353              
00001168                           354              ; DRAW CIRCLE
00001168  103C 0058                355              MOVE.B  #88,D0
0000116C  4E4F                     356              TRAP    #15
0000116E                           357              
0000116E  43F9 00001930            358              LEA.L   ROW1,A1
00001174  3639 0000191C            359              MOVE.W  (BOXCOL),D3
0000117A  3839 0000191E            360              MOVE.W  (BOXROW),D4
00001180  5343                     361              SUBQ.W  #1,D3
00001182  5344                     362              SUBQ.W  #1,D4
00001184  D2C3                     363              ADD.W   D3,A1   
00001186  C9FC 0007                364              MULS.W  #7,D4
0000118A  D2C4                     365              ADD.W   D4,A1
0000118C                           366              
0000118C  0C11 0000                367              CMP.B   #0,(A1)
00001190  6700 0016                368              BEQ     .EMPTY
00001194  3A01                     369              MOVE.W  D1,D5
00001196  0645 002D                370              ADD.W   #BOXRAD,D5
0000119A  3C02                     371              MOVE.W  D2,D6
0000119C  0646 002D                372              ADD.W   #BOXRAD,D6
000011A0  1011                     373              MOVE.B  (A1),D0
000011A2  4EB9 000012E8            374              JSR     PIEPLOT
000011A8                           375              
000011A8                           376  .EMPTY
000011A8  4CDF 027F                377              MOVEM.L (A7)+,D0-D6/A1
000011AC                           378  
000011AC  4E75                     379              RTS
000011AE                           380  
000011AE                           381  
000011AE                           382  
000011AE                           383  
000011AE                           384  
000011AE                           385  
000011AE                           386  
000011AE                           387  
000011AE                           388  
000011AE                           389  
000011AE                           390  -------------------- end include --------------------
000011AE                           391              INCLUDE "TABLE.X68"
000011AE                           392  ; ==============================================================================
000011AE                           393  ; TABLE MANAGEMENT
000011AE                           394  ; ==============================================================================
000011AE                           395              
000011AE                           396  ; ------------------------------------------------------------------------------
000011AE                           397  TABINIT
000011AE                           398  ; INITIALIZE TABLE.
000011AE                           399  ; INPUT    : NONE 
000011AE                           400  ; OUTPUT   : NONE
000011AE                           401  ; MODIFIES : NONE
000011AE                           402  ; ------------------------------------------------------------------------------
000011AE                           403  
000011AE  48E7 8040                404              MOVEM.L D0/A1,-(A7)
000011B2                           405  
000011B2                           406              ;INITIALICE ROWS VALUES
000011B2  303C 0029                407              MOVE.W  #6*7-1,D0
000011B6  43F9 00001930            408              LEA.L   ROW1,A1
000011BC                           409  .LOOP       
000011BC  12BC 0000                410              MOVE.B  #0,(A1)
000011C0  5289                     411              ADD.L  #1,A1
000011C2  51C8 FFF8                412              DBRA    D0,.LOOP
000011C6                           413  
000011C6  4CDF 0201                414              MOVEM.L (A7)+,D0/A1
000011CA                           415  
000011CA  4E75                     416              RTS
000011CC                           417              
000011CC                           418  ; ------------------------------------------------------------------------------
000011CC                           419  TABPLOT
000011CC                           420  ; PLOT THE TABLE.
000011CC                           421  ; INPUT    : NONE 
000011CC                           422  ; OUTPUT   : NONE
000011CC                           423  ; MODIFIES : NONE
000011CC                           424  ; ------------------------------------------------------------------------------
000011CC                           425  
000011CC  48E7 F800                426              MOVEM.L D0-D4,-(A7)
000011D0                           427  
000011D0                           428              ; SET CONTOUR COLOR
000011D0  103C 0050                429              MOVE.B  #80,D0
000011D4  223C 00FF0000            430              MOVE.L  #TABPCOL,D1
000011DA  4E4F                     431              TRAP    #15
000011DC                           432              
000011DC                           433              ; SET FILL COLOR
000011DC  103C 0051                434              MOVE.B  #81,D0
000011E0  223C 00AA0000            435              MOVE.L  #TABFCOL,D1
000011E6  4E4F                     436              TRAP    #15
000011E8                           437              
000011E8                           438              ; DEFINE COORDINATES
000011E8  323C 0005                439              MOVE.W  #5,D1
000011EC  343C 005A                440              MOVE.W  #PIERAD*2+20,D2
000011F0  363C 03BB                441              MOVE.W  #SCRWIDTH-5,D3
000011F4  383C 02CB                442              MOVE.W  #SCRHEIGH-5,D4
000011F8                           443              
000011F8                           444              ; DRAW RECTANGLE
000011F8  103C 0057                445              MOVE.B  #87,D0
000011FC  4E4F                     446              TRAP    #15
000011FE                           447              
000011FE  4CDF 001F                448              MOVEM.L (A7)+,D0-D4
00001202                           449  
00001202  4E75                     450              RTS
00001204                           451  
00001204                           452  
00001204                           453  
00001204                           454  
00001204                           455  
00001204                           456  
00001204                           457  
00001204                           458  
00001204                           459  
00001204                           460  
00001204                           461  
00001204                           462  
00001204                           463  
00001204                           464  
00001204                           465  
00001204                           466  -------------------- end include --------------------
00001204                           467              INCLUDE "PIECE.X68"
00001204                           468  ; ==============================================================================
00001204                           469  ; PIECE MANAGEMENT
00001204                           470  ; ==============================================================================
00001204                           471              
00001204                           472  ; ------------------------------------------------------------------------------
00001204                           473  PIEINIT
00001204                           474  ; INITIALIZE THE PIECE.
00001204                           475  ; INPUT    : NONE 
00001204                           476  ; OUTPUT   : NONE
00001204                           477  ; MODIFIES : NONE
00001204                           478  ; ------------------------------------------------------------------------------
00001204                           479  
00001204  33FC 01DF 00001924       480              MOVE.W  #SCRWIDTH/2-1,(PIEPOSX)
0000120C  33FC 002D 00001926       481              MOVE.W  #PIERAD+10,(PIEPOSY)
00001214                           482              
00001214  33F9 00001920 00001928   483              MOVE.W  (BOXPOSX),(PIEVELX)
0000121E  33FC 0064 0000192A       484              MOVE.W  #100,(PIEVELY)
00001226                           485              
00001226  33FC 0003 0000192C       486              MOVE.W  #3,(POSX)
0000122E  33FC FFFF 0000192E       487              MOVE.W  #-1,(POSY)
00001236                           488              
00001236  4E75                     489              RTS
00001238                           490              
00001238                           491  ; ------------------------------------------------------------------------------
00001238                           492  PIEUPD
00001238                           493  ; UPDATE THE PIECE.
00001238                           494  ; INPUT    : NONE 
00001238                           495  ; OUTPUT   : NONE
00001238                           496  ; MODIFIES : NONE
00001238                           497  ; ------------------------------------------------------------------------------
00001238                           498              
00001238  48A7 E000                499              MOVEM.W  D0-D2,-(A7)
0000123C                           500              
0000123C                           501              ; UPDATE X POSITION
0000123C  3039 00001924            502              MOVE.W  (PIEPOSX),D0
00001242                           503              
00001242                           504              ; CHECK LEFT ARROW KEY
00001242  0839 0000 000019E5       505              BTST.B  #0,(KBDEDGE)
0000124A  6700 000E                506              BEQ     .CHKRIGHT
0000124E  9079 00001928            507              SUB.W   (PIEVELX),D0
00001254  5379 0000192C            508              SUBQ.W  #1,(POSX)
0000125A                           509              
0000125A                           510              ;CHECK  RIGHT ARROW KEY
0000125A  0839 0002 000019E5       511  .CHKRIGHT   BTST.B  #2,(KBDEDGE)
00001262  6700 000E                512              BEQ     .CHKSPACE
00001266  D079 00001928            513              ADD.W   (PIEVELX),D0
0000126C  5279 0000192C            514              ADDQ.W  #1,(POSX)
00001272                           515              
00001272                           516              ; CHECK SPACE KEY
00001272  0839 0004 000019E5       517  .CHKSPACE   BTST.B  #4,(KBDEDGE)
0000127A  6700 0024                518              BEQ     .CONT
0000127E  4EB9 00001370            519              JSR     PIEFALL
00001284  4EB9 000013EA            520              JSR     CHKCOL                  ;CHECK 4 CONNECT IN COLUMNS
0000128A  4EB9 0000144A            521              JSR     CHKROW                  ;CHECK 4 CONNECT IN ROWS
00001290  4EB9 000014A4            522              JSR     CHKDIA                  ;CHECK 4 CONNECT IN DIAGONALS
00001296  4EB9 0000157C            523              JSR     PLAUPD
0000129C  6000 0040                524              BRA     .DONE2
000012A0                           525              
000012A0                           526              ; CHECK COLISIONS
000012A0  3239 00001928            527  .CONT       MOVE.W  (PIEVELX),D1
000012A6  0441 002C                528              SUB.W   #BOXRAD-1,D1
000012AA  B041                     529              CMP.W   D1,D0
000012AC  6C00 000E                530              BGE     .CONT2
000012B0  3001                     531              MOVE.W  D1,D0
000012B2  4279 0000192C            532              CLR.W   (POSX)
000012B8  6000 0018                533              BRA     .DONE
000012BC                           534              
000012BC  343C 03C0                535  .CONT2      MOVE.W  #SCRWIDTH,D2
000012C0  9441                     536              SUB.W   D1,D2
000012C2  B042                     537              CMP.W   D2,D0
000012C4  6F00 000C                538              BLE     .DONE
000012C8  3002                     539              MOVE.W  D2,D0
000012CA  33FC 0006 0000192C       540              MOVE.W  #6,(POSX)
000012D2                           541  
000012D2                           542              ; UPDATE VARIABLE
000012D2  33C0 00001924            543  .DONE       MOVE.W  D0,(PIEPOSX) 
000012D8                           544  
000012D8  4C9F 0007                545              MOVEM.W  (A7)+,D0-D2             
000012DC                           546  
000012DC  4E75                     547              RTS
000012DE                           548              
000012DE  4EB8 1204                549  .DONE2      JSR     PIEINIT
000012E2                           550  
000012E2  4C9F 0007                551              MOVEM.W  (A7)+,D0-D2          
000012E6                           552  
000012E6  4E75                     553              RTS
000012E8                           554              
000012E8                           555  ; ------------------------------------------------------------------------------
000012E8                           556  PIEPLOT
000012E8                           557  ; PLOT THE PIECE.
000012E8                           558  ; INPUT    : D5 AS COORDINATE X OF PIECE, D6 AS COORDINATE Y OF PIECE,
000012E8                           559  ;            D0 INDICATES COLOR OF THE PIECE
000012E8                           560  ; OUTPUT   : NONE
000012E8                           561  ; MODIFIES : NONE
000012E8                           562  ; ------------------------------------------------------------------------------
000012E8  48E7 7800                563              MOVEM.L D1-D4,-(A7)
000012EC                           564  
000012EC  B03C 0001                565              CMP.B   #1,D0
000012F0  6700 0026                566              BEQ     .COLOR1
000012F4  B03C 0015                567              CMP.B   #21,D0
000012F8  6700 003A                568              BEQ     .COLORWINNER
000012FC                           569              
000012FC                           570              ; SET PEN COLOR
000012FC  103C 0050                571              MOVE.B  #80,D0
00001300  223C 0000AAAA            572              MOVE.L  #PIEPCOL2,D1
00001306  4E4F                     573              TRAP    #15
00001308                           574              
00001308                           575              ; SET FILL COLOR
00001308  103C 0051                576              MOVE.B  #81,D0
0000130C  223C 0000FFFF            577              MOVE.L  #PIEFCOL2,D1
00001312  4E4F                     578              TRAP    #15
00001314                           579              
00001314  6000 0036                580              BRA     .JUMP
00001318                           581              
00001318                           582  .COLOR1            
00001318                           583              ; SET PEN COLOR
00001318  103C 0050                584              MOVE.B  #80,D0
0000131C  223C 000000AA            585              MOVE.L  #PIEPCOL1,D1
00001322  4E4F                     586              TRAP    #15
00001324                           587              
00001324                           588              ; SET FILL COLOR
00001324  103C 0051                589              MOVE.B  #81,D0
00001328  223C 000000FF            590              MOVE.L  #PIEFCOL1,D1
0000132E  4E4F                     591              TRAP    #15
00001330                           592              
00001330  6000 001A                593              BRA     .JUMP
00001334                           594  
00001334                           595  .COLORWINNER
00001334                           596              ; SET PEN COLOR
00001334  103C 0050                597              MOVE.B  #80,D0
00001338  7200                     598              MOVE.L  #PIEPCOL3,D1
0000133A  4E4F                     599              TRAP    #15
0000133C                           600              
0000133C                           601              ; SET FILL COLOR
0000133C  103C 0051                602              MOVE.B  #81,D0
00001340  223C 003FEB1D            603              MOVE.L  #PIEFCOL3,D1
00001346  4E4F                     604              TRAP    #15
00001348                           605              
00001348  6000 0002                606              BRA     .JUMP
0000134C                           607  
0000134C                           608  .JUMP            
0000134C                           609              ; DEFINE COORDINATES
0000134C  3205                     610              MOVE.W  D5,D1
0000134E  0441 0023                611              SUB.W   #PIERAD,D1
00001352                           612              
00001352  3406                     613              MOVE.W  D6,D2
00001354  0442 0023                614              SUB.W   #PIERAD,D2
00001358                           615              
00001358  3605                     616              MOVE.W  D5,D3
0000135A  0643 0023                617              ADD.W   #PIERAD,D3
0000135E                           618              
0000135E  3806                     619              MOVE.W  D6,D4
00001360  0644 0023                620              ADD.W   #PIERAD,D4
00001364                           621              
00001364                           622              ; DRAW PIECE
00001364  103C 0058                623              MOVE.B  #88,D0
00001368  4E4F                     624              TRAP    #15
0000136A                           625              
0000136A  4CDF 001E                626              MOVEM.L (A7)+,D1-D4
0000136E                           627  
0000136E  4E75                     628              RTS
00001370                           629              
00001370                           630  ; ------------------------------------------------------------------------------
00001370                           631  PIEFALL
00001370                           632  ; LET A PIECE FALL IN A COLUMN
00001370                           633  ; INPUT    : NONE
00001370                           634  ; OUTPUT   : NONE
00001370                           635  ; MODIFIES : NONE
00001370                           636  ; ------------------------------------------------------------------------------
00001370                           637              
00001370  48E7 F840                638              MOVEM.L D0-D4/A1,-(A7)
00001374                           639              
00001374  3639 0000192A            640              MOVE.W  (PIEVELY),D3
0000137A  343C 0005                641              MOVE.W  #5,D2
0000137E  323C 0005                642              MOVE.W  #5,D1                  ;WAIT TO SEE THE PIECE FALL (MS)
00001382                           643              
00001382  43F9 00001930            644  .FALLAGAIN  LEA.L   ROW1,A1
00001388  5279 0000192E            645              ADDQ.W  #1,(POSY)
0000138E  3839 0000192E            646              MOVE.W  (POSY),D4
00001394  C9FC 0007                647              MULS.W  #7,D4
00001398  D2C4                     648              ADD.W   D4,A1
0000139A  3839 0000192C            649              MOVE.W  (POSX),D4
000013A0  D2C4                     650              ADD.W   D4,A1
000013A2  0C11 0000                651              CMP.B   #0,(A1)
000013A6  6600 0038                652              BNE     .OTHERPIE
000013AA                           653              
000013AA  303C 0017                654              MOVE.W  #23,D0
000013AE  4E4F                     655              TRAP    #15
000013B0  D779 00001926            656              ADD.W   D3,(PIEPOSY)
000013B6  0C79 0000 0000192E       657              CMP.W   #0,(POSY)
000013BE  6600 0008                658              BNE     .PASS
000013C2  5A79 00001926            659              ADDQ.W  #5,(PIEPOSY)
000013C8  4EB9 000016B2            660  .PASS       JSR     GAMPLOT
000013CE  4E40                     661              TRAP    #0
000013D0  51CA FFB0                662              DBRA    D2,.FALLAGAIN
000013D4                           663              
000013D4  12B9 0000195A            664  .END        MOVE.B  (TURN),(A1)
000013DA                           665  
000013DA  4CDF 021F                666              MOVEM.L (A7)+,D0-D4/A1
000013DE                           667  
000013DE  4E75                     668              RTS
000013E0                           669  
000013E0  5F49                     670  .OTHERPIE   SUB.W   #7,A1
000013E2  5379 0000192E            671              SUBQ.W  #1,(POSY)
000013E8  60EA                     672              BRA     .END
000013EA                           673              
000013EA                           674  ; ------------------------------------------------------------------------------
000013EA                           675  CHKCOL
000013EA                           676  ; CHECK IF SOME COLUMN HAVE 4 PIECES CONNECTED
000013EA                           677  ; INPUT    : NONE
000013EA                           678  ; OUTPUT   : NONE
000013EA                           679  ; MODIFIES : NONE
000013EA                           680  ; ------------------------------------------------------------------------------
000013EA                           681  
000013EA  48E7 E070                682              MOVEM.L D0-D2/A1-A3,-(A7)
000013EE                           683              
000013EE  43F9 00001930            684              LEA.L   ROW1,A1
000013F4  7006                     685              MOVE.L  #BOXNCOL-1,D0
000013F6                           686  .CHECK_NEXT_COL
000013F6  2449                     687              MOVE.L  A1,A2
000013F8  5289                     688              ADD.L   #1,A1
000013FA  7202                     689              MOVE.L  #BOXNROW-3-1,D1
000013FC                           690              
000013FC                           691  .CHECK_POSITION_COL
000013FC  264A                     692              MOVE.L  A2,A3
000013FE  5E8A                     693              ADD.L   #7,A2
00001400                           694              
00001400  4282                     695              CLR.L   D2
00001402  1413                     696              MOVE.B  (A3),D2
00001404  5E8B                     697              ADD.L   #7,A3
00001406  D413                     698              ADD.B   (A3),D2
00001408  5E8B                     699              ADD.L   #7,A3
0000140A  D413                     700              ADD.B   (A3),D2
0000140C  5E8B                     701              ADD.L   #7,A3
0000140E  D413                     702              ADD.B   (A3),D2
00001410                           703              
00001410  B43C 0004                704              CMP.B   #4,D2
00001414  6700 0018                705              BEQ     .PLAYERWINS_COL
00001418  B43C 0014                706              CMP.B   #20,D2
0000141C  6700 0010                707              BEQ     .PLAYERWINS_COL
00001420                           708              
00001420  51C9 FFDA                709              DBRA    D1,.CHECK_POSITION_COL
00001424                           710              
00001424  51C8 FFD0                711              DBRA    D0,.CHECK_NEXT_COL
00001428                           712              
00001428  4CDF 0E07                713              MOVEM.L (A7)+,D0-D2/A1-A3
0000142C                           714              
0000142C  4E75                     715              RTS
0000142E                           716              
0000142E                           717  .PLAYERWINS_COL
0000142E  13F9 0000195A 0000195B   718              MOVE.B  (TURN),(WINNER)  
00001438                           719  
00001438  7003                     720              MOVE.L  #3,D0
0000143A                           721  .LOOP_COL
0000143A  16BC 0015                722              MOVE.B  #21,(A3)
0000143E  5F8B                     723              SUB.L   #7,A3
00001440  51C8 FFF8                724              DBRA    D0,.LOOP_COL
00001444                           725                      
00001444  4CDF 0E07                726              MOVEM.L (A7)+,D0-D2/A1-A3
00001448  4E75                     727              RTS
0000144A                           728  
0000144A                           729  ; ------------------------------------------------------------------------------
0000144A                           730  CHKROW
0000144A                           731  ; CHECK IF SOME ROW HAVE 4 PIECES CONNECTED
0000144A                           732  ; INPUT    : NONE
0000144A                           733  ; OUTPUT   : NONE
0000144A                           734  ; MODIFIES : NONE
0000144A                           735  ; ------------------------------------------------------------------------------
0000144A                           736  
0000144A  48E7 E070                737              MOVEM.L D0-D2/A1-A3,-(A7)
0000144E                           738              
0000144E  43F9 00001930            739              LEA.L   ROW1,A1
00001454  7005                     740              MOVE.L  #BOXNROW-1,D0
00001456                           741  .CHECK_NEXT_ROW
00001456  2449                     742              MOVE.L  A1,A2
00001458  5E89                     743              ADD.L   #7,A1
0000145A  7203                     744              MOVE.L  #BOXNCOL-3-1,D1
0000145C                           745              
0000145C                           746  .CHECK_POSITION_ROW
0000145C  264A                     747              MOVE.L  A2,A3
0000145E  528A                     748              ADD.L   #1,A2
00001460                           749              
00001460  4282                     750              CLR.L   D2
00001462  141B                     751              MOVE.B   (A3)+,D2
00001464  D41B                     752              ADD.B   (A3)+,D2
00001466  D41B                     753              ADD.B   (A3)+,D2
00001468  D413                     754              ADD.B   (A3),D2
0000146A                           755              
0000146A  B43C 0004                756              CMP.B   #4,D2
0000146E  6700 0018                757              BEQ     .PLAYERWINS_ROW
00001472  B43C 0014                758              CMP.B   #20,D2
00001476  6700 0010                759              BEQ     .PLAYERWINS_ROW
0000147A                           760              
0000147A  51C9 FFE0                761              DBRA    D1,.CHECK_POSITION_ROW
0000147E                           762              
0000147E  51C8 FFD6                763              DBRA    D0,.CHECK_NEXT_ROW
00001482                           764              
00001482  4CDF 0E07                765              MOVEM.L (A7)+,D0-D2/A1-A3
00001486                           766              
00001486  4E75                     767              RTS
00001488                           768  
00001488                           769  .PLAYERWINS_ROW
00001488  13F9 0000195A 0000195B   770              MOVE.B  (TURN),(WINNER)
00001492                           771              
00001492  7003                     772              MOVE.L  #3,D0
00001494                           773  .LOOP_ROW
00001494  16BC 0015                774              MOVE.B  #21,(A3)
00001498  538B                     775              SUB.L   #1,A3
0000149A  51C8 FFF8                776              DBRA    D0,.LOOP_ROW
0000149E                           777              
0000149E  4CDF 0E07                778              MOVEM.L (A7)+,D0-D2/A1-A3
000014A2  4E75                     779              RTS
000014A4                           780  
000014A4                           781  ; ------------------------------------------------------------------------------
000014A4                           782  CHKDIA
000014A4                           783  ; CHECK IF SOME DIAGONAL HAVE 4 PIECES CONNECTED
000014A4                           784  ; INPUT    : NONE
000014A4                           785  ; OUTPUT   : NONE
000014A4                           786  ; MODIFIES : NONE
000014A4                           787  ; ------------------------------------------------------------------------------
000014A4                           788  
000014A4  48E7 FE70                789              MOVEM.L D0-D6/A1-A3,-(A7)
000014A8                           790              
000014A8  43F9 00001930            791              LEA.L   ROW1,A1
000014AE                           792             
000014AE  7C08                     793              MOVE.L  #8,D6
000014B0  7201                     794              MOVE.L  #1,D1
000014B2                           795  .LOOP_TO_OTHER_SIDE 
000014B2                           796             
000014B2  7A07                     797              MOVE.L  #7,D5
000014B4  7401                     798              MOVE.L  #1,D2
000014B6                           799  .LOOP_DIAGONALS_ROW1
000014B6                           800  
000014B6  2449                     801              MOVE.L  A1,A2
000014B8                           802              ;DIAGONAL OF (0,0) AND (6,0) / (1,0) AND (5,0)            
000014B8  7602                     803              MOVE.L  #2,D3
000014BA                           804  .LOOP1
000014BA  264A                     805              MOVE.L  A2,A3
000014BC  D5C6                     806              ADD.L   D6,A2
000014BE                           807              
000014BE  4EB9 00001532            808              JSR     CHECK_DIAGONALS
000014C4  0C39 0000 0000195B       809              CMP.B   #0,(WINNER)
000014CC  6600 005E                810              BNE     .FINISH_DIA
000014D0                           811             
000014D0  51CB FFE8                812              DBRA    D3,.LOOP1
000014D4                           813              
000014D4                           814              ;DIAGONAL OF (0,1) AND (6,1) / (2,0) AND (4,0)
000014D4  2449                     815              MOVE.L  A1,A2
000014D6  D5C5                     816              ADD.L   D5,A2
000014D8                           817              
000014D8  7601                     818              MOVE.L  #1,D3
000014DA                           819  .LOOP2
000014DA  264A                     820              MOVE.L  A2,A3
000014DC  D5C6                     821              ADD.L   D6,A2
000014DE                           822              
000014DE  4EB9 00001532            823              JSR     CHECK_DIAGONALS
000014E4  0C39 0000 0000195B       824              CMP.B   #0,(WINNER)
000014EC  6600 003E                825              BNE     .FINISH_DIA
000014F0                           826             
000014F0  51CB FFE8                827              DBRA    D3,.LOOP2
000014F4                           828              
000014F4                           829              ;DIAGONAL OF (0,2) AND (6,2) / (3,0)
000014F4  2649                     830              MOVE.L  A1,A3
000014F6  D7C5                     831              ADD.L   D5,A3
000014F8  D7C5                     832              ADD.L   D5,A3
000014FA                           833              
000014FA  4EB9 00001532            834              JSR     CHECK_DIAGONALS
00001500  0C39 0000 0000195B       835              CMP.B   #0,(WINNER)
00001508  6600 0022                836              BNE     .FINISH_DIA          
0000150C                           837              
0000150C  B2BC 00000000            838              CMP.L   #0,D1
00001512  6700 0008                839              BEQ     .MINUS1
00001516  7A01                     840              MOVE.L  #1,D5
00001518  6000 0004                841              BRA     .PASS_DIA
0000151C  7AFF                     842  .MINUS1     MOVE.L  #-1,D5
0000151E  D3C5                     843  .PASS_DIA   ADD.L   D5,A1
00001520  51CA FF94                844              DBRA    D2,.LOOP_DIAGONALS_ROW1
00001524                           845              
00001524  5A89                     846              ADD.L   #5,A1
00001526  7C06                     847              MOVE.L  #6,D6
00001528  51C9 FF88                848              DBRA    D1,.LOOP_TO_OTHER_SIDE
0000152C                           849  
0000152C                           850  .FINISH_DIA
0000152C  4CDF 0E7F                851              MOVEM.L (A7)+,D0-D6/A1-A3            
00001530  4E75                     852              RTS
00001532                           853  
00001532                           854  CHECK_DIAGONALS
00001532  4280                     855              CLR.L   D0
00001534  1013                     856              MOVE.B  (A3),D0
00001536  D7C6                     857              ADD.L   D6,A3
00001538  D013                     858              ADD.B   (A3),D0
0000153A  D7C6                     859              ADD.L   D6,A3
0000153C  D013                     860              ADD.B   (A3),D0
0000153E  D7C6                     861              ADD.L   D6,A3
00001540  D013                     862              ADD.B   (A3),D0
00001542                           863              
00001542  B03C 0004                864              CMP.B   #4,D0
00001546  6700 000C                865              BEQ     .PLAYERWINS_DIA
0000154A  B03C 0014                866              CMP.B   #20,D0
0000154E  6700 0004                867              BEQ     .PLAYERWINS_DIA
00001552                           868              
00001552  4E75                     869              RTS
00001554                           870             
00001554                           871  .PLAYERWINS_DIA
00001554  13F9 0000195A 0000195B   872              MOVE.B  (TURN),(WINNER)  
0000155E                           873  
0000155E  7003                     874              MOVE.L  #3,D0
00001560                           875  .LOOP_DIA
00001560  16BC 0015                876              MOVE.B  #21,(A3)
00001564  97C6                     877              SUB.L   D6,A3
00001566  51C8 FFF8                878              DBRA    D0,.LOOP_DIA
0000156A                           879                     
0000156A  4E75                     880              RTS
0000156C                           881  
0000156C                           882  
0000156C                           883  
0000156C                           884  
0000156C                           885  
0000156C                           886  
0000156C                           887  
0000156C                           888  
0000156C                           889  
0000156C                           890  
0000156C                           891  -------------------- end include --------------------
0000156C                           892              INCLUDE "PLAYER.X68"
0000156C                           893  ; ==============================================================================
0000156C                           894  ; PLAYERS MANAGEMENT
0000156C                           895  ; ==============================================================================
0000156C                           896             
0000156C                           897  ; ------------------------------------------------------------------------------
0000156C                           898  PLAINIT
0000156C                           899  ; INITIALIZE PLAYER.
0000156C                           900  ; INPUT    : NONE 
0000156C                           901  ; OUTPUT   : NONE
0000156C                           902  ; MODIFIES : NONE
0000156C                           903  ; ------------------------------------------------------------------------------
0000156C                           904              
0000156C  13FC 0001 0000195A       905              MOVE.B  #1,(TURN)               ; STARTS THE PLAYER 1
00001574  4239 0000195B            906              CLR.B   (WINNER)
0000157A                           907              
0000157A  4E75                     908              RTS
0000157C                           909              
0000157C                           910  ; ------------------------------------------------------------------------------
0000157C                           911  PLAUPD
0000157C                           912  ; UPDATES THE PLAYER.
0000157C                           913  ; INPUT    : NONE 
0000157C                           914  ; OUTPUT   : NONE
0000157C                           915  ; MODIFIES : NONE
0000157C                           916  ; ------------------------------------------------------------------------------
0000157C                           917              
0000157C  0C39 0001 0000195A       918              CMP.B   #1,(TURN)               
00001584  6700 000C                919              BEQ     .PLAYER2                ; SWAPS TURN
00001588  13FC 0001 0000195A       920              MOVE.B  #1,(TURN)               ; PLAYER 1 TURN   
00001590                           921              
00001590  4E75                     922              RTS
00001592                           923              
00001592  13FC 0005 0000195A       924  .PLAYER2    MOVE.B  #5,(TURN)               ; PLAYER 2 TURN
0000159A                           925              
0000159A  4E75                     926              RTS
0000159C                           927              
0000159C                           928  
0000159C                           929  
0000159C                           930  
0000159C                           931  
0000159C                           932  
0000159C                           933  
0000159C                           934  -------------------- end include --------------------
0000159C                           935              INCLUDE "BOARD.X68"
0000159C                           936  ; ==============================================================================
0000159C                           937  ; BOARD MANAGEMENT
0000159C                           938  ; ==============================================================================
0000159C                           939              
0000159C                           940  ; ------------------------------------------------------------------------------
0000159C                           941  BOAPLOT
0000159C                           942  ; PLOT THE BOARD
0000159C                           943  ; INPUT    : NONE 
0000159C                           944  ; OUTPUT   : NONE
0000159C                           945  ; MODIFIES : NONE
0000159C                           946  ; ------------------------------------------------------------------------------
0000159C                           947  
0000159C  48E7 C040                948              MOVEM.L D0-D1/A1,-(A7)
000015A0                           949  
000015A0                           950              ; SET BACKGROUND COLOR
000015A0  103C 0051                951              MOVE.B  #81,D0
000015A4  7200                     952              MOVE.L  #BOAFCOL,D1
000015A6  4E4F                     953              TRAP    #15
000015A8                           954              
000015A8                           955              ; SET FIRST LINE POSITION
000015A8  103C 000B                956              MOVE.B  #11,D0
000015AC  323C 0000                957              MOVE.W  #BOALINE1,D1
000015B0  4E4F                     958              TRAP    #15
000015B2                           959              
000015B2  0C39 0000 0000195B       960              CMP.B   #0,(WINNER)
000015BA  6600 002E                961              BNE     .WINNER_LINE
000015BE                           962  
000015BE                           963              ; PRINT LINE
000015BE  43F9 00001618            964              LEA.L   .TXT1,A1
000015C4  4281                     965              CLR.L   D1
000015C6  0C39 0001 0000195A       966              CMP.B   #1,(TURN)
000015CE  6700 000E                967              BEQ     .PLAYER1
000015D2  7202                     968              MOVE.L  #2,D1
000015D4  103C 0011                969              MOVE.B  #17,D0
000015D8  4E4F                     970              TRAP    #15
000015DA  6000 0036                971              BRA     .PASS
000015DE                           972              
000015DE                           973  .PLAYER1            
000015DE  7201                     974              MOVE.L  #1,D1
000015E0  103C 0011                975              MOVE.B  #17,D0
000015E4  4E4F                     976              TRAP    #15            
000015E6  6000 002A                977              BRA     .PASS
000015EA                           978              
000015EA                           979  .WINNER_LINE
000015EA                           980              ; PRINT LINE
000015EA  43F9 00001627            981              LEA.L   .TXT2,A1
000015F0  4281                     982              CLR.L   D1
000015F2  0C39 0001 0000195B       983              CMP.B   #1,(WINNER)
000015FA  6700 000E                984              BEQ     .PLAYER1_WIN
000015FE  7202                     985              MOVE.L  #2,D1
00001600  103C 0011                986              MOVE.B  #17,D0
00001604  4E4F                     987              TRAP    #15
00001606  6000 000A                988              BRA     .PASS
0000160A                           989              
0000160A                           990  .PLAYER1_WIN
0000160A  7201                     991              MOVE.L  #1,D1
0000160C  103C 0011                992              MOVE.B  #17,D0
00001610  4E4F                     993              TRAP    #15
00001612                           994  
00001612                           995  .PASS      
00001612  4CDF 0203                996              MOVEM.L (A7)+,D0-D1/A1
00001616                           997              
00001616  4E75                     998              RTS
00001618                           999              
00001618= 50 4C 41 59 45 52 ...   1000  .TXT1       DC.B    'PLAYER TURN: ',0
00001626= 00                      1001              DC.B    0            
00001627= 57 49 4E 53 20 50 ...   1002  .TXT2       DC.B    'WINS PLAYER ',0
00001634                          1003  
00001634                          1004  
00001634                          1005  
00001634                          1006  
00001634                          1007  
00001634                          1008  
00001634                          1009  -------------------- end include --------------------
00001634                          1010              INCLUDE "FILE.X68"
00001634                          1011  ; ==============================================================================
00001634                          1012  ; FILE MANAGEMENT
00001634                          1013  ; ==============================================================================
00001634                          1014  
00001634                          1015  ; ------------------------------------------------------------------------------
00001634                          1016  FILINIT
00001634                          1017  ; INITIALIZE FILE
00001634                          1018  ; INPUT    : NONE 
00001634                          1019  ; OUTPUT   : NONE
00001634                          1020  ; MODIFIES : NONE
00001634                          1021  ; ------------------------------------------------------------------------------
00001634                          1022  
00001634  48E7 C040               1023              MOVEM.L  D0-D1/A1,-(A7)
00001638                          1024              
00001638  43F9 00001966           1025              LEA.L   READED,A1
0000163E  703E                    1026              MOVE.L  #(126/2)-1,D0
00001640  4259                    1027  .LOOP1      CLR.W   (A1)+
00001642  51C8 FFFC               1028              DBRA    D0,.LOOP1
00001646                          1029                   
00001646  43F9 0000165C           1030              LEA.L  .TXT,A1
0000164C  7033                    1031              MOVE.L  #51,D0
0000164E  4E4F                    1032              TRAP    #15
00001650                          1033              
00001650  23C1 00001962           1034              MOVE.L  D1,(FILEID)             ;KEEP THE ID OF THE FILE
00001656                          1035              
00001656  4CDF 0203               1036              MOVEM.L  (A7)+,D0-D1/A1
0000165A  4E75                    1037              RTS
0000165C                          1038  
0000165C= 61 75 74 6F 6D 61 ...   1039  .TXT        DC.B    'automaticgame.txt',0
0000166E                          1040  
0000166E                          1041  ; ------------------------------------------------------------------------------
0000166E                          1042  READFILE
0000166E                          1043  ; READ THE FILE THAT CONTAINS THE MOVES
0000166E                          1044  ; INPUT    : NONE 
0000166E                          1045  ; OUTPUT   : NONE
0000166E                          1046  ; MODIFIES : NONE
0000166E                          1047  ; ------------------------------------------------------------------------------
0000166E                          1048  
0000166E  48E7 E040               1049              MOVEM.L  D0-D2/A1,-(A7)
00001672                          1050              
00001672  43F9 00001966           1051              LEA.L   READED,A1
00001678  7035                    1052              MOVE.L  #53,D0
0000167A  2239 00001962           1053              MOVE.L  (FILEID),D1
00001680  747E                    1054              MOVE.L  #126,D2
00001682  4E4F                    1055              TRAP    #15
00001684                          1056              
00001684                          1057              ;CEAN READED
00001684  43F9 00001966           1058              LEA.L   READED,A1
0000168A  5302                    1059              SUBQ.B  #1,D2                   ;D2 = BYTES READED
0000168C  0419 0030               1060  .LOOP2      SUB.B   #$30,(A1)+
00001690  51CA FFFA               1061              DBRA    D2,.LOOP2                
00001694                          1062              
00001694  4CDF 0207               1063              MOVEM.L  (A7)+,D0-D2/A1
00001698  4E75                    1064              RTS
00001698  4E75                    1065  -------------------- end include --------------------
0000169A                          1066              INCLUDE "GAME.X68"
0000169A                          1067  ; ==============================================================================
0000169A                          1068  ; GAME MANAGEMENT
0000169A                          1069  ; ==============================================================================
0000169A                          1070  
0000169A                          1071  ; ------------------------------------------------------------------------------
0000169A                          1072  GAMINIT
0000169A                          1073  ; INITIALIZES GAME.
0000169A                          1074  ; INPUT    : NONE
0000169A                          1075  ; OUTPUT   : NONE
0000169A                          1076  ; MODIFIES : NONE
0000169A                          1077  ; ------------------------------------------------------------------------------
0000169A  4EB8 11AE               1078              JSR     TABINIT
0000169E  4EB8 1108               1079              JSR     BOXINIT
000016A2  4EB8 1204               1080              JSR     PIEINIT
000016A6  4EB8 156C               1081              JSR     PLAINIT
000016AA  4E75                    1082              RTS
000016AC                          1083  
000016AC                          1084  ; ------------------------------------------------------------------------------
000016AC                          1085  GAMUPD
000016AC                          1086  ; UPDATES THE GAME
000016AC                          1087  ; INPUT    : NONE
000016AC                          1088  ; OUTPUT   : NONE
000016AC                          1089  ; MODIFIES : NONE
000016AC                          1090  ; ------------------------------------------------------------------------------
000016AC                          1091  
000016AC  4EB8 1238               1092              JSR     PIEUPD
000016B0                          1093  
000016B0  4E75                    1094              RTS
000016B2                          1095  
000016B2                          1096  ; ------------------------------------------------------------------------------
000016B2                          1097  GAMPLOT
000016B2                          1098  ; PLOTS THE GAME
000016B2                          1099  ; INPUT    : NONE
000016B2                          1100  ; OUTPUT   : NONE
000016B2                          1101  ; MODIFIES : NONE
000016B2                          1102  ; ------------------------------------------------------------------------------
000016B2  48E7 FE00               1103              MOVEM.L D0-D6,-(A7)
000016B6                          1104              
000016B6  4EB8 11CC               1105              JSR     TABPLOT
000016BA                          1106              
000016BA  303C 0006               1107              MOVE.W  #BOXNCOL-1,D0
000016BE                          1108  .PLOT_NEXT_COL
000016BE  343C 0007               1109              MOVE.W  #BOXNCOL,D2
000016C2  9440                    1110              SUB.W   D0,D2
000016C4  33C2 0000191C           1111              MOVE.W  D2,(BOXCOL)
000016CA                          1112              
000016CA  323C 0005               1113              MOVE.W  #BOXNROW-1,D1
000016CE                          1114  .PLOT_NEXT_ROW
000016CE  343C 0006               1115              MOVE.W  #BOXNROW,D2
000016D2  9441                    1116              SUB.W   D1,D2
000016D4  33C2 0000191E           1117              MOVE.W  D2,(BOXROW)
000016DA                          1118              
000016DA  4EB8 111C               1119              JSR     BOXPLOT
000016DE                          1120              
000016DE  51C9 FFEE               1121              DBRA    D1,.PLOT_NEXT_ROW
000016E2  51C8 FFDA               1122              DBRA    D0,.PLOT_NEXT_COL
000016E6                          1123              
000016E6  3A39 00001924           1124              MOVE.W  (PIEPOSX),D5
000016EC  3C39 00001926           1125              MOVE.W  (PIEPOSY),D6
000016F2  1039 0000195A           1126              MOVE.B  (TURN),D0
000016F8  4EB8 12E8               1127              JSR     PIEPLOT
000016FC  4EB8 159C               1128              JSR     BOAPLOT                 
00001700                          1129              
00001700  4CDF 007F               1130              MOVEM.L (A7)+,D0-D6
00001704                          1131              
00001704  4E75                    1132              RTS
00001706                          1133  
00001706                          1134  -------------------- end include --------------------
00001706                          1135              INCLUDE "INTRO.X68"
00001706                          1136  ; ---------------------------------------------------------------------
00001706                          1137  ; INTRO SCREEN
00001706                          1138  ; ---------------------------------------------------------------------
00001706                          1139  
00001706                          1140  ; ------------------------------------------------------------------------------
00001706                          1141  ISCINIT
00001706                          1142  ; INTRO SCREEN INIT
00001706                          1143  ; INPUT    : NONE 
00001706                          1144  ; OUTPUT   : NONE
00001706                          1145  ; MODIFIES : NONE
00001706                          1146  ; ------------------------------------------------------------------------------
00001706  4279 0000195C           1147              CLR.W   (ISCTIMER)
0000170C  4E75                    1148              RTS
0000170E                          1149              
0000170E                          1150  ; ------------------------------------------------------------------------------
0000170E                          1151  ISCUPD
0000170E                          1152  ; INTRO SCREEN UPTDATE
0000170E                          1153  ; INPUT    : NONE 
0000170E                          1154  ; OUTPUT   : NONE
0000170E                          1155  ; MODIFIES : NONE
0000170E                          1156  ; ------------------------------------------------------------------------------
0000170E  0839 0004 000019E5      1157              BTST.B  #4,(KBDEDGE)
00001716  6700 000A               1158              BEQ     .CONT
0000171A  33FC 0002 00001960      1159              MOVE.W  #2,(STANEXT)       
00001722                          1160  .CONT
00001722  5279 0000195C           1161              ADDQ.W  #1,(ISCTIMER)
00001728  0C79 01F4 0000195C      1162              CMP.W   #500,(ISCTIMER)
00001730  6D00 0002               1163              BLT     .DONE
00001734  33FC 0001 00001960      1164  .DONE            MOVE.W  #1,(STANEXT)
0000173C  4E75                    1165              RTS
0000173E                          1166              
0000173E                          1167  ; ------------------------------------------------------------------------------
0000173E                          1168  ISCPLOT
0000173E                          1169  ; INTRO SCREEN PLOT
0000173E                          1170  ; INPUT    : NONE 
0000173E                          1171  ; OUTPUT   : NONE
0000173E                          1172  ; MODIFIES : NONE
0000173E                          1173  ; ------------------------------------------------------------------------------
0000173E  48E7 C080               1174              MOVEM.L  D0-D1/A0,-(A7)
00001742  4281                    1175              CLR.L   D1
00001744  103C 0051               1176              MOVE.B  #81,D0
00001748  4E4F                    1177              TRAP    #15
0000174A                          1178              
0000174A  41F9 0000176C           1179              LEA     .TXT1,A0
00001750  103C 0008               1180              MOVE.B  #8,D0
00001754  4EB8 10DE               1181              JSR     UTLPRINT
00001758  41F9 00001776           1182              LEA     .TXT2,A0
0000175E  103C 0020               1183              MOVE.B  #32,D0
00001762  4EB8 10DE               1184              JSR     UTLPRINT
00001766                          1185              
00001766  4CDF 0103               1186  .DONE       MOVEM.L (A7)+,D0-D1/A0
0000176A                          1187  
0000176A                          1188  
0000176A  4E75                    1189              RTS
0000176C                          1190  
0000176C= 43 4F 4E 4E 45 43 ...   1191  .TXT1       DC.B    'CONNECT-4',0
00001776= 50 52 45 53 53 20 ...   1192  .TXT2       DC.B    'PRESS SPACE TO START',0
0000178C                          1193              DS.W    0
0000178C                          1194  
0000178C                          1195  
0000178C                          1196  
0000178C                          1197  
0000178C                          1198  -------------------- end include --------------------
0000178C                          1199              INCLUDE "INSTRUCT.X68"
0000178C                          1200  ; ---------------------------------------------------------------------
0000178C                          1201  ; INSTRUCTIONS SCREEN
0000178C                          1202  ; ---------------------------------------------------------------------
0000178C                          1203  
0000178C                          1204  ; ------------------------------------------------------------------------------
0000178C                          1205  INSINIT
0000178C                          1206  ; INSTRUCTIONS SCREEN INIT
0000178C                          1207  ; INPUT    : NONE 
0000178C                          1208  ; OUTPUT   : NONE
0000178C                          1209  ; MODIFIES : NONE
0000178C                          1210  ; ------------------------------------------------------------------------------
0000178C                          1211  
0000178C  4E75                    1212              RTS
0000178E                          1213              
0000178E                          1214  ; ------------------------------------------------------------------------------
0000178E                          1215  INSUPD
0000178E                          1216  ; INTRO SCREEN UPTDATE
0000178E                          1217  ; INPUT    : NONE 
0000178E                          1218  ; OUTPUT   : NONE
0000178E                          1219  ; MODIFIES : NONE
0000178E                          1220  ; ------------------------------------------------------------------------------
0000178E                          1221  
0000178E  4E75                    1222              RTS
00001790                          1223              
00001790                          1224  ; ------------------------------------------------------------------------------
00001790                          1225  INSPLOT
00001790                          1226  ; INSTRUCTIONS SCREEN PLOT
00001790                          1227  ; INPUT    : NONE 
00001790                          1228  ; OUTPUT   : NONE
00001790                          1229  ; MODIFIES : NONE
00001790                          1230  ; ------------------------------------------------------------------------------
00001790  48E7 C0C0               1231              MOVEM.L  D0-D1/A0-A1,-(A7)
00001794                          1232              
00001794  4281                    1233              CLR.L   D1
00001796  103C 0051               1234              MOVE.B  #81,D0
0000179A  4E4F                    1235              TRAP    #15
0000179C                          1236              
0000179C  103C 0008               1237              MOVE.B  #8,D0
000017A0  43F9 00001856           1238              LEA     .TXTLST,A1
000017A6  2219                    1239  .LOOP       MOVE.L  (A1)+,D1
000017A8  6700 000A               1240              BEQ     .DONE
000017AC  2041                    1241              MOVE.L  D1,A0
000017AE  4EB8 10DE               1242              JSR     UTLPRINT
000017B2  60F2                    1243              BRA     .LOOP
000017B4                          1244              
000017B4  4CDF 0303               1245  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
000017B8                          1246  
000017B8                          1247  
000017B8  4E75                    1248              RTS
000017BA                          1249  
000017BA= 54 52 59 20 54 4F ...   1250  .TXT1       DC.B    'TRY TO CONNECT 4 PIECES IN A LINE',0
000017DC= 55 53 45 20 4C 45 ...   1251  .TXT2       DC.B    'USE LEFT AND RIGHT ARROWS TO SELECT PIECE POSITION',0
0000180F= 50 52 45 53 53 20 ...   1252  .TXT3       DC.B    'PRESS SPACE TO PLACE A PIECE',0
0000182C= 41 46 54 45 52 20 ...   1253  .TXT4       DC.B    'AFTER PLACING A PIECE THE TURN WILL SWAP',0
00001856                          1254              DS.W    0
00001856= 000017BA 000017DC ...   1255  .TXTLST     DC.L    .TXT1,.TXT2,.TXT3,.TXT4,0
0000186A                          1256  
0000186A                          1257  -------------------- end include --------------------
0000186A                          1258              INCLUDE "STATES.X68"
0000186A                          1259  ; =============================================================================
0000186A                          1260  ; GAME STATE MANAGEMENT
0000186A                          1261  ; =============================================================================
0000186A                          1262  
0000186A                          1263  ; -----------------------------------------------------------------------------
0000186A                          1264  STAINIT
0000186A                          1265  ; INITALIZES THE STATE MANAGER
0000186A                          1266  ; INPUT    - NONE
0000186A                          1267  ; OUTPUT   - NONE
0000186A                          1268  ; MODIFIES - NONE
0000186A                          1269  ; -----------------------------------------------------------------------------
0000186A  33FC FFFF 0000195E      1270              MOVE.W  #STANONE,(STACUR)
00001872  4279 00001960           1271              CLR.W   (STANEXT)
00001878  4E75                    1272              RTS
0000187A                          1273  
0000187A                          1274  ; -----------------------------------------------------------------------------
0000187A                          1275  STAUPD
0000187A                          1276  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
0000187A                          1277  ; INPUT    - NONE
0000187A                          1278  ; OUTPUT   - NONE
0000187A                          1279  ; MODIFIES - NONE
0000187A                          1280  ; -----------------------------------------------------------------------------
0000187A  48E7 8080               1281              MOVEM.L D0/A0,-(A7)
0000187E  4280                    1282              CLR.L   D0
00001880  3039 00001960           1283              MOVE.W  (STANEXT),D0
00001886  B079 0000195E           1284              CMP.W   (STACUR),D0
0000188C  6700 0012               1285              BEQ     .DOUPD
00001890  33C0 0000195E           1286              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00001896  E588                    1287              LSL.L   #2,D0
00001898  2040                    1288              MOVE.L  D0,A0
0000189A  2068 18B8               1289              MOVE.L  .INITBL(A0),A0
0000189E  4E90                    1290              JSR     (A0)
000018A0  4280                    1291  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
000018A2  3039 0000195E           1292              MOVE.W  (STACUR),D0
000018A8  E588                    1293              LSL.L   #2,D0
000018AA  2040                    1294              MOVE.L  D0,A0
000018AC  2068 18C4               1295              MOVE.L  .UPDTBL(A0),A0
000018B0  4E90                    1296              JSR     (A0)
000018B2  4CDF 0101               1297              MOVEM.L (A7)+,D0/A0
000018B6  4E75                    1298              RTS
000018B8= 00001706 0000178C ...   1299  .INITBL     DC.L    ISCINIT,INSINIT,GAMINIT
000018C4= 0000170E 0000178E ...   1300  .UPDTBL     DC.L    ISCUPD,INSUPD,GAMUPD
000018D0                          1301  
000018D0                          1302  ; -----------------------------------------------------------------------------
000018D0                          1303  STAPLOT
000018D0                          1304  ; PERFORMS STATE PLOT
000018D0                          1305  ; INPUT    - NONE
000018D0                          1306  ; OUTPUT   - NONE
000018D0                          1307  ; MODIFIES - NONE
000018D0                          1308  ; -----------------------------------------------------------------------------
000018D0  48E7 8080               1309              MOVEM.L D0/A0,-(A7)
000018D4  4280                    1310              CLR.L   D0
000018D6  3039 0000195E           1311              MOVE.W  (STACUR),D0
000018DC  E588                    1312              LSL.L   #2,D0
000018DE  2040                    1313              MOVE.L  D0,A0
000018E0  2068 18EC               1314              MOVE.L  .PLTTBL(A0),A0
000018E4  4E90                    1315              JSR     (A0)
000018E6  4CDF 0101               1316              MOVEM.L (A7)+,D0/A0
000018EA  4E75                    1317              RTS
000018EC= 0000173E 00001790 ...   1318  .PLTTBL     DC.L    ISCPLOT,INSPLOT,GAMPLOT
000018F8                          1319  
000018F8                          1320  ; -----------------------------------------------------------------------------
000018F8                          1321  STAEMPTY
000018F8                          1322  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
000018F8                          1323  ; INPUT    - NONE
000018F8                          1324  ; OUTPUT   - NONE
000018F8                          1325  ; MODIFIES - NONE
000018F8                          1326  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
000018F8                          1327  ; -----------------------------------------------------------------------------
000018F8  4E75                    1328              RTS
000018FA                          1329  
000018FA                          1330  
000018FA                          1331  
000018FA                          1332  
000018FA                          1333  
000018FA                          1334  
000018FA                          1335  
000018FA                          1336  
000018FA                          1337  
000018FA                          1338  -------------------- end include --------------------
000018FA                          1339              
000018FA                          1340             
000018FA                          1341  START
000018FA                          1342  
000018FA                          1343  ; --- INITIALIZATION -----------------------------------------------------------
000018FA                          1344  
000018FA  4EB8 1000               1345              JSR     SYSINIT
000018FE  4EB8 169A               1346              JSR     GAMINIT
00001902                          1347              ;JSR     UTLINIT
00001902                          1348              ;JSR     STAINIT
00001902                          1349              
00001902                          1350  .LOOP
00001902                          1351  
00001902                          1352  ; --- UPDATE -------------------------------------------------------------------
00001902                          1353  
00001902                          1354  ; READ INPUT DEVICES
00001902                          1355  
00001902  4E41                    1356              TRAP    #1
00001904                          1357  
00001904                          1358  ; UPDATE GAME LOGIC
00001904                          1359         
00001904                          1360              ;JSR     STAUPD
00001904  4EB8 16AC               1361              JSR     GAMUPD    
00001908                          1362  
00001908                          1363  ; --- PLOT ---------------------------------------------------------------------
00001908                          1364  
00001908                          1365              ;JSR     STAPLOT
00001908  4EB8 16B2               1366              JSR GAMPLOT
0000190C                          1367  
0000190C  4E40                    1368              TRAP    #0                      ; ENABLE DOBLE BUFFER
0000190E                          1369              
0000190E  0C39 0000 0000195B      1370              CMP.B   #0,(WINNER)
00001916  67EA                    1371              BEQ     .LOOP
00001918                          1372  
00001918  FFFF FFFF               1373              SIMHALT
0000191C                          1374              
0000191C                          1375              INCLUDE "VARS.X68"
0000191C                          1376  ; ==============================================================================
0000191C                          1377  ; GAME VARIABLES
0000191C                          1378  ; ==============================================================================
0000191C                          1379  
0000191C                          1380  ; --- BOX RELATED VARIABLES ----------------------------------------------------
0000191C                          1381  
0000191C                          1382  BOXCOL      DS.W    1                       ; COLUMN WHERE THE BOX IS PAINTED  
0000191E                          1383  BOXROW      DS.W    1                       ; ROW WHERE THE BOX IS PAINTED
00001920                          1384  BOXPOSX     DS.W    1                       ; BOX X COORDINATE
00001922                          1385  BOXPOSY     DS.W    1                       ; BOX Y COORDINATE
00001924                          1386  
00001924                          1387  ; --- PIECE RELATED VARIABLES --------------------------------------------------
00001924                          1388  
00001924                          1389  PIEPOSX     DS.W    1                       ; PIECE X COORDINATE
00001926                          1390  PIEPOSY     DS.W    1                       ; PIECE Y COORDINATE
00001928                          1391  PIEVELX     DS.W    1                       ; X MOVEMENT
0000192A                          1392  PIEVELY     DS.W    1                       ; Y MOVEMENT
0000192C                          1393  POSX        DS.W    1                       ; POS. X IN THE MATRIX 
0000192E                          1394  POSY        DS.W    1                       ; POS. Y IN THE MATRIX
00001930                          1395  
00001930                          1396  ; --- COLUMN RELATED VARIABLES -------------------------------------------------
00001930                          1397  
00001930                          1398  ROW1        DS.B    7
00001937                          1399  ROW2        DS.B    7
0000193E                          1400  ROW3        DS.B    7
00001945                          1401  ROW4        DS.B    7
0000194C                          1402  ROW5        DS.B    7
00001953                          1403  ROW6        DS.B    7
0000195A                          1404  
0000195A                          1405  ; --- PLAYER VARIABLES ---------------------------------------------------------
0000195A                          1406  
0000195A                          1407  TURN        DS.B    1                       ; PLAYER WHO PLAY IN THAT TURN
0000195B                          1408  WINNER      DS.B    1                       ; 0 NONE, 1 OR 5 (PLAYER WHO WIN)
0000195C                          1409  
0000195C                          1410  ; --- INTRO STATE RELATED VARAIBLES --------------------------------------------
0000195C                          1411  
0000195C                          1412  ISCTIMER    DS.W    1                       ;INTRO TIMER
0000195E                          1413  
0000195E                          1414  
0000195E                          1415  ; --- STATE RELATED VARAIBLES --------------------------------------------------
0000195E                          1416  
0000195E                          1417  STACUR      DS.W    1                       ;CURRENT STATE
00001960                          1418  STANEXT     DS.W    1                       ;NEXT STATE
00001962                          1419  
00001962                          1420  ; --- FILE VARAIBLES ----------------------------------------------------------
00001962                          1421  
00001962                          1422  FILEID      DS.L    1                       ;ID OF THE OPENED FILE
00001966                          1423  READED      DS.B    126                     ;MOVEMENTS READ (42 BOXES * 3)      
000019E4                          1424  
000019E4                          1425  
000019E4                          1426  
000019E4                          1427  
000019E4                          1428  
000019E4                          1429  
000019E4                          1430  
000019E4                          1431  
000019E4                          1432  
000019E4                          1433  
000019E4                          1434  
000019E4                          1435  
000019E4                          1436  
000019E4                          1437  
000019E4                          1438  -------------------- end include --------------------
000019E4                          1439              INCLUDE "SYSVARS.X68"
000019E4                          1440  ; ==============================================================================
000019E4                          1441  ; SYSTEM VARIABLES
000019E4                          1442  ; ==============================================================================
000019E4                          1443              
000019E4                          1444  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
000019E4                          1445  
000019E4                          1446  KBDVAL      DS.B    1                       ; KEY STATE
000019E5                          1447  KBDEDGE     DS.B    1                       ; KEY EDGE
000019E6                          1448  
000019E6                          1449  
000019E6                          1450  
000019E6                          1451  -------------------- end include --------------------
000019E6                          1452  
000019E6                          1453              END     START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BOAFCOL             0
BOALINE1            0
BOAPLOT             159C
BOAPLOT:PASS        1612
BOAPLOT:PLAYER1     15DE
BOAPLOT:PLAYER1_WIN  160A
BOAPLOT:TXT1        1618
BOAPLOT:TXT2        1627
BOAPLOT:WINNER_LINE  15EA
BOXCOL              191C
BOXFCOL             0
BOXINIT             1108
BOXNCOL             7
BOXNROW             6
BOXPCOL             AA0000
BOXPLOT             111C
BOXPLOT:EMPTY       11A8
BOXPOSX             1920
BOXPOSY             1922
BOXRAD              2D
BOXROW              191E
BOXUPD              111A
CHECK_DIAGONALS     1532
CHECK_DIAGONALS:LOOP_DIA  1560
CHECK_DIAGONALS:PLAYERWINS_DIA  1554
CHKCOL              13EA
CHKCOL:CHECK_NEXT_COL  13F6
CHKCOL:CHECK_POSITION_COL  13FC
CHKCOL:LOOP_COL     143A
CHKCOL:PLAYERWINS_COL  142E
CHKDIA              14A4
CHKDIA:FINISH_DIA   152C
CHKDIA:LOOP1        14BA
CHKDIA:LOOP2        14DA
CHKDIA:LOOP_DIAGONALS_ROW1  14B6
CHKDIA:LOOP_TO_OTHER_SIDE  14B2
CHKDIA:MINUS1       151C
CHKDIA:PASS_DIA     151E
CHKROW              144A
CHKROW:CHECK_NEXT_ROW  1456
CHKROW:CHECK_POSITION_ROW  145C
CHKROW:LOOP_ROW     1494
CHKROW:PLAYERWINS_ROW  1488
FILEID              1962
FILINIT             1634
FILINIT:LOOP1       1640
FILINIT:TXT         165C
GAMINIT             169A
GAMPLOT             16B2
GAMPLOT:PLOT_NEXT_COL  16BE
GAMPLOT:PLOT_NEXT_ROW  16CE
GAMUPD              16AC
INSINIT             178C
INSPLOT             1790
INSPLOT:DONE        17B4
INSPLOT:LOOP        17A6
INSPLOT:TXT1        17BA
INSPLOT:TXT2        17DC
INSPLOT:TXT3        180F
INSPLOT:TXT4        182C
INSPLOT:TXTLST      1856
INSUPD              178E
ISCINIT             1706
ISCPLOT             173E
ISCPLOT:DONE        1766
ISCPLOT:TXT1        176C
ISCPLOT:TXT2        1776
ISCTIMER            195C
ISCUPD              170E
ISCUPD:CONT         1722
ISCUPD:DONE         1734
KBDDOWN             28
KBDEDGE             19E5
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             106C
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPDATE           107A
KBDUPDATE:LOOP      10BE
KBDUPDATE:PACK      10BA
KBDVAL              19E4
PIEFALL             1370
PIEFALL:END         13D4
PIEFALL:FALLAGAIN   1382
PIEFALL:OTHERPIE    13E0
PIEFALL:PASS        13C8
PIEFCOL1            FF
PIEFCOL2            FFFF
PIEFCOL3            3FEB1D
PIEINIT             1204
PIEPCOL1            AA
PIEPCOL2            AAAA
PIEPCOL3            0
PIEPLOT             12E8
PIEPLOT:COLOR1      1318
PIEPLOT:COLORWINNER  1334
PIEPLOT:JUMP        134C
PIEPOSX             1924
PIEPOSY             1926
PIERAD              23
PIESPEED            3
PIEUPD              1238
PIEUPD:CHKRIGHT     125A
PIEUPD:CHKSPACE     1272
PIEUPD:CONT         12A0
PIEUPD:CONT2        12BC
PIEUPD:DONE         12D2
PIEUPD:DONE2        12DE
PIEVELX             1928
PIEVELY             192A
PLAINIT             156C
PLAUPD              157C
PLAUPD:PLAYER2      1592
POSX                192C
POSY                192E
READED              1966
READFILE            166E
READFILE:LOOP2      168C
ROW1                1930
ROW2                1937
ROW3                193E
ROW4                1945
ROW5                194C
ROW6                1953
SCRHEIGH            2D0
SCRINIT             1024
SCRPLOT             1052
SCRWIDTH            3C0
STACUR              195E
STAEMPTY            18F8
STAINIT             186A
STANEXT             1960
STANONE             FFFFFFFF
STAPLOT             18D0
STAPLOT:PLTTBL      18EC
START               18FA
START:LOOP          1902
STAUPD              187A
STAUPD:DOUPD        18A0
STAUPD:INITBL       18B8
STAUPD:UPDTBL       18C4
SYSINIT             1000
TABFCOL             AA0000
TABINIT             11AE
TABINIT:LOOP        11BC
TABPCOL             FF0000
TABPLOT             11CC
TURN                195A
UTLCHRWD            8
UTLINIT             10C8
UTLPRINT            10DE
UTLPRINT:ENDLOOP    10F0
UTLPRINT:LOOP       10E6
UTLRNDIX            1106
WINNER              195B
