000019F8 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 15/01/2023 2:09:13

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       : CUATRO EN RAYA
00000000                             3  ; AUTHOR      :
00000000                             4  ; ==============================================================================
00000000                             5  
00001000                             6              ORG     $1000
00001000                             7              
00001000                             8              INCLUDE "CONST.X68"
00001000                             9  ; ==============================================================================
00001000                            10  ; GAME CONSTANTS
00001000                            11  ; ==============================================================================
00001000                            12  
00001000                            13  ; --- BOX RELATED CONTANTS ----------------------------------------------------
00001000                            14  
00001000  =00000007                 15  BOXNCOL     EQU     7                       ; NUMBER OF BOXES IN A COLUMN
00001000  =00000006                 16  BOXNROW     EQU     6                       ; NUMBER OF BOXES IN A ROW
00001000  =00AA0000                 17  BOXPCOL     EQU     $00AA0000               ; BOXCONTOUR COLOR
00001000  =00000000                 18  BOXFCOL     EQU     $00000000               ; BOX FILL COLOR
00001000  =0000002D                 19  BOXRAD      EQU     45                      ; BOX RADIUS
00001000                            20  
00001000                            21  ; --- PIECE RELATED CONTANTS ----------------------------------------------------
00001000                            22  
00001000  =000000AA                 23  PIEPCOL1    EQU     $000000AA               ; PIECE CONTOUR COLOR TURN 1
00001000  =000000FF                 24  PIEFCOL1    EQU     $000000FF               ; PIECE FILL COLOR TURN 1
00001000  =0000AAAA                 25  PIEPCOL2    EQU     $0000AAAA               ; PIECE CONTOUR COLOR TURN 2
00001000  =0000FFFF                 26  PIEFCOL2    EQU     $0000FFFF               ; PIECE FILL COLOR TURN 2               
00001000  =00000000                 27  PIEPCOL3    EQU     $00000000               ; PIECE CONTOUR COLOR WIN
00001000  =003FEB1D                 28  PIEFCOL3    EQU     $003FEB1D               ; PIECE FILL COLOR WIN
00001000  =00000003                 29  PIESPEED    EQU     3                       ; MAGNITUDE OF THE FALL VEL.
00001000  =00000023                 30  PIERAD      EQU     35                      ; PIECE RADIUS
00001000                            31  
00001000                            32  ; --- TABLE RELATED CONSTANTS ----------------------------------------------------
00001000                            33  
00001000  =00FF0000                 34  TABPCOL     EQU     $00FF0000               ; TAB CONTOUR COLOR
00001000  =00AA0000                 35  TABFCOL     EQU     $00AA0000               ; TAB FILL COLOR
00001000                            36  
00001000                            37  ; --- BOARD RELATED CONSTANTS ---------------------------------------------
00001000                            38  
00001000  =00000000                 39  BOAFCOL     EQU     $00000000               ; TEXT BACKGROUND COLOR
00001000                            40  
00001000                            41  ; --- STATE RELATED CONSTANTS ---------------------------------------------------
00001000                            42  
00001000  =FFFFFFFF                 43  STANONE     EQU     -1                      ;NON-EXISTENT STATE NUMBER
00001000                            44  
00001000                            45  
00001000                            46  
00001000                            47  
00001000                            48  
00001000                            49  
00001000                            50  
00001000                            51  
00001000                            52  -------------------- end include --------------------
00001000                            53              INCLUDE "SYSCONST.X68"
00001000                            54  ; ==============================================================================
00001000                            55  ; SYSTEM CONSTANTS
00001000                            56  ; ==============================================================================
00001000                            57  
00001000                            58  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001000                            59  
00001000  =000003C0                 60  SCRWIDTH    EQU     960                     ; SCREEN WIDTH
00001000  =000002D0                 61  SCRHEIGH    EQU     720                     ; SCREEN HEIGHT
00001000                            62  
00001000                            63  ; --- KEYCODES -----------------------------------------------------------------
00001000                            64  
00001000  =00000025                 65  KBDLEFT     EQU     $25
00001000  =00000026                 66  KBDUP       EQU     $26
00001000  =00000027                 67  KBDRIGHT    EQU     $27
00001000  =00000028                 68  KBDDOWN     EQU     $28
00001000  =00000020                 69  KBDFIRE1    EQU     ' '
00001000  =0000004D                 70  KBDFIRE2    EQU     'M'
00001000  =00000010                 71  KBDFIRE3    EQU     $10
00001000  =00000050                 72  KBDPAUSE    EQU     'P'
00001000                            73  
00001000                            74  
00001000                            75  
00001000                            76  
00001000                            77  
00001000                            78  -------------------- end include --------------------
00001000                            79              INCLUDE "SYSTEM.X68"
00001000                            80  ; ==============================================================================
00001000                            81  ; SYSTEM
00001000                            82  ; ==============================================================================
00001000                            83              
00001000                            84  ; ------------------------------------------------------------------------------
00001000                            85  SYSINIT
00001000                            86  ; INITIALIZE SYSTEM.
00001000                            87  ; INPUT    : NONE
00001000                            88  ; OUTPUT   : NONE
00001000                            89  ; MODIFIES : NONE
00001000                            90  ; ------------------------------------------------------------------------------
00001000  4EB9 00001024             91              JSR     SCRINIT
00001006  4EB9 0000106C             92              JSR     KBDINIT
0000100C                            93              
0000100C  21FC 00001052 0080        94              MOVE.L  #SCRPLOT,($80)
00001014  21FC 0000107A 0084        95              MOVE.L  #KBDUPDATE,($84)
0000101C                            96              
0000101C  40E7                      97              MOVE.W  SR,-(A7)
0000101E  0257 DFFF                 98              ANDI.W  #$DFFF,(A7)
00001022  4E73                      99              RTE
00001024                           100              
00001024                           101  ; ------------------------------------------------------------------------------
00001024                           102  SCRINIT
00001024                           103  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN.
00001024                           104  ; INPUT    : NONE
00001024                           105  ; OUTPUT   : NONE
00001024                           106  ; MODIFIES : NONE
00001024                           107  ; ------------------------------------------------------------------------------
00001024                           108  
00001024  48E7 C000                109              MOVEM.L D0-D1,-(A7)
00001028                           110  
00001028                           111              ; SET SCREEN RESOLUTION
00001028  103C 0021                112              MOVE.B  #33,D0
0000102C  223C 03C002D0            113              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001032  4E4F                     114              TRAP    #15
00001034                           115              
00001034                           116              ; SET WINDOWED MODE
00001034  7201                     117              MOVE.L  #1,D1
00001036  4E4F                     118              TRAP    #15
00001038                           119              
00001038                           120              ; CLEAR SCREEN
00001038  103C 000B                121              MOVE.B  #11,D0
0000103C  323C FF00                122              MOVE.W  #$FF00,D1
00001040  4E4F                     123              TRAP    #15
00001042                           124              
00001042                           125              ; ENABLE DOUBLE BUFFER
00001042  103C 005C                126              MOVE.B #92,D0
00001046  123C 0011                127              MOVE.B #17,D1
0000104A  4E4F                     128              TRAP #15
0000104C                           129              
0000104C  4CDF 0003                130              MOVEM.L (A7)+,D0-D1
00001050                           131              
00001050  4E75                     132              RTS
00001052                           133              
00001052                           134  ; ------------------------------------------------------------------------------
00001052                           135  SCRPLOT
00001052                           136  ; UPDATES DOBLE BUFFER
00001052                           137  ; INPUT    : NONE
00001052                           138  ; OUTPUT   : NONE
00001052                           139  ; MODIFIES : NONE
00001052                           140  ; ------------------------------------------------------------------------------
00001052  48A7 C000                141              MOVEM.W D0-D1,-(A7)
00001056                           142  
00001056                           143              ; SWITCH BUFFERS
00001056  103C 005E                144              MOVE.B  #94,D0
0000105A  4E4F                     145              TRAP    #15
0000105C                           146              
0000105C                           147              ; CLEAR HIDDEN BUFFER
0000105C  103C 000B                148              MOVE.B  #11,D0
00001060  323C FF00                149              MOVE.W  #$FF00,D1
00001064  4E4F                     150              TRAP    #15
00001066                           151              
00001066  4C9F 0003                152              MOVEM.W (A7)+,D0-D1
0000106A                           153              
0000106A  4E73                     154              RTE 
0000106C                           155  
0000106C                           156              
0000106C                           157  ; ------------------------------------------------------------------------------
0000106C                           158  KBDINIT
0000106C                           159  ; INIT KEYBOOARD
0000106C                           160  ; INPUT    : NONE
0000106C                           161  ; OUTPUT   : NONE
0000106C                           162  ; MODIFIES : NONE
0000106C                           163  ; ------------------------------------------------------------------------------
0000106C  4239 00001AE7            164              CLR.B   (KBDVAL)
00001072  4239 00001AE8            165              CLR.B   (KBDEDGE)
00001078  4E75                     166              RTS
0000107A                           167              
0000107A                           168  ; ------------------------------------------------------------------------------
0000107A                           169  KBDUPDATE
0000107A                           170  ; UPDATE KEYBOARD INFO.  
0000107A                           171  ; 7 -> PAUSE
0000107A                           172  ; 6 -> FIRE 3
0000107A                           173  ; 5 -> FIRE 2
0000107A                           174  ; 4 -> FIRE 1
0000107A                           175  ; 3 -> DOWN
0000107A                           176  ; 2 -> RIGHT
0000107A                           177  ; 1 -> UP
0000107A                           178  ; 0 -> LEFT
0000107A                           179  ; INPUT    : NONE
0000107A                           180  ; OUTPUT   : NONE
0000107A                           181  ; MODIFIES : NONE
0000107A                           182  ; ------------------------------------------------------------------------------
0000107A                           183  
0000107A  48E7 F000                184              MOVEM.L D0-D3,-(A7)
0000107E                           185  
0000107E                           186              ; READ FIRST PART
0000107E  103C 0013                187              MOVE.B  #19,D0
00001082  223C 50104D20            188              MOVE.L  #KBDPAUSE<<24|KBDFIRE3<<16|KBDFIRE2<<8|KBDFIRE1,D1
00001088  4E4F                     189              TRAP    #15
0000108A                           190              
0000108A                           191              ; CONVERT TO DESIRED FORMAT
0000108A  4EB9 000010BA            192              JSR     .PACK
00001090                           193  
00001090                           194              ; READ SECOND PART
00001090  223C 28272625            195              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
00001096  4E4F                     196              TRAP    #15
00001098                           197  
00001098                           198              ; CONVERT TO DESIRED FORMAT
00001098  4EB9 000010BA            199              JSR     .PACK
0000109E                           200              
0000109E                           201              ; COMPUTE KBDEDGE
0000109E  1039 00001AE7            202              MOVE.B  (KBDVAL),D0
000010A4  4600                     203              NOT.B   D0
000010A6  C002                     204              AND.B   D2,D0
000010A8  13C0 00001AE8            205              MOVE.B  D0,(KBDEDGE)
000010AE                           206              
000010AE                           207              ; STORE KBDVAL
000010AE  13C2 00001AE7            208              MOVE.B  D2,(KBDVAL)
000010B4                           209              
000010B4  4CDF 000F                210              MOVEM.L (A7)+,D0-D3
000010B8                           211  
000010B8  4E73                     212              RTE
000010BA                           213              
000010BA  363C 0003                214  .PACK       MOVE.W  #3,D3
000010BE  E189                     215  .LOOP       LSL.L   #8,D1
000010C0  E312                     216              ROXL.B  #1,D2
000010C2  51CB FFFA                217              DBRA.W  D3,.LOOP
000010C6  4E75                     218              RTS
000010C8                           219  
000010C8                           220              
000010C8                           221              
000010C8                           222  
000010C8                           223  
000010C8                           224  -------------------- end include --------------------
000010C8                           225              INCLUDE "LIB/UTLCONST.X68"
000010C8                           226  ;----------------------------------------------------------------
000010C8                           227  ;UTIL CONSTANTS
000010C8                           228  ;----------------------------------------------------------------
000010C8  =00000008                229  UTLCHRWD    EQU     8                       ;CHARACTER WIDTH IN PIXELS
000010C8  =00000008                230  -------------------- end include --------------------
000010C8                           231              INCLUDE "LIB/UTLCODE.X68"
000010C8                           232  ; =============================================================================
000010C8                           233  ; UTILITY CODE
000010C8                           234  ; =============================================================================
000010C8                           235  
000010C8                           236  ; -----------------------------------------------------------------------------
000010C8                           237  UTLINIT
000010C8                           238  ; INITIALIZES UTILITY CODE
000010C8                           239  ; OUTPUT   - NONE
000010C8                           240  ; MODIFIES - NONE
000010C8                           241  ; -----------------------------------------------------------------------------
000010C8  48E7 C000                242              MOVEM.L D0-D1,-(A7)
000010CC  103C 0008                243              MOVE.B  #8,D0
000010D0  4E4F                     244              TRAP    #15
000010D2  13C1 0000111C            245              MOVE.B  D1,(UTLRNDIX)
000010D8  4CDF 0003                246              MOVEM.L (A7)+,D0-D1
000010DC  4E75                     247              RTS
000010DE                           248  ; -----------------------------------------------------------------------------
000010DE                           249  UTLPRINT
000010DE                           250  ; PRINT SCREEN CENTERED TEXT
000010DE                           251  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
000010DE                           252  ;            D0.B SCREEN ROW TO PRINT TEXT
000010DE                           253  ; OUTPUT   : D0.B NEXT ROW
000010DE                           254  ; MODIFIES : NONE (ASIDE OF OUTPUT)
000010DE                           255  ; -----------------------------------------------------------------------------
000010DE  48E7 C0C0                256              MOVEM.L D0-D1/A0-A1,-(A7)
000010E2                           257              
000010E2  4201                     258              CLR.B   D1
000010E4  2248                     259              MOVE.L  A0,A1
000010E6  4A18                     260  .LOOP1      TST.B   (A0)+
000010E8  6700 0006                261              BEQ     .ENDLOOP1
000010EC  5201                     262              ADDQ.B  #1,D1
000010EE  60F6                     263              BRA     .LOOP1
000010F0                           264              
000010F0  E209                     265  .ENDLOOP1   LSR.B   #1,D1
000010F2  0401 003C                266              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
000010F6  4401                     267              NEG.B   D1
000010F8  E141                     268              ASL.W   #8,D1
000010FA  8240                     269              OR.W    D0,D1
000010FC  4E4F                     270              TRAP    #15
000010FE                           271              
000010FE  4CDF 0303                272              MOVEM.L (A7)+,D0-D1/A0-A1
00001102  5200                     273              ADDQ.B  #1,D0
00001104  4E75                     274              RTS
00001106                           275  
00001106                           276  ; -----------------------------------------------------------------------------
00001106                           277  UTLSTRLEN
00001106                           278  ; GET THE LENGTH OF A STRING
00001106                           279  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001106                           280  ; OUTPUT   : D0.B STRING LEN
00001106                           281  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001106                           282  ; -----------------------------------------------------------------------------
00001106                           283  
00001106  48E7 0080                284              MOVEM.L A0,-(A7)
0000110A                           285              
0000110A  4280                     286              CLR.L   D0
0000110C  4A18                     287  .LOOP       TST.B   (A0)+
0000110E  6700 0006                288              BEQ     .ENDLOOP
00001112  5200                     289              ADDQ.B  #1,D0
00001114  60F6                     290              BRA     .LOOP
00001116                           291  .ENDLOOP            
00001116  4CDF 0100                292              MOVEM.L (A7)+,A0
0000111A  4E75                     293              RTS
0000111C                           294  
0000111C                           295  
0000111C                           296  
0000111C                           297  
0000111C                           298  
0000111C                           299  
0000111C                           300  
0000111C                           301  
0000111C                           302  
0000111C                           303  
0000111C                           304  -------------------- end include --------------------
0000111C                           305              INCLUDE "LIB/UTLVARS.X68"
0000111C                           306  ; =============================================================================
0000111C                           307  ; UTILITY VARIABLES
0000111C                           308  ; =============================================================================
0000111C                           309  
0000111C                           310  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
0000111E                           311              DS.W    0
0000111E                           312  -------------------- end include --------------------
0000111E                           313              INCLUDE "BOX.X68"
0000111E                           314  ; ==============================================================================
0000111E                           315  ; BOX MANAGEMENT
0000111E                           316  ; ==============================================================================
0000111E                           317              
0000111E                           318  ; ------------------------------------------------------------------------------
0000111E                           319  BOXINIT
0000111E                           320  ; INITIALIZE BOX.
0000111E                           321  ; INPUT    : NONE 
0000111E                           322  ; OUTPUT   : NONE
0000111E                           323  ; MODIFIES : NONE
0000111E                           324  ; ------------------------------------------------------------------------------
0000111E                           325              
0000111E  33FC 0083 00001A1E       326              MOVE.W  #BOXRAD*2+41,(BOXPOSX)
00001126  33FC 0064 00001A20       327              MOVE.W  #BOXRAD*2+10,(BOXPOSY)
0000112E                           328              
0000112E  4E75                     329              RTS
00001130                           330              
00001130                           331  ; ------------------------------------------------------------------------------
00001130                           332  BOXUPD
00001130                           333  ; UPDATES THE BOX.
00001130                           334  ; INPUT    : NONE 
00001130                           335  ; OUTPUT   : NONE
00001130                           336  ; MODIFIES : NONE
00001130                           337  ; ------------------------------------------------------------------------------
00001130  4E75                     338              RTS
00001132                           339              
00001132                           340  ; ------------------------------------------------------------------------------
00001132                           341  BOXPLOT
00001132                           342  ; PLOT THE BOX.
00001132                           343  ; INPUT    : NONE 
00001132                           344  ; OUTPUT   : NONE
00001132                           345  ; MODIFIES : NONE
00001132                           346  ; ------------------------------------------------------------------------------
00001132  48E7 FE40                347              MOVEM.L D0-D6/A1,-(A7)
00001136                           348  
00001136                           349              ; SET PEN COLOR
00001136  103C 0050                350              MOVE.B  #80,D0
0000113A  223C 00AA0000            351              MOVE.L  #BOXPCOL,D1
00001140  4E4F                     352              TRAP    #15
00001142                           353              
00001142                           354              ; SET FILL COLOR
00001142  103C 0051                355              MOVE.B  #81,D0
00001146  7200                     356              MOVE.L  #BOXFCOL,D1                                                                     
00001148  4E4F                     357              TRAP    #15                                                                             
0000114A                           358              
0000114A                           359              ; DEFINE COORDINATES
0000114A  3239 00001A1E            360              MOVE.W  (BOXPOSX),D1
00001150  3439 00001A1A            361              MOVE.W  (BOXCOL),D2
00001156  C3C2                     362              MULS.W  D2,D1
00001158  0441 005A                363              SUB.W   #BOXRAD*2,D1
0000115C                           364              
0000115C  3439 00001A20            365              MOVE.W  (BOXPOSY),D2
00001162  3639 00001A1C            366              MOVE.W  (BOXROW),D3
00001168  C5C3                     367              MULS.W  D3,D2
0000116A  0642 005A                368              ADD.W   #PIERAD*2+20,D2
0000116E  0442 0055                369              SUB.W   #BOXRAD*2-5,D2
00001172                           370              
00001172  3601                     371              MOVE.W  D1,D3
00001174  0643 005A                372              ADD.W   #BOXRAD*2,D3
00001178                           373              
00001178  3802                     374              MOVE.W  D2,D4
0000117A  0644 005A                375              ADD.W   #BOXRAD*2,D4
0000117E                           376              
0000117E                           377              ; DRAW CIRCLE
0000117E  103C 0058                378              MOVE.B  #88,D0
00001182  4E4F                     379              TRAP    #15
00001184                           380              
00001184  43F9 00001A2E            381              LEA.L   ROW1,A1
0000118A  3639 00001A1A            382              MOVE.W  (BOXCOL),D3
00001190  3839 00001A1C            383              MOVE.W  (BOXROW),D4
00001196  5343                     384              SUBQ.W  #1,D3
00001198  5344                     385              SUBQ.W  #1,D4
0000119A  D2C3                     386              ADD.W   D3,A1   
0000119C  C9FC 0007                387              MULS.W  #7,D4
000011A0  D2C4                     388              ADD.W   D4,A1
000011A2                           389              
000011A2  0C11 0000                390              CMP.B   #0,(A1)
000011A6  6700 0016                391              BEQ     .EMPTY
000011AA  3A01                     392              MOVE.W  D1,D5
000011AC  0645 002D                393              ADD.W   #BOXRAD,D5
000011B0  3C02                     394              MOVE.W  D2,D6
000011B2  0646 002D                395              ADD.W   #BOXRAD,D6
000011B6  1011                     396              MOVE.B  (A1),D0
000011B8  4EB9 000012FE            397              JSR     PIEPLOT
000011BE                           398              
000011BE                           399  .EMPTY
000011BE  4CDF 027F                400              MOVEM.L (A7)+,D0-D6/A1
000011C2                           401  
000011C2  4E75                     402              RTS
000011C4                           403  
000011C4                           404  
000011C4                           405  
000011C4                           406  
000011C4                           407  
000011C4                           408  
000011C4                           409  
000011C4                           410  
000011C4                           411  
000011C4                           412  
000011C4                           413  -------------------- end include --------------------
000011C4                           414              INCLUDE "TABLE.X68"
000011C4                           415  ; ==============================================================================
000011C4                           416  ; TABLE MANAGEMENT
000011C4                           417  ; ==============================================================================
000011C4                           418              
000011C4                           419  ; ------------------------------------------------------------------------------
000011C4                           420  TABINIT
000011C4                           421  ; INITIALIZE TABLE.
000011C4                           422  ; INPUT    : NONE 
000011C4                           423  ; OUTPUT   : NONE
000011C4                           424  ; MODIFIES : NONE
000011C4                           425  ; ------------------------------------------------------------------------------
000011C4                           426  
000011C4  48E7 8040                427              MOVEM.L D0/A1,-(A7)
000011C8                           428  
000011C8                           429              ;INITIALICE ROWS VALUES
000011C8  303C 0029                430              MOVE.W  #6*7-1,D0
000011CC  43F9 00001A2E            431              LEA.L   ROW1,A1
000011D2                           432  .LOOP       
000011D2  12BC 0000                433              MOVE.B  #0,(A1)
000011D6  5289                     434              ADD.L  #1,A1
000011D8  51C8 FFF8                435              DBRA    D0,.LOOP
000011DC                           436  
000011DC  4CDF 0201                437              MOVEM.L (A7)+,D0/A1
000011E0                           438  
000011E0  4E75                     439              RTS
000011E2                           440              
000011E2                           441  ; ------------------------------------------------------------------------------
000011E2                           442  TABPLOT
000011E2                           443  ; PLOT THE TABLE.
000011E2                           444  ; INPUT    : NONE 
000011E2                           445  ; OUTPUT   : NONE
000011E2                           446  ; MODIFIES : NONE
000011E2                           447  ; ------------------------------------------------------------------------------
000011E2                           448  
000011E2  48E7 F800                449              MOVEM.L D0-D4,-(A7)
000011E6                           450  
000011E6                           451              ; SET CONTOUR COLOR
000011E6  103C 0050                452              MOVE.B  #80,D0
000011EA  223C 00FF0000            453              MOVE.L  #TABPCOL,D1
000011F0  4E4F                     454              TRAP    #15
000011F2                           455              
000011F2                           456              ; SET FILL COLOR
000011F2  103C 0051                457              MOVE.B  #81,D0
000011F6  223C 00AA0000            458              MOVE.L  #TABFCOL,D1
000011FC  4E4F                     459              TRAP    #15
000011FE                           460              
000011FE                           461              ; DEFINE COORDINATES
000011FE  323C 0005                462              MOVE.W  #5,D1
00001202  343C 005A                463              MOVE.W  #PIERAD*2+20,D2
00001206  363C 03BB                464              MOVE.W  #SCRWIDTH-5,D3
0000120A  383C 02CB                465              MOVE.W  #SCRHEIGH-5,D4
0000120E                           466              
0000120E                           467              ; DRAW RECTANGLE
0000120E  103C 0057                468              MOVE.B  #87,D0
00001212  4E4F                     469              TRAP    #15
00001214                           470              
00001214  4CDF 001F                471              MOVEM.L (A7)+,D0-D4
00001218                           472  
00001218  4E75                     473              RTS
0000121A                           474  
0000121A                           475  
0000121A                           476  
0000121A                           477  
0000121A                           478  
0000121A                           479  
0000121A                           480  
0000121A                           481  
0000121A                           482  
0000121A                           483  
0000121A                           484  
0000121A                           485  
0000121A                           486  
0000121A                           487  
0000121A                           488  
0000121A                           489  -------------------- end include --------------------
0000121A                           490              INCLUDE "PIECE.X68"
0000121A                           491  ; ==============================================================================
0000121A                           492  ; PIECE MANAGEMENT
0000121A                           493  ; ==============================================================================
0000121A                           494              
0000121A                           495  ; ------------------------------------------------------------------------------
0000121A                           496  PIEINIT
0000121A                           497  ; INITIALIZE THE PIECE.
0000121A                           498  ; INPUT    : NONE 
0000121A                           499  ; OUTPUT   : NONE
0000121A                           500  ; MODIFIES : NONE
0000121A                           501  ; ------------------------------------------------------------------------------
0000121A                           502  
0000121A  33FC 01DF 00001A22       503              MOVE.W  #SCRWIDTH/2-1,(PIEPOSX)
00001222  33FC 002D 00001A24       504              MOVE.W  #PIERAD+10,(PIEPOSY)
0000122A                           505              
0000122A  33F9 00001A1E 00001A26   506              MOVE.W  (BOXPOSX),(PIEVELX)
00001234  33FC 0064 00001A28       507              MOVE.W  #100,(PIEVELY)
0000123C                           508              
0000123C  33FC 0003 00001A2A       509              MOVE.W  #3,(POSX)
00001244  33FC FFFF 00001A2C       510              MOVE.W  #-1,(POSY)
0000124C                           511              
0000124C  4E75                     512              RTS
0000124E                           513              
0000124E                           514  ; ------------------------------------------------------------------------------
0000124E                           515  PIEUPD
0000124E                           516  ; UPDATE THE PIECE.
0000124E                           517  ; INPUT    : NONE 
0000124E                           518  ; OUTPUT   : NONE
0000124E                           519  ; MODIFIES : NONE
0000124E                           520  ; ------------------------------------------------------------------------------
0000124E                           521              
0000124E  48A7 E000                522              MOVEM.W  D0-D2,-(A7)
00001252                           523              
00001252                           524              ; UPDATE X POSITION
00001252  3039 00001A22            525              MOVE.W  (PIEPOSX),D0
00001258                           526              
00001258                           527              ; CHECK LEFT ARROW KEY
00001258  0839 0000 00001AE8       528              BTST.B  #0,(KBDEDGE)
00001260  6700 000E                529              BEQ     .CHKRIGHT
00001264  9079 00001A26            530              SUB.W   (PIEVELX),D0
0000126A  5379 00001A2A            531              SUBQ.W  #1,(POSX)
00001270                           532              
00001270                           533              ;CHECK  RIGHT ARROW KEY
00001270  0839 0002 00001AE8       534  .CHKRIGHT   BTST.B  #2,(KBDEDGE)
00001278  6700 000E                535              BEQ     .CHKSPACE
0000127C  D079 00001A26            536              ADD.W   (PIEVELX),D0
00001282  5279 00001A2A            537              ADDQ.W  #1,(POSX)
00001288                           538              
00001288                           539              ; CHECK SPACE KEY
00001288  0839 0004 00001AE8       540  .CHKSPACE   BTST.B  #4,(KBDEDGE)
00001290  6700 0024                541              BEQ     .CONT
00001294  4EB9 00001386            542              JSR     PIEFALL
0000129A  4EB9 00001400            543              JSR     CHKCOL                  ;CHECK 4 CONNECT IN COLUMNS
000012A0  4EB9 00001460            544              JSR     CHKROW                  ;CHECK 4 CONNECT IN ROWS
000012A6  4EB9 000014BA            545              JSR     CHKDIA                  ;CHECK 4 CONNECT IN DIAGONALS
000012AC  4EB9 00001592            546              JSR     PLAUPD
000012B2  6000 0040                547              BRA     .DONE2
000012B6                           548              
000012B6                           549              ; CHECK COLISIONS
000012B6  3239 00001A26            550  .CONT       MOVE.W  (PIEVELX),D1
000012BC  0441 002C                551              SUB.W   #BOXRAD-1,D1
000012C0  B041                     552              CMP.W   D1,D0
000012C2  6C00 000E                553              BGE     .CONT2
000012C6  3001                     554              MOVE.W  D1,D0
000012C8  4279 00001A2A            555              CLR.W   (POSX)
000012CE  6000 0018                556              BRA     .DONE
000012D2                           557              
000012D2  343C 03C0                558  .CONT2      MOVE.W  #SCRWIDTH,D2
000012D6  9441                     559              SUB.W   D1,D2
000012D8  B042                     560              CMP.W   D2,D0
000012DA  6F00 000C                561              BLE     .DONE
000012DE  3002                     562              MOVE.W  D2,D0
000012E0  33FC 0006 00001A2A       563              MOVE.W  #6,(POSX)
000012E8                           564  
000012E8                           565              ; UPDATE VARIABLE
000012E8  33C0 00001A22            566  .DONE       MOVE.W  D0,(PIEPOSX) 
000012EE                           567  
000012EE  4C9F 0007                568              MOVEM.W  (A7)+,D0-D2             
000012F2                           569  
000012F2  4E75                     570              RTS
000012F4                           571              
000012F4  4EB8 121A                572  .DONE2      JSR     PIEINIT
000012F8                           573  
000012F8  4C9F 0007                574              MOVEM.W  (A7)+,D0-D2          
000012FC                           575  
000012FC  4E75                     576              RTS
000012FE                           577              
000012FE                           578  ; ------------------------------------------------------------------------------
000012FE                           579  PIEPLOT
000012FE                           580  ; PLOT THE PIECE.
000012FE                           581  ; INPUT    : D5 AS COORDINATE X OF PIECE, D6 AS COORDINATE Y OF PIECE,
000012FE                           582  ;            D0 INDICATES COLOR OF THE PIECE
000012FE                           583  ; OUTPUT   : NONE
000012FE                           584  ; MODIFIES : NONE
000012FE                           585  ; ------------------------------------------------------------------------------
000012FE  48E7 7800                586              MOVEM.L D1-D4,-(A7)
00001302                           587  
00001302  B03C 0001                588              CMP.B   #1,D0
00001306  6700 0026                589              BEQ     .COLOR1
0000130A  B03C 0015                590              CMP.B   #21,D0
0000130E  6700 003A                591              BEQ     .COLORWINNER
00001312                           592              
00001312                           593              ; SET PEN COLOR
00001312  103C 0050                594              MOVE.B  #80,D0
00001316  223C 0000AAAA            595              MOVE.L  #PIEPCOL2,D1
0000131C  4E4F                     596              TRAP    #15
0000131E                           597              
0000131E                           598              ; SET FILL COLOR
0000131E  103C 0051                599              MOVE.B  #81,D0
00001322  223C 0000FFFF            600              MOVE.L  #PIEFCOL2,D1
00001328  4E4F                     601              TRAP    #15
0000132A                           602              
0000132A  6000 0036                603              BRA     .JUMP
0000132E                           604              
0000132E                           605  .COLOR1            
0000132E                           606              ; SET PEN COLOR
0000132E  103C 0050                607              MOVE.B  #80,D0
00001332  223C 000000AA            608              MOVE.L  #PIEPCOL1,D1
00001338  4E4F                     609              TRAP    #15
0000133A                           610              
0000133A                           611              ; SET FILL COLOR
0000133A  103C 0051                612              MOVE.B  #81,D0
0000133E  223C 000000FF            613              MOVE.L  #PIEFCOL1,D1
00001344  4E4F                     614              TRAP    #15
00001346                           615              
00001346  6000 001A                616              BRA     .JUMP
0000134A                           617  
0000134A                           618  .COLORWINNER
0000134A                           619              ; SET PEN COLOR
0000134A  103C 0050                620              MOVE.B  #80,D0
0000134E  7200                     621              MOVE.L  #PIEPCOL3,D1
00001350  4E4F                     622              TRAP    #15
00001352                           623              
00001352                           624              ; SET FILL COLOR
00001352  103C 0051                625              MOVE.B  #81,D0
00001356  223C 003FEB1D            626              MOVE.L  #PIEFCOL3,D1
0000135C  4E4F                     627              TRAP    #15
0000135E                           628              
0000135E  6000 0002                629              BRA     .JUMP
00001362                           630  
00001362                           631  .JUMP            
00001362                           632              ; DEFINE COORDINATES
00001362  3205                     633              MOVE.W  D5,D1
00001364  0441 0023                634              SUB.W   #PIERAD,D1
00001368                           635              
00001368  3406                     636              MOVE.W  D6,D2
0000136A  0442 0023                637              SUB.W   #PIERAD,D2
0000136E                           638              
0000136E  3605                     639              MOVE.W  D5,D3
00001370  0643 0023                640              ADD.W   #PIERAD,D3
00001374                           641              
00001374  3806                     642              MOVE.W  D6,D4
00001376  0644 0023                643              ADD.W   #PIERAD,D4
0000137A                           644              
0000137A                           645              ; DRAW PIECE
0000137A  103C 0058                646              MOVE.B  #88,D0
0000137E  4E4F                     647              TRAP    #15
00001380                           648              
00001380  4CDF 001E                649              MOVEM.L (A7)+,D1-D4
00001384                           650  
00001384  4E75                     651              RTS
00001386                           652              
00001386                           653  ; ------------------------------------------------------------------------------
00001386                           654  PIEFALL
00001386                           655  ; LET A PIECE FALL IN A COLUMN
00001386                           656  ; INPUT    : NONE
00001386                           657  ; OUTPUT   : NONE
00001386                           658  ; MODIFIES : NONE
00001386                           659  ; ------------------------------------------------------------------------------
00001386                           660              
00001386  48E7 F840                661              MOVEM.L D0-D4/A1,-(A7)
0000138A                           662              
0000138A  3639 00001A28            663              MOVE.W  (PIEVELY),D3
00001390  343C 0005                664              MOVE.W  #5,D2
00001394  323C 0005                665              MOVE.W  #5,D1                  ;WAIT TO SEE THE PIECE FALL (MS)
00001398                           666              
00001398  43F9 00001A2E            667  .FALLAGAIN  LEA.L   ROW1,A1
0000139E  5279 00001A2C            668              ADDQ.W  #1,(POSY)
000013A4  3839 00001A2C            669              MOVE.W  (POSY),D4
000013AA  C9FC 0007                670              MULS.W  #7,D4
000013AE  D2C4                     671              ADD.W   D4,A1
000013B0  3839 00001A2A            672              MOVE.W  (POSX),D4
000013B6  D2C4                     673              ADD.W   D4,A1
000013B8  0C11 0000                674              CMP.B   #0,(A1)
000013BC  6600 0038                675              BNE     .OTHERPIE
000013C0                           676              
000013C0  303C 0017                677              MOVE.W  #23,D0
000013C4  4E4F                     678              TRAP    #15
000013C6  D779 00001A24            679              ADD.W   D3,(PIEPOSY)
000013CC  0C79 0000 00001A2C       680              CMP.W   #0,(POSY)
000013D4  6600 0008                681              BNE     .PASS
000013D8  5A79 00001A24            682              ADDQ.W  #5,(PIEPOSY)
000013DE  4EB9 000016C8            683  .PASS       JSR     GAMPLOT
000013E4  4E40                     684              TRAP    #0
000013E6  51CA FFB0                685              DBRA    D2,.FALLAGAIN
000013EA                           686              
000013EA  12B9 00001A58            687  .END        MOVE.B  (TURN),(A1)
000013F0                           688  
000013F0  4CDF 021F                689              MOVEM.L (A7)+,D0-D4/A1
000013F4                           690  
000013F4  4E75                     691              RTS
000013F6                           692  
000013F6  5F49                     693  .OTHERPIE   SUB.W   #7,A1
000013F8  5379 00001A2C            694              SUBQ.W  #1,(POSY)
000013FE  60EA                     695              BRA     .END
00001400                           696              
00001400                           697  ; ------------------------------------------------------------------------------
00001400                           698  CHKCOL
00001400                           699  ; CHECK IF SOME COLUMN HAVE 4 PIECES CONNECTED
00001400                           700  ; INPUT    : NONE
00001400                           701  ; OUTPUT   : NONE
00001400                           702  ; MODIFIES : NONE
00001400                           703  ; ------------------------------------------------------------------------------
00001400                           704  
00001400  48E7 E070                705              MOVEM.L D0-D2/A1-A3,-(A7)
00001404                           706              
00001404  43F9 00001A2E            707              LEA.L   ROW1,A1
0000140A  7006                     708              MOVE.L  #BOXNCOL-1,D0
0000140C                           709  .CHECK_NEXT_COL
0000140C  2449                     710              MOVE.L  A1,A2
0000140E  5289                     711              ADD.L   #1,A1
00001410  7202                     712              MOVE.L  #BOXNROW-3-1,D1
00001412                           713              
00001412                           714  .CHECK_POSITION_COL
00001412  264A                     715              MOVE.L  A2,A3
00001414  5E8A                     716              ADD.L   #7,A2
00001416                           717              
00001416  4282                     718              CLR.L   D2
00001418  1413                     719              MOVE.B  (A3),D2
0000141A  5E8B                     720              ADD.L   #7,A3
0000141C  D413                     721              ADD.B   (A3),D2
0000141E  5E8B                     722              ADD.L   #7,A3
00001420  D413                     723              ADD.B   (A3),D2
00001422  5E8B                     724              ADD.L   #7,A3
00001424  D413                     725              ADD.B   (A3),D2
00001426                           726              
00001426  B43C 0004                727              CMP.B   #4,D2
0000142A  6700 0018                728              BEQ     .PLAYERWINS_COL
0000142E  B43C 0014                729              CMP.B   #20,D2
00001432  6700 0010                730              BEQ     .PLAYERWINS_COL
00001436                           731              
00001436  51C9 FFDA                732              DBRA    D1,.CHECK_POSITION_COL
0000143A                           733              
0000143A  51C8 FFD0                734              DBRA    D0,.CHECK_NEXT_COL
0000143E                           735              
0000143E  4CDF 0E07                736              MOVEM.L (A7)+,D0-D2/A1-A3
00001442                           737              
00001442  4E75                     738              RTS
00001444                           739              
00001444                           740  .PLAYERWINS_COL
00001444  13F9 00001A58 00001A59   741              MOVE.B  (TURN),(WINNER)  
0000144E                           742  
0000144E  7003                     743              MOVE.L  #3,D0
00001450                           744  .LOOP_COL
00001450  16BC 0015                745              MOVE.B  #21,(A3)
00001454  5F8B                     746              SUB.L   #7,A3
00001456  51C8 FFF8                747              DBRA    D0,.LOOP_COL
0000145A                           748                      
0000145A  4CDF 0E07                749              MOVEM.L (A7)+,D0-D2/A1-A3
0000145E  4E75                     750              RTS
00001460                           751  
00001460                           752  ; ------------------------------------------------------------------------------
00001460                           753  CHKROW
00001460                           754  ; CHECK IF SOME ROW HAVE 4 PIECES CONNECTED
00001460                           755  ; INPUT    : NONE
00001460                           756  ; OUTPUT   : NONE
00001460                           757  ; MODIFIES : NONE
00001460                           758  ; ------------------------------------------------------------------------------
00001460                           759  
00001460  48E7 E070                760              MOVEM.L D0-D2/A1-A3,-(A7)
00001464                           761              
00001464  43F9 00001A2E            762              LEA.L   ROW1,A1
0000146A  7005                     763              MOVE.L  #BOXNROW-1,D0
0000146C                           764  .CHECK_NEXT_ROW
0000146C  2449                     765              MOVE.L  A1,A2
0000146E  5E89                     766              ADD.L   #7,A1
00001470  7203                     767              MOVE.L  #BOXNCOL-3-1,D1
00001472                           768              
00001472                           769  .CHECK_POSITION_ROW
00001472  264A                     770              MOVE.L  A2,A3
00001474  528A                     771              ADD.L   #1,A2
00001476                           772              
00001476  4282                     773              CLR.L   D2
00001478  141B                     774              MOVE.B   (A3)+,D2
0000147A  D41B                     775              ADD.B   (A3)+,D2
0000147C  D41B                     776              ADD.B   (A3)+,D2
0000147E  D413                     777              ADD.B   (A3),D2
00001480                           778              
00001480  B43C 0004                779              CMP.B   #4,D2
00001484  6700 0018                780              BEQ     .PLAYERWINS_ROW
00001488  B43C 0014                781              CMP.B   #20,D2
0000148C  6700 0010                782              BEQ     .PLAYERWINS_ROW
00001490                           783              
00001490  51C9 FFE0                784              DBRA    D1,.CHECK_POSITION_ROW
00001494                           785              
00001494  51C8 FFD6                786              DBRA    D0,.CHECK_NEXT_ROW
00001498                           787              
00001498  4CDF 0E07                788              MOVEM.L (A7)+,D0-D2/A1-A3
0000149C                           789              
0000149C  4E75                     790              RTS
0000149E                           791  
0000149E                           792  .PLAYERWINS_ROW
0000149E  13F9 00001A58 00001A59   793              MOVE.B  (TURN),(WINNER)
000014A8                           794              
000014A8  7003                     795              MOVE.L  #3,D0
000014AA                           796  .LOOP_ROW
000014AA  16BC 0015                797              MOVE.B  #21,(A3)
000014AE  538B                     798              SUB.L   #1,A3
000014B0  51C8 FFF8                799              DBRA    D0,.LOOP_ROW
000014B4                           800              
000014B4  4CDF 0E07                801              MOVEM.L (A7)+,D0-D2/A1-A3
000014B8  4E75                     802              RTS
000014BA                           803  
000014BA                           804  ; ------------------------------------------------------------------------------
000014BA                           805  CHKDIA
000014BA                           806  ; CHECK IF SOME DIAGONAL HAVE 4 PIECES CONNECTED
000014BA                           807  ; INPUT    : NONE
000014BA                           808  ; OUTPUT   : NONE
000014BA                           809  ; MODIFIES : NONE
000014BA                           810  ; ------------------------------------------------------------------------------
000014BA                           811  
000014BA  48E7 FE70                812              MOVEM.L D0-D6/A1-A3,-(A7)
000014BE                           813              
000014BE  43F9 00001A2E            814              LEA.L   ROW1,A1
000014C4                           815             
000014C4  7C08                     816              MOVE.L  #8,D6
000014C6  7201                     817              MOVE.L  #1,D1
000014C8                           818  .LOOP_TO_OTHER_SIDE 
000014C8                           819             
000014C8  7A07                     820              MOVE.L  #7,D5
000014CA  7401                     821              MOVE.L  #1,D2
000014CC                           822  .LOOP_DIAGONALS_ROW1
000014CC                           823  
000014CC  2449                     824              MOVE.L  A1,A2
000014CE                           825              ;DIAGONAL OF (0,0) AND (6,0) / (1,0) AND (5,0)            
000014CE  7602                     826              MOVE.L  #2,D3
000014D0                           827  .LOOP1
000014D0  264A                     828              MOVE.L  A2,A3
000014D2  D5C6                     829              ADD.L   D6,A2
000014D4                           830              
000014D4  4EB9 00001548            831              JSR     CHECK_DIAGONALS
000014DA  0C39 0000 00001A59       832              CMP.B   #0,(WINNER)
000014E2  6600 005E                833              BNE     .FINISH_DIA
000014E6                           834             
000014E6  51CB FFE8                835              DBRA    D3,.LOOP1
000014EA                           836              
000014EA                           837              ;DIAGONAL OF (0,1) AND (6,1) / (2,0) AND (4,0)
000014EA  2449                     838              MOVE.L  A1,A2
000014EC  D5C5                     839              ADD.L   D5,A2
000014EE                           840              
000014EE  7601                     841              MOVE.L  #1,D3
000014F0                           842  .LOOP2
000014F0  264A                     843              MOVE.L  A2,A3
000014F2  D5C6                     844              ADD.L   D6,A2
000014F4                           845              
000014F4  4EB9 00001548            846              JSR     CHECK_DIAGONALS
000014FA  0C39 0000 00001A59       847              CMP.B   #0,(WINNER)
00001502  6600 003E                848              BNE     .FINISH_DIA
00001506                           849             
00001506  51CB FFE8                850              DBRA    D3,.LOOP2
0000150A                           851              
0000150A                           852              ;DIAGONAL OF (0,2) AND (6,2) / (3,0)
0000150A  2649                     853              MOVE.L  A1,A3
0000150C  D7C5                     854              ADD.L   D5,A3
0000150E  D7C5                     855              ADD.L   D5,A3
00001510                           856              
00001510  4EB9 00001548            857              JSR     CHECK_DIAGONALS
00001516  0C39 0000 00001A59       858              CMP.B   #0,(WINNER)
0000151E  6600 0022                859              BNE     .FINISH_DIA          
00001522                           860              
00001522  B2BC 00000000            861              CMP.L   #0,D1
00001528  6700 0008                862              BEQ     .MINUS1
0000152C  7A01                     863              MOVE.L  #1,D5
0000152E  6000 0004                864              BRA     .PASS_DIA
00001532  7AFF                     865  .MINUS1     MOVE.L  #-1,D5
00001534  D3C5                     866  .PASS_DIA   ADD.L   D5,A1
00001536  51CA FF94                867              DBRA    D2,.LOOP_DIAGONALS_ROW1
0000153A                           868              
0000153A  5A89                     869              ADD.L   #5,A1
0000153C  7C06                     870              MOVE.L  #6,D6
0000153E  51C9 FF88                871              DBRA    D1,.LOOP_TO_OTHER_SIDE
00001542                           872  
00001542                           873  .FINISH_DIA
00001542  4CDF 0E7F                874              MOVEM.L (A7)+,D0-D6/A1-A3            
00001546  4E75                     875              RTS
00001548                           876  
00001548                           877  CHECK_DIAGONALS
00001548  4280                     878              CLR.L   D0
0000154A  1013                     879              MOVE.B  (A3),D0
0000154C  D7C6                     880              ADD.L   D6,A3
0000154E  D013                     881              ADD.B   (A3),D0
00001550  D7C6                     882              ADD.L   D6,A3
00001552  D013                     883              ADD.B   (A3),D0
00001554  D7C6                     884              ADD.L   D6,A3
00001556  D013                     885              ADD.B   (A3),D0
00001558                           886              
00001558  B03C 0004                887              CMP.B   #4,D0
0000155C  6700 000C                888              BEQ     .PLAYERWINS_DIA
00001560  B03C 0014                889              CMP.B   #20,D0
00001564  6700 0004                890              BEQ     .PLAYERWINS_DIA
00001568                           891              
00001568  4E75                     892              RTS
0000156A                           893             
0000156A                           894  .PLAYERWINS_DIA
0000156A  13F9 00001A58 00001A59   895              MOVE.B  (TURN),(WINNER)  
00001574                           896  
00001574  7003                     897              MOVE.L  #3,D0
00001576                           898  .LOOP_DIA
00001576  16BC 0015                899              MOVE.B  #21,(A3)
0000157A  97C6                     900              SUB.L   D6,A3
0000157C  51C8 FFF8                901              DBRA    D0,.LOOP_DIA
00001580                           902                     
00001580  4E75                     903              RTS
00001582                           904  
00001582                           905  
00001582                           906  
00001582                           907  
00001582                           908  
00001582                           909  
00001582                           910  
00001582                           911  
00001582                           912  
00001582                           913  
00001582                           914  
00001582                           915  -------------------- end include --------------------
00001582                           916              INCLUDE "PLAYER.X68"
00001582                           917  ; ==============================================================================
00001582                           918  ; PLAYERS MANAGEMENT
00001582                           919  ; ==============================================================================
00001582                           920             
00001582                           921  ; ------------------------------------------------------------------------------
00001582                           922  PLAINIT
00001582                           923  ; INITIALIZE PLAYER.
00001582                           924  ; INPUT    : NONE 
00001582                           925  ; OUTPUT   : NONE
00001582                           926  ; MODIFIES : NONE
00001582                           927  ; ------------------------------------------------------------------------------
00001582                           928              
00001582  13FC 0001 00001A58       929              MOVE.B  #1,(TURN)               ; STARTS THE PLAYER 1
0000158A  4239 00001A59            930              CLR.B   (WINNER)
00001590                           931              
00001590  4E75                     932              RTS
00001592                           933              
00001592                           934  ; ------------------------------------------------------------------------------
00001592                           935  PLAUPD
00001592                           936  ; UPDATES THE PLAYER.
00001592                           937  ; INPUT    : NONE 
00001592                           938  ; OUTPUT   : NONE
00001592                           939  ; MODIFIES : NONE
00001592                           940  ; ------------------------------------------------------------------------------
00001592                           941              
00001592  0C39 0001 00001A58       942              CMP.B   #1,(TURN)               
0000159A  6700 000C                943              BEQ     .PLAYER2                ; SWAPS TURN
0000159E  13FC 0001 00001A58       944              MOVE.B  #1,(TURN)               ; PLAYER 1 TURN   
000015A6                           945              
000015A6  4E75                     946              RTS
000015A8                           947              
000015A8  13FC 0005 00001A58       948  .PLAYER2    MOVE.B  #5,(TURN)               ; PLAYER 2 TURN
000015B0                           949              
000015B0  4E75                     950              RTS
000015B2                           951              
000015B2                           952  
000015B2                           953  
000015B2                           954  
000015B2                           955  
000015B2                           956  
000015B2                           957  
000015B2                           958  -------------------- end include --------------------
000015B2                           959              INCLUDE "BOARD.X68"
000015B2                           960  ; ==============================================================================
000015B2                           961  ; BOARD MANAGEMENT
000015B2                           962  ; ==============================================================================
000015B2                           963              
000015B2                           964  ; ------------------------------------------------------------------------------
000015B2                           965  BOAPLOT
000015B2                           966  ; PLOT THE BOARD
000015B2                           967  ; INPUT    : NONE 
000015B2                           968  ; OUTPUT   : NONE
000015B2                           969  ; MODIFIES : NONE
000015B2                           970  ; ------------------------------------------------------------------------------
000015B2                           971  
000015B2  48E7 C040                972              MOVEM.L D0-D1/A1,-(A7)
000015B6                           973  
000015B6                           974              ; SET BACKGROUND COLOR
000015B6  103C 0051                975              MOVE.B  #81,D0
000015BA  7200                     976              MOVE.L  #BOAFCOL,D1
000015BC  4E4F                     977              TRAP    #15
000015BE                           978              
000015BE                           979              ; SET FIRST LINE POSITION (SCREEN ARRAY COLUMNS = 120 ROWS = 47)
000015BE  103C 000B                980              MOVE.B  #11,D0
000015C2  323C 0000                981              MOVE.W  #$0000,D1
000015C6  4E4F                     982              TRAP    #15
000015C8                           983              
000015C8  0C39 0000 00001A59       984              CMP.B   #0,(WINNER)
000015D0  6600 002E                985              BNE     .WINNER_LINE
000015D4                           986  
000015D4                           987              ; PRINT LINE
000015D4  43F9 0000162E            988              LEA.L   .TXT1,A1
000015DA  4281                     989              CLR.L   D1
000015DC  0C39 0001 00001A58       990              CMP.B   #1,(TURN)
000015E4  6700 000E                991              BEQ     .PLAYER1
000015E8  7202                     992              MOVE.L  #2,D1
000015EA  103C 0011                993              MOVE.B  #17,D0
000015EE  4E4F                     994              TRAP    #15
000015F0  6000 0036                995              BRA     .PASS
000015F4                           996              
000015F4                           997  .PLAYER1            
000015F4  7201                     998              MOVE.L  #1,D1
000015F6  103C 0011                999              MOVE.B  #17,D0
000015FA  4E4F                    1000              TRAP    #15            
000015FC  6000 002A               1001              BRA     .PASS
00001600                          1002              
00001600                          1003  .WINNER_LINE
00001600                          1004              ; PRINT LINE
00001600  43F9 0000163D           1005              LEA.L   .TXT2,A1
00001606  4281                    1006              CLR.L   D1
00001608  0C39 0001 00001A59      1007              CMP.B   #1,(WINNER)
00001610  6700 000E               1008              BEQ     .PLAYER1_WIN
00001614  7202                    1009              MOVE.L  #2,D1
00001616  103C 0011               1010              MOVE.B  #17,D0
0000161A  4E4F                    1011              TRAP    #15
0000161C  6000 000A               1012              BRA     .PASS
00001620                          1013              
00001620                          1014  .PLAYER1_WIN
00001620  7201                    1015              MOVE.L  #1,D1
00001622  103C 0011               1016              MOVE.B  #17,D0
00001626  4E4F                    1017              TRAP    #15
00001628                          1018  
00001628                          1019  .PASS      
00001628  4CDF 0203               1020              MOVEM.L (A7)+,D0-D1/A1
0000162C                          1021              
0000162C  4E75                    1022              RTS
0000162E                          1023              
0000162E= 50 4C 41 59 45 52 ...   1024  .TXT1       DC.B    'PLAYER TURN: ',0
0000163C= 00                      1025              DC.B    0            
0000163D= 57 49 4E 53 20 50 ...   1026  .TXT2       DC.B    'WINS PLAYER ',0
0000164A                          1027  
0000164A                          1028  
0000164A                          1029  
0000164A                          1030  
0000164A                          1031  
0000164A                          1032  
0000164A                          1033  
0000164A                          1034  -------------------- end include --------------------
0000164A                          1035              INCLUDE "FILE.X68"
0000164A                          1036  ; ==============================================================================
0000164A                          1037  ; FILE MANAGEMENT
0000164A                          1038  ; ==============================================================================
0000164A                          1039  
0000164A                          1040  ; ------------------------------------------------------------------------------
0000164A                          1041  FILINIT
0000164A                          1042  ; INITIALIZE FILE
0000164A                          1043  ; INPUT    : NONE 
0000164A                          1044  ; OUTPUT   : NONE
0000164A                          1045  ; MODIFIES : NONE
0000164A                          1046  ; ------------------------------------------------------------------------------
0000164A                          1047  
0000164A  48E7 C040               1048              MOVEM.L  D0-D1/A1,-(A7)
0000164E                          1049              
0000164E  43F9 00001A64           1050              LEA.L   READED,A1
00001654  703E                    1051              MOVE.L  #(126/2)-1,D0
00001656  4259                    1052  .LOOP1      CLR.W   (A1)+
00001658  51C8 FFFC               1053              DBRA    D0,.LOOP1
0000165C                          1054                   
0000165C  43F9 00001672           1055              LEA.L  .TXT,A1
00001662  7033                    1056              MOVE.L  #51,D0
00001664  4E4F                    1057              TRAP    #15
00001666                          1058              
00001666  23C1 00001A60           1059              MOVE.L  D1,(FILEID)             ;KEEP THE ID OF THE FILE
0000166C                          1060              
0000166C  4CDF 0203               1061              MOVEM.L  (A7)+,D0-D1/A1
00001670  4E75                    1062              RTS
00001672                          1063  
00001672= 61 75 74 6F 6D 61 ...   1064  .TXT        DC.B    'automaticgame.txt',0
00001684                          1065  
00001684                          1066  ; ------------------------------------------------------------------------------
00001684                          1067  READFILE
00001684                          1068  ; READ THE FILE THAT CONTAINS THE MOVES
00001684                          1069  ; INPUT    : NONE 
00001684                          1070  ; OUTPUT   : NONE
00001684                          1071  ; MODIFIES : NONE
00001684                          1072  ; ------------------------------------------------------------------------------
00001684                          1073  
00001684  48E7 E040               1074              MOVEM.L  D0-D2/A1,-(A7)
00001688                          1075              
00001688  43F9 00001A64           1076              LEA.L   READED,A1
0000168E  7035                    1077              MOVE.L  #53,D0
00001690  2239 00001A60           1078              MOVE.L  (FILEID),D1
00001696  747E                    1079              MOVE.L  #126,D2
00001698  4E4F                    1080              TRAP    #15
0000169A                          1081              
0000169A                          1082              ;CEAN READED
0000169A  43F9 00001A64           1083              LEA.L   READED,A1
000016A0  5302                    1084              SUBQ.B  #1,D2                   ;D2 = BYTES READED
000016A2  0419 0030               1085  .LOOP2      SUB.B   #$30,(A1)+
000016A6  51CA FFFA               1086              DBRA    D2,.LOOP2                
000016AA                          1087              
000016AA  4CDF 0207               1088              MOVEM.L  (A7)+,D0-D2/A1
000016AE  4E75                    1089              RTS
000016AE  4E75                    1090  -------------------- end include --------------------
000016B0                          1091              INCLUDE "GAME.X68"
000016B0                          1092  ; ==============================================================================
000016B0                          1093  ; GAME MANAGEMENT
000016B0                          1094  ; ==============================================================================
000016B0                          1095  
000016B0                          1096  ; ------------------------------------------------------------------------------
000016B0                          1097  GAMINIT
000016B0                          1098  ; INITIALIZES GAME.
000016B0                          1099  ; INPUT    : NONE
000016B0                          1100  ; OUTPUT   : NONE
000016B0                          1101  ; MODIFIES : NONE
000016B0                          1102  ; ------------------------------------------------------------------------------
000016B0  4EB8 11C4               1103              JSR     TABINIT
000016B4  4EB8 111E               1104              JSR     BOXINIT
000016B8  4EB8 121A               1105              JSR     PIEINIT
000016BC  4EB8 1582               1106              JSR     PLAINIT
000016C0  4E75                    1107              RTS
000016C2                          1108  
000016C2                          1109  ; ------------------------------------------------------------------------------
000016C2                          1110  GAMUPD
000016C2                          1111  ; UPDATES THE GAME
000016C2                          1112  ; INPUT    : NONE
000016C2                          1113  ; OUTPUT   : NONE
000016C2                          1114  ; MODIFIES : NONE
000016C2                          1115  ; ------------------------------------------------------------------------------
000016C2                          1116  
000016C2  4EB8 124E               1117              JSR     PIEUPD
000016C6                          1118  
000016C6  4E75                    1119              RTS
000016C8                          1120  
000016C8                          1121  ; ------------------------------------------------------------------------------
000016C8                          1122  GAMPLOT
000016C8                          1123  ; PLOTS THE GAME
000016C8                          1124  ; INPUT    : NONE
000016C8                          1125  ; OUTPUT   : NONE
000016C8                          1126  ; MODIFIES : NONE
000016C8                          1127  ; ------------------------------------------------------------------------------
000016C8  48E7 FE00               1128              MOVEM.L D0-D6,-(A7)
000016CC                          1129              
000016CC  4EB8 11E2               1130              JSR     TABPLOT
000016D0                          1131              
000016D0  303C 0006               1132              MOVE.W  #BOXNCOL-1,D0
000016D4                          1133  .PLOT_NEXT_COL
000016D4  343C 0007               1134              MOVE.W  #BOXNCOL,D2
000016D8  9440                    1135              SUB.W   D0,D2
000016DA  33C2 00001A1A           1136              MOVE.W  D2,(BOXCOL)
000016E0                          1137              
000016E0  323C 0005               1138              MOVE.W  #BOXNROW-1,D1
000016E4                          1139  .PLOT_NEXT_ROW
000016E4  343C 0006               1140              MOVE.W  #BOXNROW,D2
000016E8  9441                    1141              SUB.W   D1,D2
000016EA  33C2 00001A1C           1142              MOVE.W  D2,(BOXROW)
000016F0                          1143              
000016F0  4EB8 1132               1144              JSR     BOXPLOT
000016F4                          1145              
000016F4  51C9 FFEE               1146              DBRA    D1,.PLOT_NEXT_ROW
000016F8  51C8 FFDA               1147              DBRA    D0,.PLOT_NEXT_COL
000016FC                          1148              
000016FC  3A39 00001A22           1149              MOVE.W  (PIEPOSX),D5
00001702  3C39 00001A24           1150              MOVE.W  (PIEPOSY),D6
00001708  1039 00001A58           1151              MOVE.B  (TURN),D0
0000170E  4EB8 12FE               1152              JSR     PIEPLOT
00001712  4EB8 15B2               1153              JSR     BOAPLOT                 
00001716                          1154              
00001716  4CDF 007F               1155              MOVEM.L (A7)+,D0-D6
0000171A                          1156              
0000171A  4E75                    1157              RTS
0000171C                          1158  
0000171C                          1159  -------------------- end include --------------------
0000171C                          1160              INCLUDE "INTRO.X68"
0000171C                          1161  ; ---------------------------------------------------------------------
0000171C                          1162  ; INTRO SCREEN
0000171C                          1163  ; ---------------------------------------------------------------------
0000171C                          1164  
0000171C                          1165  ; ------------------------------------------------------------------------------
0000171C                          1166  ISCINIT
0000171C                          1167  ; INTRO SCREEN INIT
0000171C                          1168  ; INPUT    : NONE 
0000171C                          1169  ; OUTPUT   : NONE
0000171C                          1170  ; MODIFIES : NONE
0000171C                          1171  ; ------------------------------------------------------------------------------
0000171C                          1172              
0000171C                          1173              ;CLR.W   (ISCTIMER)
0000171C  33FC 003C 00001AE2      1174              MOVE.W  #$003C,(INTROX)         ;SCREEN ARRAY COLUMNS = 120
00001724  33FC 0013 00001AE4      1175              MOVE.W  #$0013,(INTROY)         ;SCREEN ARRAY ROWS = 47
0000172C  4239 00001AE6           1176              CLR.B   (SHOWINTRO)
00001732                          1177              
00001732  4E75                    1178              RTS
00001734                          1179              
00001734                          1180  ; ------------------------------------------------------------------------------
00001734                          1181  ISCUPDT
00001734                          1182  ; INTRO SCREEN UPDATE
00001734                          1183  ; INPUT    : NONE 
00001734                          1184  ; OUTPUT   : NONE
00001734                          1185  ; MODIFIES : NONE
00001734                          1186  ; ------------------------------------------------------------------------------
00001734                          1187              
00001734  48E7 C000               1188              MOVEM.L  D0-D1,-(A7)
00001738                          1189              
00001738  7264                    1190              MOVE.L  #100,D1
0000173A  7017                    1191              MOVE.L  #23,D0
0000173C  4E4F                    1192              TRAP    #15
0000173E                          1193              
0000173E  0C39 0001 00001AE6      1194              CMP.B   #1,(SHOWINTRO)
00001746  6700 000E               1195              BEQ     .NOT1
0000174A  13FC 0001 00001AE6      1196              MOVE.B  #1,(SHOWINTRO)
00001752  6000 0008               1197              BRA     .DONE
00001756  4239 00001AE6           1198  .NOT1       CLR.B   (SHOWINTRO)
0000175C                          1199  .DONE            
0000175C  4CDF 0003               1200              MOVEM.L (A7)+,D0-D1
00001760  4E75                    1201              RTS
00001762                          1202              
00001762                          1203  ; ------------------------------------------------------------------------------
00001762                          1204  ISCPLOT
00001762                          1205  ; INTRO SCREEN PLOT
00001762                          1206  ; INPUT    : NONE 
00001762                          1207  ; OUTPUT   : NONE
00001762                          1208  ; MODIFIES : NONE
00001762                          1209  ; ------------------------------------------------------------------------------
00001762                          1210              
00001762  48E7 F8E0               1211              MOVEM.L  D0-D4/A0-A2,-(A7)
00001766                          1212              
00001766  700B                    1213              MOVE.L  #11,D0
00001768  323C FF00               1214              MOVE.W  #$FF00,D1
0000176C  4E4F                    1215              TRAP    #15
0000176E                          1216             
0000176E  4281                    1217              CLR.L   D1
00001770  3639 00001AE4           1218              MOVE.W  (INTROY),D3
00001776                          1219              
00001776  45F9 0000187E           1220              LEA.L   .TXTLST,A2
0000177C                          1221              
0000177C  0C39 0001 00001AE6      1222              CMP.B   #1,(SHOWINTRO)
00001784  6700 0008               1223              BEQ     .SHOW
00001788  7804                    1224              MOVE.L  #4,D4
0000178A  6000 0004               1225              BRA     .LOOP
0000178E  7805                    1226  .SHOW       MOVE.L  #5,D4
00001790                          1227          
00001790  3439 00001AE2           1228  .LOOP       MOVE.W  (INTROX),D2
00001796  201A                    1229              MOVE.L  (A2)+,D0
00001798  2040                    1230              MOVE.L  D0,A0
0000179A                          1231              
0000179A  4EB8 1106               1232              JSR     UTLSTRLEN
0000179E  80FC 0002               1233              DIVU    #2,D0
000017A2  9440                    1234              SUB.W   D0,D2
000017A4                          1235              
000017A4  3202                    1236              MOVE.W  D2,D1
000017A6  E149                    1237              LSL.W   #8,D1
000017A8  D203                    1238              ADD.B   D3,D1
000017AA                          1239              
000017AA  700B                    1240              MOVE.L  #11,D0
000017AC  4E4F                    1241              TRAP    #15
000017AE                          1242              
000017AE  2248                    1243              MOVE.L  A0,A1
000017B0  103C 000E               1244              MOVE.B  #14,D0
000017B4  4E4F                    1245              TRAP    #15
000017B6                          1246              
000017B6  5443                    1247              ADD.W   #$0002,D3
000017B8  51CC FFD6               1248              DBRA    D4,.LOOP
000017BC                          1249              
000017BC  4CDF 071F               1250              MOVEM.L (A7)+,D0-D4/A0-A2
000017C0                          1251  
000017C0  4E75                    1252              RTS
000017C2                          1253  
000017C2= 43 4F 4E 4E 45 43 ...   1254  .TXT1       DC.B    'CONNECT-4',0
000017CC= 00                      1255              DC.B    0
000017CD= 54 52 59 20 54 4F ...   1256  .TXT2       DC.B    'TRY TO CONNECT 4 PIECES IN A LINE',0
000017EF= 55 53 45 20 4C 45 ...   1257  .TXT3       DC.B    'USE LEFT AND RIGHT ARROWS TO SELECT PIECE POSITION',0
00001822= 50 52 45 53 53 20 ...   1258  .TXT4       DC.B    'PRESS SPACE TO PLACE A PIECE',0
0000183F= 41 46 54 45 52 20 ...   1259  .TXT5       DC.B    'AFTER PLACING A PIECE THE TURN WILL SWAP',0
00001868= 50 52 45 53 53 20 ...   1260  .TXT6       DC.B    'PRESS SPACE TO START',0
0000187E= 000017C2 000017CD ...   1261  .TXTLST     DC.L    .TXT1,.TXT2,.TXT3,.TXT4,.TXT5,.TXT6,0
0000189A                          1262  
0000189A                          1263  
0000189A                          1264  
0000189A                          1265  
0000189A                          1266  
0000189A                          1267  -------------------- end include --------------------
0000189A                          1268              INCLUDE "INSTRUCT.X68"
0000189A                          1269  ; ---------------------------------------------------------------------
0000189A                          1270  ; INSTRUCTIONS SCREEN
0000189A                          1271  ; ---------------------------------------------------------------------
0000189A                          1272  
0000189A                          1273  ; ------------------------------------------------------------------------------
0000189A                          1274  INSINIT
0000189A                          1275  ; INSTRUCTIONS SCREEN INIT
0000189A                          1276  ; INPUT    : NONE 
0000189A                          1277  ; OUTPUT   : NONE
0000189A                          1278  ; MODIFIES : NONE
0000189A                          1279  ; ------------------------------------------------------------------------------
0000189A                          1280  
0000189A  4E75                    1281              RTS
0000189C                          1282              
0000189C                          1283  ; ------------------------------------------------------------------------------
0000189C                          1284  INSUPD
0000189C                          1285  ; INTRO SCREEN UPTDATE
0000189C                          1286  ; INPUT    : NONE 
0000189C                          1287  ; OUTPUT   : NONE
0000189C                          1288  ; MODIFIES : NONE
0000189C                          1289  ; ------------------------------------------------------------------------------
0000189C                          1290  
0000189C  4E75                    1291              RTS
0000189E                          1292              
0000189E                          1293  ; ------------------------------------------------------------------------------
0000189E                          1294  INSPLOT
0000189E                          1295  ; INSTRUCTIONS SCREEN PLOT
0000189E                          1296  ; INPUT    : NONE 
0000189E                          1297  ; OUTPUT   : NONE
0000189E                          1298  ; MODIFIES : NONE
0000189E                          1299  ; ------------------------------------------------------------------------------
0000189E  48E7 C0C0               1300              MOVEM.L  D0-D1/A0-A1,-(A7)
000018A2                          1301              
000018A2  4281                    1302              CLR.L   D1
000018A4  103C 0051               1303              MOVE.B  #81,D0
000018A8  4E4F                    1304              TRAP    #15
000018AA                          1305              
000018AA  103C 0008               1306              MOVE.B  #8,D0
000018AE  43F9 00001964           1307              LEA     .TXTLST,A1
000018B4  2219                    1308  .LOOP       MOVE.L  (A1)+,D1
000018B6  6700 000A               1309              BEQ     .DONE
000018BA  2041                    1310              MOVE.L  D1,A0
000018BC  4EB8 10DE               1311              JSR     UTLPRINT
000018C0  60F2                    1312              BRA     .LOOP
000018C2                          1313              
000018C2  4CDF 0303               1314  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
000018C6                          1315  
000018C6                          1316  
000018C6  4E75                    1317              RTS
000018C8                          1318  
000018C8= 54 52 59 20 54 4F ...   1319  .TXT1       DC.B    'TRY TO CONNECT 4 PIECES IN A LINE',0
000018EA= 55 53 45 20 4C 45 ...   1320  .TXT2       DC.B    'USE LEFT AND RIGHT ARROWS TO SELECT PIECE POSITION',0
0000191D= 50 52 45 53 53 20 ...   1321  .TXT3       DC.B    'PRESS SPACE TO PLACE A PIECE',0
0000193A= 41 46 54 45 52 20 ...   1322  .TXT4       DC.B    'AFTER PLACING A PIECE THE TURN WILL SWAP',0
00001964                          1323              DS.W    0
00001964= 000018C8 000018EA ...   1324  .TXTLST     DC.L    .TXT1,.TXT2,.TXT3,.TXT4,0
00001978                          1325  
00001978                          1326  -------------------- end include --------------------
00001978                          1327              INCLUDE "STATES.X68"
00001978                          1328  ; =============================================================================
00001978                          1329  ; GAME STATE MANAGEMENT
00001978                          1330  ; =============================================================================
00001978                          1331  
00001978                          1332  ; -----------------------------------------------------------------------------
00001978                          1333  STAINIT
00001978                          1334  ; INITALIZES THE STATE MANAGER
00001978                          1335  ; INPUT    - NONE
00001978                          1336  ; OUTPUT   - NONE
00001978                          1337  ; MODIFIES - NONE
00001978                          1338  ; -----------------------------------------------------------------------------
00001978  33FC FFFF 00001A5C      1339              MOVE.W  #STANONE,(STACUR)
00001980  4279 00001A5E           1340              CLR.W   (STANEXT)
00001986  4E75                    1341              RTS
00001988                          1342  
00001988                          1343  ; -----------------------------------------------------------------------------
00001988                          1344  STAUPD
00001988                          1345  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00001988                          1346  ; INPUT    - NONE
00001988                          1347  ; OUTPUT   - NONE
00001988                          1348  ; MODIFIES - NONE
00001988                          1349  ; -----------------------------------------------------------------------------
00001988  48E7 8080               1350              MOVEM.L D0/A0,-(A7)
0000198C  4280                    1351              CLR.L   D0
0000198E  3039 00001A5E           1352              MOVE.W  (STANEXT),D0
00001994  B079 00001A5C           1353              CMP.W   (STACUR),D0
0000199A  6700 0012               1354              BEQ     .DOUPD
0000199E  33C0 00001A5C           1355              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
000019A4  E588                    1356              LSL.L   #2,D0
000019A6  2040                    1357              MOVE.L  D0,A0
000019A8  2068 19C2               1358              MOVE.L  .INITBL(A0),A0
000019AC  4E90                    1359              JSR     (A0)
000019AE  4280                    1360  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
000019B0  3039 00001A5C           1361              MOVE.W  (STACUR),D0
000019B6  E588                    1362              LSL.L   #2,D0
000019B8  2040                    1363              MOVE.L  D0,A0
000019BA                          1364  ;            MOVE.L  .UPDTBL(A0),A0
000019BA  4E90                    1365              JSR     (A0)
000019BC  4CDF 0101               1366              MOVEM.L (A7)+,D0/A0
000019C0  4E75                    1367              RTS
000019C2= 0000171C 0000189A ...   1368  .INITBL     DC.L    ISCINIT,INSINIT,GAMINIT
000019CE                          1369  ;.UPDTBL     DC.L    ISCUPD,INSUPD,GAMUPD
000019CE                          1370  
000019CE                          1371  ; -----------------------------------------------------------------------------
000019CE                          1372  STAPLOT
000019CE                          1373  ; PERFORMS STATE PLOT
000019CE                          1374  ; INPUT    - NONE
000019CE                          1375  ; OUTPUT   - NONE
000019CE                          1376  ; MODIFIES - NONE
000019CE                          1377  ; -----------------------------------------------------------------------------
000019CE  48E7 8080               1378              MOVEM.L D0/A0,-(A7)
000019D2  4280                    1379              CLR.L   D0
000019D4  3039 00001A5C           1380              MOVE.W  (STACUR),D0
000019DA  E588                    1381              LSL.L   #2,D0
000019DC  2040                    1382              MOVE.L  D0,A0
000019DE  2068 19EA               1383              MOVE.L  .PLTTBL(A0),A0
000019E2  4E90                    1384              JSR     (A0)
000019E4  4CDF 0101               1385              MOVEM.L (A7)+,D0/A0
000019E8  4E75                    1386              RTS
000019EA= 00001762 0000189E ...   1387  .PLTTBL     DC.L    ISCPLOT,INSPLOT,GAMPLOT
000019F6                          1388  
000019F6                          1389  ; -----------------------------------------------------------------------------
000019F6                          1390  STAEMPTY
000019F6                          1391  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
000019F6                          1392  ; INPUT    - NONE
000019F6                          1393  ; OUTPUT   - NONE
000019F6                          1394  ; MODIFIES - NONE
000019F6                          1395  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
000019F6                          1396  ; -----------------------------------------------------------------------------
000019F6  4E75                    1397              RTS
000019F8                          1398  
000019F8                          1399  
000019F8                          1400  
000019F8                          1401  
000019F8                          1402  
000019F8                          1403  
000019F8                          1404  
000019F8                          1405  
000019F8                          1406  
000019F8                          1407  
000019F8                          1408  -------------------- end include --------------------
000019F8                          1409             
000019F8                          1410  START
000019F8                          1411  
000019F8                          1412  ; --- INITIALIZATION -----------------------------------------------------------
000019F8                          1413  
000019F8  4EB8 1000               1414              JSR     SYSINIT
000019FC                          1415              ;JSR     UTLINIT
000019FC  4EB8 171C               1416              JSR     ISCINIT
00001A00                          1417              ;JSR     GAMINIT
00001A00                          1418              ;JSR     STAINIT
00001A00                          1419              
00001A00                          1420  .LOOP
00001A00                          1421  
00001A00                          1422  ; --- UPDATE -------------------------------------------------------------------
00001A00                          1423  
00001A00                          1424  ; READ INPUT DEVICES
00001A00                          1425  
00001A00  4E41                    1426              TRAP    #1
00001A02                          1427  
00001A02                          1428  ; UPDATE GAME LOGIC
00001A02                          1429         
00001A02                          1430              ;JSR     STAUPD
00001A02                          1431              ;JSR     GAMUPD 
00001A02  4EB8 1734               1432              JSR     ISCUPDT   
00001A06                          1433  
00001A06                          1434  ; --- PLOT ---------------------------------------------------------------------
00001A06                          1435  
00001A06  4EB8 1762               1436              JSR     ISCPLOT
00001A0A                          1437              ;JSR     STAPLOT
00001A0A                          1438              ;JSR GAMPLOT
00001A0A                          1439  
00001A0A  4E40                    1440              TRAP    #0                      ; ENABLE DOBLE BUFFER
00001A0C                          1441              
00001A0C  0C39 0000 00001A59      1442              CMP.B   #0,(WINNER)
00001A14  60EA                    1443              BRA     .LOOP
00001A16                          1444  
00001A16  FFFF FFFF               1445              SIMHALT
00001A1A                          1446              
00001A1A                          1447              INCLUDE "VARS.X68"
00001A1A                          1448  ; ==============================================================================
00001A1A                          1449  ; GAME VARIABLES
00001A1A                          1450  ; ==============================================================================
00001A1A                          1451  
00001A1A                          1452  ; --- BOX RELATED VARIABLES ----------------------------------------------------
00001A1A                          1453  
00001A1A                          1454  BOXCOL      DS.W    1                       ; COLUMN WHERE THE BOX IS PAINTED  
00001A1C                          1455  BOXROW      DS.W    1                       ; ROW WHERE THE BOX IS PAINTED
00001A1E                          1456  BOXPOSX     DS.W    1                       ; BOX X COORDINATE
00001A20                          1457  BOXPOSY     DS.W    1                       ; BOX Y COORDINATE
00001A22                          1458  
00001A22                          1459  ; --- PIECE RELATED VARIABLES --------------------------------------------------
00001A22                          1460  
00001A22                          1461  PIEPOSX     DS.W    1                       ; PIECE X COORDINATE
00001A24                          1462  PIEPOSY     DS.W    1                       ; PIECE Y COORDINATE
00001A26                          1463  PIEVELX     DS.W    1                       ; X MOVEMENT
00001A28                          1464  PIEVELY     DS.W    1                       ; Y MOVEMENT
00001A2A                          1465  POSX        DS.W    1                       ; POS. X IN THE MATRIX 
00001A2C                          1466  POSY        DS.W    1                       ; POS. Y IN THE MATRIX
00001A2E                          1467  
00001A2E                          1468  ; --- COLUMN RELATED VARIABLES -------------------------------------------------
00001A2E                          1469  
00001A2E                          1470  ROW1        DS.B    7
00001A35                          1471  ROW2        DS.B    7
00001A3C                          1472  ROW3        DS.B    7
00001A43                          1473  ROW4        DS.B    7
00001A4A                          1474  ROW5        DS.B    7
00001A51                          1475  ROW6        DS.B    7
00001A58                          1476  
00001A58                          1477  ; --- PLAYER VARIABLES ---------------------------------------------------------
00001A58                          1478  
00001A58                          1479  TURN        DS.B    1                       ; PLAYER WHO PLAY IN THAT TURN
00001A59                          1480  WINNER      DS.B    1                       ; 0 NONE, 1 OR 5 (PLAYER WHO WIN)
00001A5A                          1481  
00001A5A                          1482  ; --- INTRO STATE RELATED VARAIBLES --------------------------------------------
00001A5A                          1483  
00001A5A                          1484  ISCTIMER    DS.W    1                       ; INTRO TIMER
00001A5C                          1485  
00001A5C                          1486  ; --- STATE RELATED VARAIBLES --------------------------------------------------
00001A5C                          1487  
00001A5C                          1488  STACUR      DS.W    1                       ; CURRENT STATE
00001A5E                          1489  STANEXT     DS.W    1                       ; NEXT STATE
00001A60                          1490  
00001A60                          1491  ; --- FILE VARAIBLES -----------------------------------------------------------
00001A60                          1492  
00001A60                          1493  FILEID      DS.L    1                       ; ID OF THE OPENED FILE
00001A64                          1494  READED      DS.B    126                     ; MOVEMENTS READ (42 BOXES * 3)    
00001AE2                          1495  
00001AE2                          1496  ; --- INTRODUCTION VARAIBLES ---------------------------------------------------
00001AE2                          1497  
00001AE2                          1498  INTROX      DS.W    1                       ; SET THE X OF THE INTRO
00001AE4                          1499  INTROY      DS.W    1                       ; SET THE Y OF THE INTRO   
00001AE6                          1500  SHOWINTRO   DS.B    1                       ; IF IS 1 SHOWS INTRO, 0 IF NOT
00001AE7                          1501              DS.B    0
00001AE7                          1502  
00001AE7                          1503  
00001AE7                          1504  
00001AE7                          1505  
00001AE7                          1506  
00001AE7                          1507  
00001AE7                          1508  
00001AE7                          1509  
00001AE7                          1510  
00001AE7                          1511  
00001AE7                          1512  
00001AE7                          1513  
00001AE7                          1514  
00001AE7                          1515  
00001AE7                          1516  
00001AE7                          1517  -------------------- end include --------------------
00001AE7                          1518              INCLUDE "SYSVARS.X68"
00001AE7                          1519  ; ==============================================================================
00001AE7                          1520  ; SYSTEM VARIABLES
00001AE7                          1521  ; ==============================================================================
00001AE7                          1522              
00001AE7                          1523  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00001AE7                          1524  
00001AE7                          1525  KBDVAL      DS.B    1                       ; KEY STATE
00001AE8                          1526  KBDEDGE     DS.B    1                       ; KEY EDGE
00001AE9                          1527  
00001AE9                          1528  
00001AE9                          1529  
00001AE9                          1530  -------------------- end include --------------------
00001AE9                          1531  
00001AE9                          1532              END     START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BOAFCOL             0
BOAPLOT             15B2
BOAPLOT:PASS        1628
BOAPLOT:PLAYER1     15F4
BOAPLOT:PLAYER1_WIN  1620
BOAPLOT:TXT1        162E
BOAPLOT:TXT2        163D
BOAPLOT:WINNER_LINE  1600
BOXCOL              1A1A
BOXFCOL             0
BOXINIT             111E
BOXNCOL             7
BOXNROW             6
BOXPCOL             AA0000
BOXPLOT             1132
BOXPLOT:EMPTY       11BE
BOXPOSX             1A1E
BOXPOSY             1A20
BOXRAD              2D
BOXROW              1A1C
BOXUPD              1130
CHECK_DIAGONALS     1548
CHECK_DIAGONALS:LOOP_DIA  1576
CHECK_DIAGONALS:PLAYERWINS_DIA  156A
CHKCOL              1400
CHKCOL:CHECK_NEXT_COL  140C
CHKCOL:CHECK_POSITION_COL  1412
CHKCOL:LOOP_COL     1450
CHKCOL:PLAYERWINS_COL  1444
CHKDIA              14BA
CHKDIA:FINISH_DIA   1542
CHKDIA:LOOP1        14D0
CHKDIA:LOOP2        14F0
CHKDIA:LOOP_DIAGONALS_ROW1  14CC
CHKDIA:LOOP_TO_OTHER_SIDE  14C8
CHKDIA:MINUS1       1532
CHKDIA:PASS_DIA     1534
CHKROW              1460
CHKROW:CHECK_NEXT_ROW  146C
CHKROW:CHECK_POSITION_ROW  1472
CHKROW:LOOP_ROW     14AA
CHKROW:PLAYERWINS_ROW  149E
FILEID              1A60
FILINIT             164A
FILINIT:LOOP1       1656
FILINIT:TXT         1672
GAMINIT             16B0
GAMPLOT             16C8
GAMPLOT:PLOT_NEXT_COL  16D4
GAMPLOT:PLOT_NEXT_ROW  16E4
GAMUPD              16C2
INSINIT             189A
INSPLOT             189E
INSPLOT:DONE        18C2
INSPLOT:LOOP        18B4
INSPLOT:TXT1        18C8
INSPLOT:TXT2        18EA
INSPLOT:TXT3        191D
INSPLOT:TXT4        193A
INSPLOT:TXTLST      1964
INSUPD              189C
INTROX              1AE2
INTROY              1AE4
ISCINIT             171C
ISCPLOT             1762
ISCPLOT:LOOP        1790
ISCPLOT:SHOW        178E
ISCPLOT:TXT1        17C2
ISCPLOT:TXT2        17CD
ISCPLOT:TXT3        17EF
ISCPLOT:TXT4        1822
ISCPLOT:TXT5        183F
ISCPLOT:TXT6        1868
ISCPLOT:TXTLST      187E
ISCTIMER            1A5A
ISCUPDT             1734
ISCUPDT:DONE        175C
ISCUPDT:NOT1        1756
KBDDOWN             28
KBDEDGE             1AE8
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             106C
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPDATE           107A
KBDUPDATE:LOOP      10BE
KBDUPDATE:PACK      10BA
KBDVAL              1AE7
PIEFALL             1386
PIEFALL:END         13EA
PIEFALL:FALLAGAIN   1398
PIEFALL:OTHERPIE    13F6
PIEFALL:PASS        13DE
PIEFCOL1            FF
PIEFCOL2            FFFF
PIEFCOL3            3FEB1D
PIEINIT             121A
PIEPCOL1            AA
PIEPCOL2            AAAA
PIEPCOL3            0
PIEPLOT             12FE
PIEPLOT:COLOR1      132E
PIEPLOT:COLORWINNER  134A
PIEPLOT:JUMP        1362
PIEPOSX             1A22
PIEPOSY             1A24
PIERAD              23
PIESPEED            3
PIEUPD              124E
PIEUPD:CHKRIGHT     1270
PIEUPD:CHKSPACE     1288
PIEUPD:CONT         12B6
PIEUPD:CONT2        12D2
PIEUPD:DONE         12E8
PIEUPD:DONE2        12F4
PIEVELX             1A26
PIEVELY             1A28
PLAINIT             1582
PLAUPD              1592
PLAUPD:PLAYER2      15A8
POSX                1A2A
POSY                1A2C
READED              1A64
READFILE            1684
READFILE:LOOP2      16A2
ROW1                1A2E
ROW2                1A35
ROW3                1A3C
ROW4                1A43
ROW5                1A4A
ROW6                1A51
SCRHEIGH            2D0
SCRINIT             1024
SCRPLOT             1052
SCRWIDTH            3C0
SHOWINTRO           1AE6
STACUR              1A5C
STAEMPTY            19F6
STAINIT             1978
STANEXT             1A5E
STANONE             FFFFFFFF
STAPLOT             19CE
STAPLOT:PLTTBL      19EA
START               19F8
START:LOOP          1A00
STAUPD              1988
STAUPD:DOUPD        19AE
STAUPD:INITBL       19C2
SYSINIT             1000
TABFCOL             AA0000
TABINIT             11C4
TABINIT:LOOP        11D2
TABPCOL             FF0000
TABPLOT             11E2
TURN                1A58
UTLCHRWD            8
UTLINIT             10C8
UTLPRINT            10DE
UTLPRINT:ENDLOOP1   10F0
UTLPRINT:LOOP1      10E6
UTLRNDIX            111C
UTLSTRLEN           1106
UTLSTRLEN:ENDLOOP   1116
UTLSTRLEN:LOOP      110C
WINNER              1A59
