00001DCC Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 16/01/2023 15:59:40

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE : CUATRO EN RAYA
00000000                             3  ; AUTHOR: MARC LLOBERA VILLALONGA
00000000                             4  ;         PERE ROIG VERDERA
00000000                             5  ; ==============================================================================
00000000                             6  
00001000                             7              ORG     $1000
00001000                             8              
00001000                             9              INCLUDE "CONST.X68"
00001000                            10  ; ==============================================================================
00001000                            11  ; GAME CONSTANTS
00001000                            12  ; ==============================================================================
00001000                            13  
00001000                            14  ; --- BOX RELATED CONTANTS ----------------------------------------------------
00001000                            15  
00001000  =00000007                 16  BOXNCOL     EQU     7                       ; NUMBER OF BOXES IN A COLUMN
00001000  =00000006                 17  BOXNROW     EQU     6                       ; NUMBER OF BOXES IN A ROW
00001000  =00AA0000                 18  BOXPCOL     EQU     $00AA0000               ; BOXCONTOUR COLOR
00001000  =00000000                 19  BOXFCOL     EQU     $00000000               ; BOX FILL COLOR
00001000  =0000002D                 20  BOXRAD      EQU     45                      ; BOX RADIUS
00001000                            21  
00001000                            22  ; --- PIECE RELATED CONTANTS ----------------------------------------------------
00001000                            23  
00001000  =000000AA                 24  PIEPCOL1    EQU     $000000AA               ; PIECE CONTOUR COLOR TURN 1
00001000  =000000FF                 25  PIEFCOL1    EQU     $000000FF               ; PIECE FILL COLOR TURN 1
00001000  =0000AAAA                 26  PIEPCOL2    EQU     $0000AAAA               ; PIECE CONTOUR COLOR TURN 2
00001000  =0000FFFF                 27  PIEFCOL2    EQU     $0000FFFF               ; PIECE FILL COLOR TURN 2               
00001000  =00000000                 28  PIEPCOL3    EQU     $00000000               ; PIECE CONTOUR COLOR WIN
00001000  =003FEB1D                 29  PIEFCOL3    EQU     $003FEB1D               ; PIECE FILL COLOR WIN
00001000  =00000003                 30  PIESPEED    EQU     3                       ; MAGNITUDE OF THE FALL VEL.
00001000  =00000023                 31  PIERAD      EQU     35                      ; PIECE RADIUS
00001000                            32  
00001000                            33  ; --- TABLE RELATED CONSTANTS ----------------------------------------------------
00001000                            34  
00001000  =00FF0000                 35  TABPCOL     EQU     $00FF0000               ; TAB CONTOUR COLOR
00001000  =00AA0000                 36  TABFCOL     EQU     $00AA0000               ; TAB FILL COLOR
00001000                            37  
00001000                            38  ; --- STATE RELATED CONSTANTS ----------------------------------------------------
00001000                            39  
00001000  =FFFFFFFF                 40  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001000                            41  
00001000                            42  ; --- FILE CONSTANTS -------------------------------------------------------------
00001000                            43  
00001000= 61 75 74 6F 6D 61 ...     44  FILE        DC.B    'automaticgame.txt',0   ; FILE NAME
00001012                            45              DS.W    0
00001012                            46  
00001012                            47  
00001012                            48  
00001012                            49  
00001012                            50  
00001012                            51  
00001012                            52  
00001012                            53  
00001012                            54  
00001012                            55  
00001012                            56  -------------------- end include --------------------
00001012                            57              INCLUDE "SYS/SYSCONST.X68"
00001012                            58  ; ==============================================================================
00001012                            59  ; SYSTEM CONSTANTS
00001012                            60  ; ==============================================================================
00001012                            61  
00001012                            62  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001012                            63  
00001012  =000003C0                 64  SCRWIDTH    EQU     960                     ; SCREEN WIDTH
00001012  =000002D0                 65  SCRHEIGH    EQU     720                     ; SCREEN HEIGHT
00001012  =0000003C                 66  SCRFPS      EQU     60                       ; SCREEN FRAMES PER SECOND
00001012                            67  
00001012                            68  ; --- KEYCODES -----------------------------------------------------------------
00001012                            69  
00001012  =00000025                 70  KBDLEFT     EQU     $25
00001012  =00000026                 71  KBDUP       EQU     $26
00001012  =00000027                 72  KBDRIGHT    EQU     $27
00001012  =00000028                 73  KBDDOWN     EQU     $28
00001012  =00000020                 74  KBDFIRE1    EQU     ' '
00001012  =0000004D                 75  KBDFIRE2    EQU     'M'
00001012  =00000010                 76  KBDFIRE3    EQU     $10
00001012  =00000050                 77  KBDPAUSE    EQU     'P'
00001012                            78  
00001012                            79  ; --- SOUND IDENTIFIERS --------------------------------------------------------
00001012                            80  
00001012  =00000000                 81  SNDMOVE     EQU     0
00001012  =00000001                 82  SNDFALL     EQU     1
00001012  =00000002                 83  SNDWIN      EQU     2
00001012  =00000003                 84  SNDMUSIC    EQU     3
00001012                            85  
00001012                            86  ; --- TRAP NUMBERS -------------------------------------------------------------
00001012                            87  
00001012  =00000000                 88  SCRUPTN     EQU     0                       ; SCREEN UPDATE TRAP NUMBER
00001012  =00000001                 89  KBDUPTN     EQU     1                       ; KEYBOARD UPDATE TRAP NUMBER
00001012  =00000002                 90  SNDPLTN     EQU     2                       ; SOUND PLAY TRAP NUMBER
00001012                            91  
00001012                            92  ; --- INTERRUPT NUMBERS  -------------------------------------------------------
00001012                            93  
00001012  =00000001                 94  SCRINTN     EQU     1                       ; TIMED INTERRUPT NUMBER
00001012                            95  
00001012                            96  
00001012                            97  -------------------- end include --------------------
00001012                            98              INCLUDE "SYS/SYSTEM.X68"
00001012                            99  ; ==============================================================================
00001012                           100  ; SYSTEM
00001012                           101  ; ==============================================================================
00001012                           102              
00001012                           103  ; ------------------------------------------------------------------------------
00001012                           104  SYSINIT
00001012                           105  ; INITIALIZE SYSTEM.
00001012                           106  ; INPUT    : NONE
00001012                           107  ; OUTPUT   : NONE
00001012                           108  ; MODIFIES : NONE
00001012                           109  ; ------------------------------------------------------------------------------
00001012                           110              
00001012  21FC 00001118 0080       111              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
0000101A  21FC 0000114E 0084       112              MOVE.L  #KBDUPD,($80+KBDUPTN*4)
00001022  21FC 000010C2 0088       113              MOVE.L  #SNDPLAY,($80+SNDPLTN*4)
0000102A  21FC 00001132 0064       114              MOVE.L  #SCRTIM,($60+SCRINTN*4)
00001032                           115              
00001032  4EB9 000010D4            116              JSR     SCRINIT
00001038  4EB9 00001140            117              JSR     KBDINIT
0000103E  4EB9 0000104C            118              JSR     SNDINIT
00001044                           119              
00001044  40E7                     120              MOVE.W  SR,-(A7)
00001046  0257 D8FF                121              ANDI.W  #$D8FF,(A7)
0000104A  4E73                     122              RTE
0000104C                           123     
0000104C                           124  ; ------------------------------------------------------------------------------
0000104C                           125  SNDINIT
0000104C                           126  ; SOUND SYSTEM INIT
0000104C                           127  ; INPUT    : NONE
0000104C                           128  ; OUTPUT   : NONE
0000104C                           129  ; MODIFIES : NONE
0000104C                           130  ; ------------------------------------------------------------------------------
0000104C  48E7 C0C0                131              MOVEM.L D0-D1/A0-A1,-(A7)            
00001050  4201                     132              CLR.B   D1
00001052  41F9 000010AE            133              LEA     .SNDLIST,A0
00001058  2018                     134  .LOOP       MOVE.L  (A0)+,D0
0000105A  6700 000E                135              BEQ     .DONE
0000105E  2240                     136              MOVE.L  D0,A1
00001060  103C 0047                137              MOVE.B  #71,D0
00001064  4E4F                     138              TRAP    #15
00001066  5201                     139              ADDQ.B  #1,D1
00001068  60EE                     140              BRA     .LOOP
0000106A  4CDF 0303                141  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1      
0000106E  4E75                     142              RTS
00001070= 53 4E 44 2F 4D 4F ...    143  .SNDMOVE    DC.B    'SND/MOVEPIECE.wav',0
00001082= 53 4E 44 2F 50 49 ...    144  .SNDFALL    DC.B    'SND/PIECEFALL.wav',0
00001094= 53 4E 44 2F 57 49 ...    145  .SNDWIN     DC.B    'SND/WIN.wav',0
000010A0= 53 4E 44 2F 4D 55 ...    146  .SNDMUSIC   DC.B    'SND/MUSIC.wav',0
000010AE                           147              DS.W    0
000010AE= 00001070 00001082 ...    148  .SNDLIST    DC.L    .SNDMOVE,.SNDFALL,.SNDWIN,.SNDMUSIC,0
000010C2                           149              
000010C2                           150  ; ------------------------------------------------------------------------------
000010C2                           151  SNDPLAY
000010C2                           152  ; PLAY SOUND
000010C2                           153  ; INPUT    : D7 SOUND ID
000010C2                           154  ; OUTPUT   : NONE
000010C2                           155  ; MODIFIES : NONE
000010C2                           156  ; ------------------------------------------------------------------------------
000010C2  48E7 C000                157              MOVEM.L D0-D1,-(A7)             
000010C6  103C 0048                158              MOVE.B  #72,D0
000010CA  1207                     159              MOVE.B  D7,D1
000010CC  4E4F                     160              TRAP    #15
000010CE  4CDF 0003                161              MOVEM.L (A7)+,D0-D1
000010D2  4E73                     162              RTE
000010D4                           163           
000010D4                           164  ; ------------------------------------------------------------------------------
000010D4                           165  SCRINIT
000010D4                           166  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
000010D4                           167  ; ENABLE DOBLE BUFFER, ENABLE TIMED INTERRUPT.
000010D4                           168  ; INPUT    : NONE
000010D4                           169  ; OUTPUT   : NONE
000010D4                           170  ; MODIFIES : NONE
000010D4                           171  ; ------------------------------------------------------------------------------
000010D4                           172  
000010D4  48E7 F000                173              MOVEM.L D0-D3,-(A7)
000010D8                           174  
000010D8                           175              ; SET SCREEN RESOLUTION
000010D8  103C 0021                176              MOVE.B  #33,D0
000010DC  223C 03C002D0            177              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
000010E2  4E4F                     178              TRAP    #15
000010E4                           179              
000010E4                           180              ; SET WINDOWED MODE
000010E4  7201                     181              MOVE.L  #1,D1
000010E6  4E4F                     182              TRAP    #15
000010E8                           183              
000010E8                           184              ; CLEAR SCREEN
000010E8  103C 000B                185              MOVE.B  #11,D0
000010EC  323C FF00                186              MOVE.W  #$FF00,D1
000010F0  4E4F                     187              TRAP    #15
000010F2                           188              
000010F2                           189              ; ENABLE DOUBLE BUFFER
000010F2  103C 005C                190              MOVE.B #92,D0
000010F6  123C 0011                191              MOVE.B #17,D1
000010FA  4E4F                     192              TRAP #15
000010FC                           193              
000010FC                           194              ; ENABLE TIMED INTERRUPT
000010FC  103C 0020                195              MOVE.B  #32,D0
00001100  123C 0006                196              MOVE.B  #6,D1
00001104  143C 0081                197              MOVE.B  #$80|SCRINTN,D2
00001108  7610                     198              MOVE.L  #1000/SCRFPS,D3
0000110A  4E4F                     199              TRAP    #15
0000110C                           200              
0000110C                           201              ; CLEAR INTERRUPT COUNTER
0000110C  4279 00001EC6            202              CLR.W   (SCRINTCT)
00001112                           203              
00001112  4CDF 000F                204              MOVEM.L (A7)+,D0-D3
00001116                           205              
00001116  4E75                     206              RTS
00001118                           207              
00001118                           208  ; ------------------------------------------------------------------------------
00001118                           209  SCRPLOT
00001118                           210  ; UPDATES DOBLE BUFFER
00001118                           211  ; INPUT    : NONE
00001118                           212  ; OUTPUT   : NONE
00001118                           213  ; MODIFIES : NONE
00001118                           214  ; ------------------------------------------------------------------------------
00001118  48A7 C000                215              MOVEM.W D0-D1,-(A7)
0000111C                           216  
0000111C                           217              ; SWITCH BUFFERS
0000111C  103C 005E                218              MOVE.B  #94,D0
00001120  4E4F                     219              TRAP    #15
00001122                           220              
00001122                           221              ; CLEAR HIDDEN BUFFER
00001122  103C 000B                222              MOVE.B  #11,D0
00001126  323C FF00                223              MOVE.W  #$FF00,D1
0000112A  4E4F                     224              TRAP    #15
0000112C                           225              
0000112C  4C9F 0003                226              MOVEM.W (A7)+,D0-D1
00001130                           227              
00001130  4E73                     228              RTE 
00001132                           229  
00001132                           230  ; ------------------------------------------------------------------------------
00001132                           231  SCRTIM
00001132                           232  ; TIMED INTERRUPT SERVICE ROUTINE
00001132                           233  ; INPUT    : NONE
00001132                           234  ; OUTPUT   : NONE
00001132                           235  ; MODIFIES : NONE
00001132                           236  ; ------------------------------------------------------------------------------
00001132                           237  
00001132  5239 00001EC6            238              ADDQ.B  #1,(SCRINTCT)
00001138  5239 00001EC7            239              ADDQ.B  #1,(SCRCYCCT)
0000113E  4E73                     240              RTE
00001140                           241              
00001140                           242  ; ------------------------------------------------------------------------------
00001140                           243  KBDINIT
00001140                           244  ; INIT KEYBOOARD
00001140                           245  ; INPUT    : NONE
00001140                           246  ; OUTPUT   : NONE
00001140                           247  ; MODIFIES : NONE
00001140                           248  ; ------------------------------------------------------------------------------
00001140  4239 00001EC4            249              CLR.B   (KBDVAL)
00001146  4239 00001EC5            250              CLR.B   (KBDEDGE)
0000114C  4E75                     251              RTS
0000114E                           252              
0000114E                           253  ; ------------------------------------------------------------------------------
0000114E                           254  KBDUPD
0000114E                           255  ; UPDATE KEYBOARD INFO.  
0000114E                           256  ; 7 -> PAUSE
0000114E                           257  ; 6 -> FIRE 3
0000114E                           258  ; 5 -> FIRE 2
0000114E                           259  ; 4 -> FIRE 1
0000114E                           260  ; 3 -> DOWN
0000114E                           261  ; 2 -> RIGHT
0000114E                           262  ; 1 -> UP
0000114E                           263  ; 0 -> LEFT
0000114E                           264  ; INPUT    : NONE
0000114E                           265  ; OUTPUT   : NONE
0000114E                           266  ; MODIFIES : NONE
0000114E                           267  ; ------------------------------------------------------------------------------
0000114E                           268  
0000114E  48E7 F000                269              MOVEM.L D0-D3,-(A7)
00001152                           270  
00001152                           271              ; READ FIRST PART
00001152  103C 0013                272              MOVE.B  #19,D0
00001156  223C 50104D20            273              MOVE.L  #KBDPAUSE<<24|KBDFIRE3<<16|KBDFIRE2<<8|KBDFIRE1,D1
0000115C  4E4F                     274              TRAP    #15
0000115E                           275              
0000115E                           276              ; CONVERT TO DESIRED FORMAT
0000115E  4EB9 0000118E            277              JSR     .PACK
00001164                           278  
00001164                           279              ; READ SECOND PART
00001164  223C 28272625            280              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
0000116A  4E4F                     281              TRAP    #15
0000116C                           282  
0000116C                           283              ; CONVERT TO DESIRED FORMAT
0000116C  4EB9 0000118E            284              JSR     .PACK
00001172                           285              
00001172                           286              ; COMPUTE KBDEDGE
00001172  1039 00001EC4            287              MOVE.B  (KBDVAL),D0
00001178  4600                     288              NOT.B   D0
0000117A  C002                     289              AND.B   D2,D0
0000117C  13C0 00001EC5            290              MOVE.B  D0,(KBDEDGE)
00001182                           291              
00001182                           292              ; STORE KBDVAL
00001182  13C2 00001EC4            293              MOVE.B  D2,(KBDVAL)
00001188                           294              
00001188  4CDF 000F                295              MOVEM.L (A7)+,D0-D3
0000118C                           296  
0000118C  4E73                     297              RTE
0000118E                           298              
0000118E  363C 0003                299  .PACK       MOVE.W  #3,D3
00001192  E189                     300  .LOOP       LSL.L   #8,D1
00001194  E312                     301              ROXL.B  #1,D2
00001196  51CB FFFA                302              DBRA.W  D3,.LOOP
0000119A  4E75                     303              RTS
0000119C                           304  
0000119C                           305              
0000119C                           306              
0000119C                           307  
0000119C                           308  
0000119C                           309  
0000119C                           310  
0000119C                           311  -------------------- end include --------------------
0000119C                           312              INCLUDE "LIB/UTLCONST.X68"
0000119C                           313  ; ==============================================================================
0000119C                           314  ; UTIL CONSTANTS
0000119C                           315  ; ==============================================================================
0000119C                           316  
0000119C  =00000008                317  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
0000119C  =00000008                318  -------------------- end include --------------------
0000119C                           319              INCLUDE "LIB/UTLCODE.X68"
0000119C                           320  ; =============================================================================
0000119C                           321  ; UTILITY CODE
0000119C                           322  ; =============================================================================
0000119C                           323  
0000119C                           324  ; -----------------------------------------------------------------------------
0000119C                           325  UTLINIT
0000119C                           326  ; INITIALIZES UTILITY CODE
0000119C                           327  ; INPUT    - NONE
0000119C                           328  ; OUTPUT   - NONE
0000119C                           329  ; MODIFIES - NONE
0000119C                           330  ; -----------------------------------------------------------------------------
0000119C  48E7 C000                331              MOVEM.L D0-D1,-(A7)
000011A0  103C 0008                332              MOVE.B  #8,D0
000011A4  4E4F                     333              TRAP    #15
000011A6  13C1 00001302            334              MOVE.B  D1,(UTLRNDIX)
000011AC  4CDF 0003                335              MOVEM.L (A7)+,D0-D1
000011B0  4E75                     336              RTS
000011B2                           337  
000011B2                           338  ; -----------------------------------------------------------------------------
000011B2                           339  UTLPRINT
000011B2                           340  ; PRINT SCREEN CENTERED TEXT
000011B2                           341  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
000011B2                           342  ;            D0.B SCREEN ROW TO PRINT TEXT
000011B2                           343  ; OUTPUT   : D0.B NEXT ROW
000011B2                           344  ; MODIFIES : NONE (ASIDE OF OUTPUT)
000011B2                           345  ; -----------------------------------------------------------------------------
000011B2  48E7 C0C0                346              MOVEM.L D0-D1/A0-A1,-(A7)
000011B6  4201                     347              CLR.B   D1
000011B8  2248                     348              MOVE.L  A0,A1
000011BA  4A18                     349  .LOOP       TST.B   (A0)+
000011BC  6700 0006                350              BEQ     .ENDLOOP
000011C0  5201                     351              ADDQ.B  #1,D1
000011C2  60F6                     352              BRA     .LOOP
000011C4  E209                     353  .ENDLOOP    LSR.B   #1,D1
000011C6  0401 003C                354              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
000011CA  4401                     355              NEG.B   D1
000011CC  E141                     356              ASL.W   #8,D1
000011CE  8240                     357              OR.W    D0,D1
000011D0  103C 000B                358              MOVE.B  #11,D0
000011D4  4E4F                     359              TRAP    #15
000011D6  103C 000D                360              MOVE.B  #13,D0
000011DA  4E4F                     361              TRAP    #15
000011DC  4CDF 0303                362              MOVEM.L (A7)+,D0-D1/A0-A1
000011E0  5400                     363              ADDQ.B  #2,D0
000011E2  4E75                     364              RTS
000011E4                           365              
000011E4                           366              
000011E4                           367  
000011E4                           368  
000011E4                           369              ; (SCRWIDTH/UTLCHRWD)/2 - D1/2
000011E4                           370  
000011E4                           371  
000011E4                           372  ; -----------------------------------------------------------------------------
000011E4                           373  UTLRAND
000011E4                           374  ; PROVIDES A PSEUDO-RANDOM BYTE
000011E4                           375  ; INPUT    - NONE
000011E4                           376  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
000011E4                           377  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000011E4                           378  ; -----------------------------------------------------------------------------
000011E4  2F08                     379              MOVE.L  A0,-(A7)
000011E6  41F9 00001202            380              LEA     .RANDVEC,A0
000011EC  4280                     381              CLR.L   D0
000011EE  1039 00001302            382              MOVE.B  (UTLRNDIX),D0
000011F4  1030 0800                383              MOVE.B  (A0,D0.L),D0
000011F8  5239 00001302            384              ADDQ.B  #1,(UTLRNDIX)
000011FE  205F                     385              MOVE.L  (A7)+,A0
00001200  4E75                     386              RTS
00001202                           387  
00001202                           388  
00001202= A2 EE 9A 0C F5 24 ...    389  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
0000120A= 2A A3 51 26 E0 AC ...    390              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001212= 75 51 CA FD 33 EB ...    391              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
0000121A= 60 CC E7 B8 9A EB ...    392              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001222= 1D 76 B5 95 B0 89 ...    393              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
0000122A= 39 15 48 C9 6E CA ...    394              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001232= 43 E7 E2 7C 37 25 ...    395              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
0000123A= E9 94 CE E9 E4 52 ...    396              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001242= 37 6D 9A 84 A2 28 ...    397              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
0000124A= 19 E2 C6 77 80 D4 ...    398              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001252= 0A 5A 32 67 33 C2 ...    399              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
0000125A= 59 80 DC 0E 57 FC ...    400              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001262= 8A AB BC F7 07 4D ...    401              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
0000126A= EF D5 77 6E 1E BB ...    402              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001272= D6 E0 2A 8F BD 28 ...    403              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
0000127A= 13 4F 66 EC 0A 64 ...    404              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001282= 56 52 9A 16 9B 90 ...    405              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
0000128A= 06 8A A4 F7 01 DA ...    406              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001292= F2 E7 77 28 B1 76 ...    407              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
0000129A= A4 42 E3 81 B1 67 ...    408              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
000012A2= BF CE FA 16 BF 38 ...    409              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
000012AA= D1 8B 50 0C 5F 49 ...    410              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
000012B2= DE 4C 14 A2 40 DC ...    411              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
000012BA= B6 9B 0A 38 5D AB ...    412              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
000012C2= E2 1B DD 75 15 82 ...    413              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
000012CA= 8A 26 51 30 9F 47 ...    414              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
000012D2= 1E 8A BB 71 C6 6E ...    415              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
000012DA= 9F 47 E5 34 94 27 ...    416              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
000012E2= 7D 06 D6 BA 30 0F ...    417              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
000012EA= EC 7F 7E 03 CF 2D ...    418              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
000012F2= 94 5B 23 F2 8B CD ...    419              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
000012FA= 74 33 EC B9 0F D5 ...    420              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001302                           421  
00001302                           422  
00001302                           423  
00001302                           424  -------------------- end include --------------------
00001302                           425              INCLUDE "LIB/UTLVARS.X68"
00001302                           426  ; =============================================================================
00001302                           427  ; UTILITY VARIABLES
00001302                           428  ; =============================================================================
00001302                           429  
00001302                           430  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001304                           431              DS.W    0
00001304                           432  -------------------- end include --------------------
00001304                           433              INCLUDE "BOX.X68"
00001304                           434  ; ==============================================================================
00001304                           435  ; BOX MANAGEMENT
00001304                           436  ; ==============================================================================
00001304                           437              
00001304                           438  ; ------------------------------------------------------------------------------
00001304                           439  BOXINIT
00001304                           440  ; INITIALIZE BOX.
00001304                           441  ; INPUT    : NONE 
00001304                           442  ; OUTPUT   : NONE
00001304                           443  ; MODIFIES : NONE
00001304                           444  ; ------------------------------------------------------------------------------
00001304                           445              
00001304  33FC 0083 00001DFC       446              MOVE.W  #BOXRAD*2+41,(BOXPOSX)
0000130C  33FC 0064 00001DFE       447              MOVE.W  #BOXRAD*2+10,(BOXPOSY)
00001314                           448              
00001314  4E75                     449              RTS
00001316                           450              
00001316                           451  ; ------------------------------------------------------------------------------
00001316                           452  BOXUPD
00001316                           453  ; UPDATES THE BOX.
00001316                           454  ; INPUT    : NONE 
00001316                           455  ; OUTPUT   : NONE
00001316                           456  ; MODIFIES : NONE
00001316                           457  ; ------------------------------------------------------------------------------
00001316  4E75                     458              RTS
00001318                           459              
00001318                           460  ; ------------------------------------------------------------------------------
00001318                           461  BOXPLOT
00001318                           462  ; PLOT THE BOX.
00001318                           463  ; INPUT    : NONE 
00001318                           464  ; OUTPUT   : NONE
00001318                           465  ; MODIFIES : NONE
00001318                           466  ; ------------------------------------------------------------------------------
00001318  48E7 FE40                467              MOVEM.L D0-D6/A1,-(A7)
0000131C                           468  
0000131C                           469              ; SET PEN COLOR
0000131C  103C 0050                470              MOVE.B  #80,D0
00001320  223C 00AA0000            471              MOVE.L  #BOXPCOL,D1
00001326  4E4F                     472              TRAP    #15
00001328                           473              
00001328                           474              ; SET FILL COLOR
00001328  103C 0051                475              MOVE.B  #81,D0
0000132C  7200                     476              MOVE.L  #BOXFCOL,D1                                                                     
0000132E  4E4F                     477              TRAP    #15                                                                             
00001330                           478              
00001330                           479              ; DEFINE COORDINATES
00001330  3239 00001DFC            480              MOVE.W  (BOXPOSX),D1
00001336  3439 00001DF8            481              MOVE.W  (BOXCOL),D2
0000133C  C3C2                     482              MULS.W  D2,D1
0000133E  0441 005A                483              SUB.W   #BOXRAD*2,D1
00001342                           484              
00001342  3439 00001DFE            485              MOVE.W  (BOXPOSY),D2
00001348  3639 00001DFA            486              MOVE.W  (BOXROW),D3
0000134E  C5C3                     487              MULS.W  D3,D2
00001350  0642 005A                488              ADD.W   #PIERAD*2+20,D2
00001354  0442 0055                489              SUB.W   #BOXRAD*2-5,D2
00001358                           490              
00001358  3601                     491              MOVE.W  D1,D3
0000135A  0643 005A                492              ADD.W   #BOXRAD*2,D3
0000135E                           493              
0000135E  3802                     494              MOVE.W  D2,D4
00001360  0644 005A                495              ADD.W   #BOXRAD*2,D4
00001364                           496              
00001364                           497              ; DRAW CIRCLE
00001364  103C 0058                498              MOVE.B  #88,D0
00001368  4E4F                     499              TRAP    #15
0000136A                           500              
0000136A  43F9 00001E0E            501              LEA.L   ROW1,A1
00001370  3639 00001DF8            502              MOVE.W  (BOXCOL),D3
00001376  3839 00001DFA            503              MOVE.W  (BOXROW),D4
0000137C  5343                     504              SUBQ.W  #1,D3
0000137E  5344                     505              SUBQ.W  #1,D4
00001380  D2C3                     506              ADD.W   D3,A1   
00001382  C9FC 0007                507              MULS.W  #7,D4
00001386  D2C4                     508              ADD.W   D4,A1
00001388                           509              
00001388  0C11 0000                510              CMP.B   #0,(A1)
0000138C  6700 0016                511              BEQ     .EMPTY
00001390  3A01                     512              MOVE.W  D1,D5
00001392  0645 002D                513              ADD.W   #BOXRAD,D5
00001396  3C02                     514              MOVE.W  D2,D6
00001398  0646 002D                515              ADD.W   #BOXRAD,D6
0000139C  1011                     516              MOVE.B  (A1),D0
0000139E  4EB9 00001520            517              JSR     PIEPLOT
000013A4                           518              
000013A4                           519  .EMPTY
000013A4  4CDF 027F                520              MOVEM.L (A7)+,D0-D6/A1
000013A8                           521  
000013A8  4E75                     522              RTS
000013AA                           523  
000013AA                           524  
000013AA                           525  
000013AA                           526  
000013AA                           527  
000013AA                           528  
000013AA                           529  
000013AA                           530  
000013AA                           531  
000013AA                           532  
000013AA                           533  -------------------- end include --------------------
000013AA                           534              INCLUDE "TABLE.X68"
000013AA                           535  ; ==============================================================================
000013AA                           536  ; TABLE MANAGEMENT
000013AA                           537  ; ==============================================================================
000013AA                           538              
000013AA                           539  ; ------------------------------------------------------------------------------
000013AA                           540  TABINIT
000013AA                           541  ; INITIALIZE TABLE.
000013AA                           542  ; INPUT    : NONE 
000013AA                           543  ; OUTPUT   : NONE
000013AA                           544  ; MODIFIES : NONE
000013AA                           545  ; ------------------------------------------------------------------------------
000013AA                           546  
000013AA  48E7 8040                547              MOVEM.L D0/A1,-(A7)
000013AE                           548  
000013AE                           549              ;INITIALICE ROWS VALUES
000013AE  303C 0029                550              MOVE.W  #6*7-1,D0
000013B2  43F9 00001E0E            551              LEA.L   ROW1,A1
000013B8                           552  .LOOP       
000013B8  12BC 0000                553              MOVE.B  #0,(A1)
000013BC  5289                     554              ADD.L  #1,A1
000013BE  51C8 FFF8                555              DBRA    D0,.LOOP
000013C2                           556  
000013C2  4CDF 0201                557              MOVEM.L (A7)+,D0/A1
000013C6                           558  
000013C6  4E75                     559              RTS
000013C8                           560              
000013C8                           561  ; ------------------------------------------------------------------------------
000013C8                           562  TABPLOT
000013C8                           563  ; PLOT THE TABLE.
000013C8                           564  ; INPUT    : NONE 
000013C8                           565  ; OUTPUT   : NONE
000013C8                           566  ; MODIFIES : NONE
000013C8                           567  ; ------------------------------------------------------------------------------
000013C8                           568  
000013C8  48E7 F800                569              MOVEM.L D0-D4,-(A7)
000013CC                           570  
000013CC                           571              ; SET CONTOUR COLOR
000013CC  103C 0050                572              MOVE.B  #80,D0
000013D0  223C 00FF0000            573              MOVE.L  #TABPCOL,D1
000013D6  4E4F                     574              TRAP    #15
000013D8                           575              
000013D8                           576              ; SET FILL COLOR
000013D8  103C 0051                577              MOVE.B  #81,D0
000013DC  223C 00AA0000            578              MOVE.L  #TABFCOL,D1
000013E2  4E4F                     579              TRAP    #15
000013E4                           580              
000013E4                           581              ; DEFINE COORDINATES
000013E4  323C 0005                582              MOVE.W  #5,D1
000013E8  343C 005A                583              MOVE.W  #PIERAD*2+20,D2
000013EC  363C 03BB                584              MOVE.W  #SCRWIDTH-5,D3
000013F0  383C 02CB                585              MOVE.W  #SCRHEIGH-5,D4
000013F4                           586              
000013F4                           587              ; DRAW RECTANGLE
000013F4  103C 0057                588              MOVE.B  #87,D0
000013F8  4E4F                     589              TRAP    #15
000013FA                           590              
000013FA  4CDF 001F                591              MOVEM.L (A7)+,D0-D4
000013FE                           592  
000013FE  4E75                     593              RTS
00001400                           594  
00001400                           595  
00001400                           596  
00001400                           597  
00001400                           598  
00001400                           599  
00001400                           600  
00001400                           601  
00001400                           602  
00001400                           603  
00001400                           604  
00001400                           605  
00001400                           606  
00001400                           607  
00001400                           608  
00001400                           609  -------------------- end include --------------------
00001400                           610              INCLUDE "PIECE.X68"
00001400                           611  ; ==============================================================================
00001400                           612  ; PIECE MANAGEMENT
00001400                           613  ; ==============================================================================
00001400                           614              
00001400                           615  ; ------------------------------------------------------------------------------
00001400                           616  PIEINIT
00001400                           617  ; INITIALIZE THE PIECE.
00001400                           618  ; INPUT    : NONE 
00001400                           619  ; OUTPUT   : NONE
00001400                           620  ; MODIFIES : NONE
00001400                           621  ; ------------------------------------------------------------------------------
00001400                           622  
00001400  33FC 01DF 00001E00       623              MOVE.W  #SCRWIDTH/2-1,(PIEPOSX)
00001408  33FC 002D 00001E02       624              MOVE.W  #PIERAD+10,(PIEPOSY)
00001410                           625              
00001410  33F9 00001DFC 00001E04   626              MOVE.W  (BOXPOSX),(PIEVELX)
0000141A  33FC 0064 00001E06       627              MOVE.W  #100,(PIEVELY)
00001422                           628              
00001422  33FC 0003 00001E08       629              MOVE.W  #3,(POSX)
0000142A  33FC FFFF 00001E0A       630              MOVE.W  #-1,(POSY)
00001432                           631              
00001432  4239 00001E0C            632              CLR.B   (FALLING)
00001438                           633              
00001438  4E75                     634              RTS
0000143A                           635              
0000143A                           636  ; ------------------------------------------------------------------------------
0000143A                           637  PIEUPD
0000143A                           638  ; UPDATE THE PIECE.
0000143A                           639  ; INPUT    : NONE 
0000143A                           640  ; OUTPUT   : NONE
0000143A                           641  ; MODIFIES : NONE
0000143A                           642  ; ------------------------------------------------------------------------------
0000143A                           643              
0000143A  48A7 F000                644              MOVEM.W  D0-D3,-(A7)
0000143E                           645              
0000143E  0C39 0000 00001E0C       646              CMP.B   #0,(FALLING)
00001446  6700 0020                647              BEQ     .PASS1
0000144A  1639 00001EC7            648              MOVE.B  (SCRCYCCT),D3
00001450  C63C 00F8                649              AND.B   #$F8,D3
00001454  B639 00001EC7            650              CMP.B   (SCRCYCCT),D3
0000145A  6600 0068                651              BNE     .DONE2
0000145E  4EB9 000015A8            652              JSR     PIEFALL
00001464  6000 005E                653              BRA     .DONE2
00001468                           654              
00001468                           655  .PASS1             
00001468                           656              ; UPDATE X POSITION
00001468  3039 00001E00            657              MOVE.W  (PIEPOSX),D0
0000146E                           658              
0000146E                           659              ; CHECK LEFT ARROW KEY
0000146E  0839 0000 00001EC5       660              BTST.B  #0,(KBDEDGE)
00001476  6700 000C                661              BEQ     .CHKRIGHT
0000147A  4EB9 000014CA            662              JSR     PRESSLEFT
00001480  6000 003C                663              BRA     .DONE
00001484                           664              
00001484                           665              ;CHECK  RIGHT ARROW KEY
00001484  0839 0002 00001EC5       666  .CHKRIGHT   BTST.B  #2,(KBDEDGE)
0000148C  6700 000C                667              BEQ     .CHKSPACE
00001490  4EB9 000014F6            668              JSR     PRESSRIGHT
00001496  6000 0026                669              BRA     .DONE
0000149A                           670              
0000149A                           671              ; CHECK SPACE KEY
0000149A  0839 0004 00001EC5       672  .CHKSPACE   BTST.B  #4,(KBDEDGE)
000014A2  6700 0020                673              BEQ     .DONE2
000014A6  1E3C 0001                674              MOVE.B  #SNDFALL,D7
000014AA  4E42                     675              TRAP    #SNDPLTN
000014AC  13FC 0001 00001E0C       676              MOVE.B  #1,(FALLING)
000014B4  4EB9 000015A8            677              JSR     PIEFALL
000014BA  6000 0008                678              BRA     .DONE2
000014BE                           679  
000014BE                           680              ; UPDATE VARIABLE
000014BE  33C0 00001E00            681  .DONE       MOVE.W  D0,(PIEPOSX) 
000014C4                           682  
000014C4  4C9F 000F                683  .DONE2      MOVEM.W  (A7)+,D0-D3             
000014C8                           684  
000014C8  4E75                     685              RTS
000014CA                           686  
000014CA                           687  PRESSLEFT
000014CA  1E3C 0000                688              MOVE.B  #SNDMOVE,D7
000014CE  4E42                     689              TRAP    #SNDPLTN
000014D0  9079 00001E04            690              SUB.W   (PIEVELX),D0
000014D6  5379 00001E08            691              SUBQ.W  #1,(POSX)
000014DC                           692              
000014DC                           693              ; CHECK COLISIONS LEFT
000014DC  3239 00001E04            694              MOVE.W  (PIEVELX),D1
000014E2  0441 002C                695              SUB.W   #BOXRAD-1,D1
000014E6  B041                     696              CMP.W   D1,D0
000014E8  6C00 000A                697              BGE     .DONELEFT
000014EC  3001                     698              MOVE.W  D1,D0
000014EE  4279 00001E08            699              CLR.W   (POSX)
000014F4  4E75                     700  .DONELEFT   RTS   
000014F6                           701  
000014F6                           702  PRESSRIGHT
000014F6  1E3C 0000                703              MOVE.B  #SNDMOVE,D7
000014FA  4E42                     704              TRAP    #SNDPLTN
000014FC  D079 00001E04            705              ADD.W   (PIEVELX),D0
00001502  5279 00001E08            706              ADDQ.W  #1,(POSX)
00001508                           707              
00001508                           708              ; CHECK COLISIONS RIGHT
00001508  343C 03C0                709              MOVE.W  #SCRWIDTH,D2
0000150C  9441                     710              SUB.W   D1,D2
0000150E  B042                     711              CMP.W   D2,D0
00001510  6F00 000C                712              BLE     .DONERIGHT
00001514  3002                     713              MOVE.W  D2,D0
00001516  33FC 0006 00001E08       714              MOVE.W  #6,(POSX)
0000151E  4E75                     715  .DONERIGHT  RTS            
00001520                           716  
00001520                           717  ; ------------------------------------------------------------------------------
00001520                           718  PIEPLOT
00001520                           719  ; PLOT THE PIECE.
00001520                           720  ; INPUT    : D5.W AS COORDINATE X OF PIECE, D6.W AS COORDINATE Y OF PIECE,
00001520                           721  ;            D0.B INDICATES COLOR OF THE PIECE
00001520                           722  ; OUTPUT   : NONE
00001520                           723  ; MODIFIES : NONE
00001520                           724  ; ------------------------------------------------------------------------------
00001520  48E7 7800                725              MOVEM.L D1-D4,-(A7)
00001524                           726  
00001524  B03C 0001                727              CMP.B   #1,D0
00001528  6700 0026                728              BEQ     .COLOR1
0000152C  B03C 0015                729              CMP.B   #21,D0
00001530  6700 003A                730              BEQ     .COLORWINNER
00001534                           731              
00001534                           732              ; SET PEN COLOR
00001534  103C 0050                733              MOVE.B  #80,D0
00001538  223C 0000AAAA            734              MOVE.L  #PIEPCOL2,D1
0000153E  4E4F                     735              TRAP    #15
00001540                           736              
00001540                           737              ; SET FILL COLOR
00001540  103C 0051                738              MOVE.B  #81,D0
00001544  223C 0000FFFF            739              MOVE.L  #PIEFCOL2,D1
0000154A  4E4F                     740              TRAP    #15
0000154C                           741              
0000154C  6000 0036                742              BRA     .JUMP
00001550                           743              
00001550                           744  .COLOR1            
00001550                           745              ; SET PEN COLOR
00001550  103C 0050                746              MOVE.B  #80,D0
00001554  223C 000000AA            747              MOVE.L  #PIEPCOL1,D1
0000155A  4E4F                     748              TRAP    #15
0000155C                           749              
0000155C                           750              ; SET FILL COLOR
0000155C  103C 0051                751              MOVE.B  #81,D0
00001560  223C 000000FF            752              MOVE.L  #PIEFCOL1,D1
00001566  4E4F                     753              TRAP    #15
00001568                           754              
00001568  6000 001A                755              BRA     .JUMP
0000156C                           756  
0000156C                           757  .COLORWINNER
0000156C                           758              ; SET PEN COLOR
0000156C  103C 0050                759              MOVE.B  #80,D0
00001570  7200                     760              MOVE.L  #PIEPCOL3,D1
00001572  4E4F                     761              TRAP    #15
00001574                           762              
00001574                           763              ; SET FILL COLOR
00001574  103C 0051                764              MOVE.B  #81,D0
00001578  223C 003FEB1D            765              MOVE.L  #PIEFCOL3,D1
0000157E  4E4F                     766              TRAP    #15
00001580                           767              
00001580  6000 0002                768              BRA     .JUMP
00001584                           769  
00001584                           770  .JUMP            
00001584                           771              ; DEFINE COORDINATES
00001584  3205                     772              MOVE.W  D5,D1
00001586  0441 0023                773              SUB.W   #PIERAD,D1
0000158A                           774              
0000158A  3406                     775              MOVE.W  D6,D2
0000158C  0442 0023                776              SUB.W   #PIERAD,D2
00001590                           777              
00001590  3605                     778              MOVE.W  D5,D3
00001592  0643 0023                779              ADD.W   #PIERAD,D3
00001596                           780              
00001596  3806                     781              MOVE.W  D6,D4
00001598  0644 0023                782              ADD.W   #PIERAD,D4
0000159C                           783              
0000159C                           784              ; DRAW PIECE
0000159C  103C 0058                785              MOVE.B  #88,D0
000015A0  4E4F                     786              TRAP    #15
000015A2                           787              
000015A2  4CDF 001E                788              MOVEM.L (A7)+,D1-D4
000015A6                           789  
000015A6  4E75                     790              RTS
000015A8                           791              
000015A8                           792  ; ------------------------------------------------------------------------------
000015A8                           793  PIEFALL
000015A8                           794  ; LET A PIECE FALL IN A COLUMN
000015A8                           795  ; INPUT    : NONE
000015A8                           796  ; OUTPUT   : NONE
000015A8                           797  ; MODIFIES : NONE
000015A8                           798  ; ------------------------------------------------------------------------------
000015A8                           799              
000015A8  48E7 C040                800              MOVEM.L D0-D1/A1,-(A7)
000015AC                           801              
000015AC  4280                     802              CLR.L   D0
000015AE  43F9 00001E0E            803              LEA.L   ROW1,A1
000015B4  5279 00001E0A            804              ADDQ.W  #1,(POSY)
000015BA  3039 00001E0A            805              MOVE.W  (POSY),D0
000015C0  C1FC 0007                806              MULS.W  #7,D0
000015C4  D2C0                     807              ADD.W   D0,A1
000015C6  3039 00001E08            808              MOVE.W  (POSX),D0
000015CC  D2C0                     809              ADD.W   D0,A1
000015CE                           810              
000015CE  0C79 0006 00001E0A       811              CMP.W   #6,(POSY)
000015D6  6700 002E                812              BEQ     .END 
000015DA                           813              
000015DA  0C11 0000                814              CMP.B   #0,(A1)
000015DE  6600 0026                815              BNE     .END
000015E2                           816              
000015E2  3239 00001E06            817              MOVE.W  (PIEVELY),D1
000015E8  D379 00001E02            818              ADD.W   D1,(PIEPOSY)
000015EE  0C79 0000 00001E0A       819              CMP.W   #0,(POSY)
000015F6  6600 0008                820              BNE     .PASS
000015FA  5A79 00001E02            821              ADDQ.W  #5,(PIEPOSY) 
00001600  4CDF 0203                822  .PASS       MOVEM.L (A7)+,D0-D1/A1
00001604                           823  
00001604  4E75                     824              RTS
00001606                           825  
00001606  5F89                     826  .END        SUBQ.L  #7,A1
00001608  5379 00001E0A            827              SUBQ.W  #1,(POSY)
0000160E  12B9 00001E38            828              MOVE.B  (TURN),(A1)
00001614  4EB9 00001636            829              JSR     CHKCOL                  ;CHECK 4 CONNECT IN COLUMNS
0000161A  4EB9 0000169C            830              JSR     CHKROW                  ;CHECK 4 CONNECT IN ROWS
00001620  4EB9 000016FC            831              JSR     CHKDIA                  ;CHECK 4 CONNECT IN DIAGONALS
00001626  4EB9 000017E0            832              JSR     PLAUPD
0000162C  4EB8 1400                833              JSR     PIEINIT
00001630                           834              
00001630  4CDF 0203                835              MOVEM.L (A7)+,D0-D1/A1
00001634                           836  
00001634  4E75                     837              RTS
00001636                           838              
00001636                           839  ; ------------------------------------------------------------------------------
00001636                           840  CHKCOL
00001636                           841  ; CHECK IF SOME COLUMN HAVE 4 PIECES CONNECTED
00001636                           842  ; INPUT    : NONE
00001636                           843  ; OUTPUT   : NONE
00001636                           844  ; MODIFIES : NONE
00001636                           845  ; ------------------------------------------------------------------------------
00001636                           846  
00001636  48E7 E070                847              MOVEM.L D0-D2/A1-A3,-(A7)
0000163A                           848              
0000163A  43F9 00001E0E            849              LEA.L   ROW1,A1
00001640  7006                     850              MOVE.L  #BOXNCOL-1,D0
00001642                           851  .CHECK_NEXT_COL
00001642  2449                     852              MOVE.L  A1,A2
00001644  5289                     853              ADD.L   #1,A1
00001646  7202                     854              MOVE.L  #BOXNROW-3-1,D1
00001648                           855              
00001648                           856  .CHECK_POSITION_COL
00001648  264A                     857              MOVE.L  A2,A3
0000164A  5E8A                     858              ADD.L   #7,A2
0000164C                           859              
0000164C  4282                     860              CLR.L   D2
0000164E  1413                     861              MOVE.B  (A3),D2
00001650  5E8B                     862              ADD.L   #7,A3
00001652  D413                     863              ADD.B   (A3),D2
00001654  5E8B                     864              ADD.L   #7,A3
00001656  D413                     865              ADD.B   (A3),D2
00001658  5E8B                     866              ADD.L   #7,A3
0000165A  D413                     867              ADD.B   (A3),D2
0000165C                           868              
0000165C  B43C 0004                869              CMP.B   #4,D2
00001660  6700 0018                870              BEQ     .PLAYERWINS_COL
00001664  B43C 0014                871              CMP.B   #20,D2
00001668  6700 0010                872              BEQ     .PLAYERWINS_COL
0000166C                           873              
0000166C  51C9 FFDA                874              DBRA    D1,.CHECK_POSITION_COL
00001670                           875              
00001670  51C8 FFD0                876              DBRA    D0,.CHECK_NEXT_COL
00001674                           877              
00001674  4CDF 0E07                878              MOVEM.L (A7)+,D0-D2/A1-A3
00001678                           879              
00001678  4E75                     880              RTS
0000167A                           881              
0000167A                           882  .PLAYERWINS_COL
0000167A  13F9 00001E38 00001E39   883              MOVE.B  (TURN),(WINNER)
00001684  1E3C 0002                884              MOVE.B  #SNDWIN,D7
00001688  4E42                     885              TRAP    #SNDPLTN  
0000168A                           886  
0000168A  7003                     887              MOVE.L  #3,D0
0000168C                           888  .LOOP_COL
0000168C  16BC 0015                889              MOVE.B  #21,(A3)
00001690  5F8B                     890              SUB.L   #7,A3
00001692  51C8 FFF8                891              DBRA    D0,.LOOP_COL
00001696                           892                      
00001696  4CDF 0E07                893              MOVEM.L (A7)+,D0-D2/A1-A3
0000169A  4E75                     894              RTS
0000169C                           895  
0000169C                           896  ; ------------------------------------------------------------------------------
0000169C                           897  CHKROW
0000169C                           898  ; CHECK IF SOME ROW HAVE 4 PIECES CONNECTED
0000169C                           899  ; INPUT    : NONE
0000169C                           900  ; OUTPUT   : NONE
0000169C                           901  ; MODIFIES : NONE
0000169C                           902  ; ------------------------------------------------------------------------------
0000169C                           903  
0000169C  48E7 E070                904              MOVEM.L D0-D2/A1-A3,-(A7)
000016A0                           905              
000016A0  43F9 00001E0E            906              LEA.L   ROW1,A1
000016A6  7005                     907              MOVE.L  #BOXNROW-1,D0
000016A8                           908  .CHECK_NEXT_ROW
000016A8  2449                     909              MOVE.L  A1,A2
000016AA  5E89                     910              ADD.L   #7,A1
000016AC  7203                     911              MOVE.L  #BOXNCOL-3-1,D1
000016AE                           912              
000016AE                           913  .CHECK_POSITION_ROW
000016AE  264A                     914              MOVE.L  A2,A3
000016B0  528A                     915              ADD.L   #1,A2
000016B2                           916              
000016B2  4282                     917              CLR.L   D2
000016B4  141B                     918              MOVE.B   (A3)+,D2
000016B6  D41B                     919              ADD.B   (A3)+,D2
000016B8  D41B                     920              ADD.B   (A3)+,D2
000016BA  D413                     921              ADD.B   (A3),D2
000016BC                           922              
000016BC  B43C 0004                923              CMP.B   #4,D2
000016C0  6700 0018                924              BEQ     .PLAYERWINS_ROW
000016C4  B43C 0014                925              CMP.B   #20,D2
000016C8  6700 0010                926              BEQ     .PLAYERWINS_ROW
000016CC                           927              
000016CC  51C9 FFE0                928              DBRA    D1,.CHECK_POSITION_ROW
000016D0                           929              
000016D0  51C8 FFD6                930              DBRA    D0,.CHECK_NEXT_ROW
000016D4                           931              
000016D4  4CDF 0E07                932              MOVEM.L (A7)+,D0-D2/A1-A3
000016D8                           933              
000016D8  4E75                     934              RTS
000016DA                           935  
000016DA                           936  .PLAYERWINS_ROW
000016DA  13F9 00001E38 00001E39   937              MOVE.B  (TURN),(WINNER)
000016E4  1E3C 0002                938              MOVE.B  #SNDWIN,D7
000016E8  4E42                     939              TRAP    #SNDPLTN
000016EA                           940              
000016EA  7003                     941              MOVE.L  #3,D0
000016EC                           942  .LOOP_ROW
000016EC  16BC 0015                943              MOVE.B  #21,(A3)
000016F0  538B                     944              SUB.L   #1,A3
000016F2  51C8 FFF8                945              DBRA    D0,.LOOP_ROW
000016F6                           946              
000016F6  4CDF 0E07                947              MOVEM.L (A7)+,D0-D2/A1-A3
000016FA  4E75                     948              RTS
000016FC                           949  
000016FC                           950  ; ------------------------------------------------------------------------------
000016FC                           951  CHKDIA
000016FC                           952  ; CHECK IF SOME DIAGONAL HAVE 4 PIECES CONNECTED
000016FC                           953  ; INPUT    : NONE
000016FC                           954  ; OUTPUT   : NONE
000016FC                           955  ; MODIFIES : NONE
000016FC                           956  ; ------------------------------------------------------------------------------
000016FC                           957  
000016FC  48E7 FE70                958              MOVEM.L D0-D6/A1-A3,-(A7)
00001700                           959              
00001700  43F9 00001E0E            960              LEA.L   ROW1,A1
00001706                           961             
00001706  7C08                     962              MOVE.L  #8,D6
00001708  7201                     963              MOVE.L  #1,D1
0000170A                           964  .LOOP_TO_OTHER_SIDE 
0000170A                           965             
0000170A  7A07                     966              MOVE.L  #7,D5
0000170C  7401                     967              MOVE.L  #1,D2
0000170E                           968  .LOOP_DIAGONALS_ROW1
0000170E                           969  
0000170E  2449                     970              MOVE.L  A1,A2
00001710                           971              ;DIAGONAL OF (0,0) AND (6,0) / (1,0) AND (5,0)            
00001710  7602                     972              MOVE.L  #2,D3
00001712                           973  .LOOP1
00001712  264A                     974              MOVE.L  A2,A3
00001714  D5C6                     975              ADD.L   D6,A2
00001716                           976              
00001716  4EB9 00001790            977              JSR     CHECK_DIAGONALS
0000171C  0C39 0000 00001E39       978              CMP.B   #0,(WINNER)
00001724  6600 0064                979              BNE     .FINISH_DIA
00001728                           980             
00001728  51CB FFE8                981              DBRA    D3,.LOOP1
0000172C                           982              
0000172C                           983              ;DIAGONAL OF (0,1) AND (6,1) / (2,0) AND (4,0)
0000172C  2449                     984              MOVE.L  A1,A2
0000172E  D5C5                     985              ADD.L   D5,A2
00001730                           986              
00001730  7601                     987              MOVE.L  #1,D3
00001732                           988  .LOOP2
00001732  264A                     989              MOVE.L  A2,A3
00001734  D5C6                     990              ADD.L   D6,A2
00001736                           991              
00001736  4EB9 00001790            992              JSR     CHECK_DIAGONALS
0000173C  0C39 0000 00001E39       993              CMP.B   #0,(WINNER)
00001744  6600 0044                994              BNE     .FINISH_DIA
00001748                           995             
00001748  51CB FFE8                996              DBRA    D3,.LOOP2
0000174C                           997              
0000174C                           998              ;DIAGONAL OF (0,2) AND (6,2) / (3,0)
0000174C  2649                     999              MOVE.L  A1,A3
0000174E  D7C5                    1000              ADD.L   D5,A3
00001750  D7C5                    1001              ADD.L   D5,A3
00001752                          1002              
00001752  4EB9 00001790           1003              JSR     CHECK_DIAGONALS
00001758  0C39 0000 00001E39      1004              CMP.B   #0,(WINNER)
00001760  6600 0028               1005              BNE     .FINISH_DIA          
00001764                          1006              
00001764  B2BC 00000000           1007              CMP.L   #0,D1
0000176A  6700 0008               1008              BEQ     .MINUS1
0000176E  7A01                    1009              MOVE.L  #1,D5
00001770  6000 0004               1010              BRA     .PASS_DIA
00001774  7AFF                    1011  .MINUS1     MOVE.L  #-1,D5
00001776  D3C5                    1012  .PASS_DIA   ADD.L   D5,A1
00001778  51CA FF94               1013              DBRA    D2,.LOOP_DIAGONALS_ROW1
0000177C                          1014              
0000177C  43F9 00001E0E           1015              LEA     ROW1,A1
00001782  5C89                    1016              ADDQ.L  #6,A1
00001784  7C06                    1017              MOVE.L  #6,D6
00001786  51C9 FF82               1018              DBRA    D1,.LOOP_TO_OTHER_SIDE
0000178A                          1019  
0000178A                          1020  .FINISH_DIA
0000178A  4CDF 0E7F               1021              MOVEM.L (A7)+,D0-D6/A1-A3            
0000178E  4E75                    1022              RTS
00001790                          1023  
00001790                          1024  CHECK_DIAGONALS
00001790  4280                    1025              CLR.L   D0
00001792  1013                    1026              MOVE.B  (A3),D0
00001794  D7C6                    1027              ADD.L   D6,A3
00001796  D013                    1028              ADD.B   (A3),D0
00001798  D7C6                    1029              ADD.L   D6,A3
0000179A  D013                    1030              ADD.B   (A3),D0
0000179C  D7C6                    1031              ADD.L   D6,A3
0000179E  D013                    1032              ADD.B   (A3),D0
000017A0                          1033              
000017A0  B03C 0004               1034              CMP.B   #4,D0
000017A4  6700 000C               1035              BEQ     .PLAYERWINS_DIA
000017A8  B03C 0014               1036              CMP.B   #20,D0
000017AC  6700 0004               1037              BEQ     .PLAYERWINS_DIA
000017B0                          1038              
000017B0  4E75                    1039              RTS
000017B2                          1040             
000017B2                          1041  .PLAYERWINS_DIA
000017B2  13F9 00001E38 00001E39  1042              MOVE.B  (TURN),(WINNER)
000017BC  1E3C 0002               1043              MOVE.B  #SNDWIN,D7
000017C0  4E42                    1044              TRAP    #SNDPLTN  
000017C2                          1045  
000017C2  7003                    1046              MOVE.L  #3,D0
000017C4                          1047  .LOOP_DIA
000017C4  16BC 0015               1048              MOVE.B  #21,(A3)
000017C8  97C6                    1049              SUB.L   D6,A3
000017CA  51C8 FFF8               1050              DBRA    D0,.LOOP_DIA
000017CE                          1051                     
000017CE  4E75                    1052              RTS
000017D0                          1053  
000017D0                          1054  
000017D0                          1055  
000017D0                          1056  
000017D0                          1057  
000017D0                          1058  
000017D0                          1059  
000017D0                          1060  
000017D0                          1061  
000017D0                          1062  
000017D0                          1063  
000017D0                          1064  
000017D0                          1065  
000017D0                          1066  -------------------- end include --------------------
000017D0                          1067              INCLUDE "PLAYER.X68"
000017D0                          1068  ; ==============================================================================
000017D0                          1069  ; PLAYERS MANAGEMENT
000017D0                          1070  ; ==============================================================================
000017D0                          1071             
000017D0                          1072  ; ------------------------------------------------------------------------------
000017D0                          1073  PLAINIT
000017D0                          1074  ; INITIALIZE PLAYER.
000017D0                          1075  ; INPUT    : NONE 
000017D0                          1076  ; OUTPUT   : NONE
000017D0                          1077  ; MODIFIES : NONE
000017D0                          1078  ; ------------------------------------------------------------------------------
000017D0                          1079              
000017D0  13FC 0001 00001E38      1080              MOVE.B  #1,(TURN)               ; STARTS THE PLAYER 1
000017D8  4239 00001E39           1081              CLR.B   (WINNER)
000017DE                          1082              
000017DE  4E75                    1083              RTS
000017E0                          1084              
000017E0                          1085  ; ------------------------------------------------------------------------------
000017E0                          1086  PLAUPD
000017E0                          1087  ; UPDATES THE PLAYER.
000017E0                          1088  ; INPUT    : NONE 
000017E0                          1089  ; OUTPUT   : NONE
000017E0                          1090  ; MODIFIES : NONE
000017E0                          1091  ; ------------------------------------------------------------------------------
000017E0                          1092              
000017E0  0C39 0001 00001E38      1093              CMP.B   #1,(TURN)               
000017E8  6700 000C               1094              BEQ     .PLAYER2                ; SWAPS TURN
000017EC  13FC 0001 00001E38      1095              MOVE.B  #1,(TURN)               ; PLAYER 1 TURN   
000017F4                          1096              
000017F4  4E75                    1097              RTS
000017F6                          1098              
000017F6  13FC 0005 00001E38      1099  .PLAYER2    MOVE.B  #5,(TURN)               ; PLAYER 2 TURN
000017FE                          1100              
000017FE  4E75                    1101              RTS
00001800                          1102              
00001800                          1103  
00001800                          1104  
00001800                          1105  
00001800                          1106  
00001800                          1107  
00001800                          1108  
00001800                          1109  -------------------- end include --------------------
00001800                          1110              INCLUDE "BOARD.X68"
00001800                          1111  ; ==============================================================================
00001800                          1112  ; BOARD MANAGEMENT
00001800                          1113  ; ==============================================================================
00001800                          1114              
00001800                          1115  ; ------------------------------------------------------------------------------
00001800                          1116  BOAPLOT
00001800                          1117  ; PLOT THE BOARD
00001800                          1118  ; INPUT    : A1 POINTER TO A NULL-TERMINATED STRING 
00001800                          1119  ; OUTPUT   : NONE
00001800                          1120  ; MODIFIES : NONE
00001800                          1121  ; ------------------------------------------------------------------------------
00001800                          1122  
00001800  48E7 C040               1123              MOVEM.L D0-D1/A1,-(A7)
00001804                          1124  
00001804                          1125              ; SET BACKGROUND COLOR
00001804  103C 0051               1126              MOVE.B  #81,D0
00001808  7200                    1127              MOVE.L  #00000000,D1
0000180A  4E4F                    1128              TRAP    #15
0000180C                          1129              
0000180C                          1130              ; SET FIRST LINE POSITION (SCREEN ARRAY COLUMNS = 120 ROWS = 47)
0000180C  103C 000B               1131              MOVE.B  #11,D0
00001810  323C 0000               1132              MOVE.W  #$0000,D1
00001814  4E4F                    1133              TRAP    #15
00001816                          1134  
00001816                          1135              ; PRINT LINE
00001816  4281                    1136              CLR.L   D1
00001818  0C39 0001 00001E38      1137              CMP.B   #1,(TURN)
00001820  6700 000A               1138              BEQ     .PLAYER1
00001824  123C 0002               1139              MOVE.B  #2,D1
00001828  6000 0006               1140              BRA     .PASS
0000182C                          1141              
0000182C  123C 0001               1142  .PLAYER1    MOVE.B  #1,D1
00001830                          1143  
00001830  103C 0011               1144  .PASS       MOVE.B  #17,D0
00001834  4E4F                    1145              TRAP    #15
00001836  4CDF 0203               1146              MOVEM.L (A7)+,D0-D1/A1
0000183A                          1147              
0000183A  4E75                    1148              RTS
0000183C                          1149  
0000183C                          1150  
0000183C                          1151  
0000183C                          1152  
0000183C                          1153  
0000183C                          1154  
0000183C                          1155  
0000183C                          1156  
0000183C                          1157  
0000183C                          1158  
0000183C                          1159  
0000183C                          1160  -------------------- end include --------------------
0000183C                          1161              INCLUDE "GAME.X68"
0000183C                          1162  ; ==============================================================================
0000183C                          1163  ; GAME MANAGEMENT
0000183C                          1164  ; ==============================================================================
0000183C                          1165  
0000183C                          1166  ; ------------------------------------------------------------------------------
0000183C                          1167  GAMINIT
0000183C                          1168  ; INITIALIZES GAME.
0000183C                          1169  ; INPUT    : NONE
0000183C                          1170  ; OUTPUT   : NONE
0000183C                          1171  ; MODIFIES : NONE
0000183C                          1172  ; ------------------------------------------------------------------------------
0000183C  4EB8 13AA               1173              JSR     TABINIT
00001840  4EB8 1304               1174              JSR     BOXINIT
00001844  4EB8 1400               1175              JSR     PIEINIT
00001848  4EB8 17D0               1176              JSR     PLAINIT
0000184C  4E75                    1177              RTS
0000184E                          1178  
0000184E                          1179  ; ------------------------------------------------------------------------------
0000184E                          1180  GAMUPD
0000184E                          1181  ; UPDATES THE GAME
0000184E                          1182  ; INPUT    : NONE
0000184E                          1183  ; OUTPUT   : NONE
0000184E                          1184  ; MODIFIES : NONE
0000184E                          1185  ; ------------------------------------------------------------------------------
0000184E                          1186                          
0000184E  0C39 0000 00001E39      1187              CMP.B   #0,(WINNER)
00001856  6700 0034               1188              BEQ     .CONTINUE
0000185A                          1189              
0000185A  0839 0004 00001EC5      1190              BTST.B  #4,(KBDEDGE)
00001862  6700 000E               1191              BEQ     .CONT
00001866  33FC 0002 00001E3E      1192              MOVE.W  #2,(STANEXT)
0000186E  6000 0020               1193              BRA     .DONE
00001872  5279 00001E3A           1194  .CONT       ADDQ.W  #1,(TIMER)
00001878  0C79 00B4 00001E3A      1195              CMP.W   #180,(TIMER)
00001880  6D00 000E               1196              BLT     .DONE
00001884  33FC 0002 00001E3E      1197              MOVE.W  #2,(STANEXT)                      
0000188C  4EB8 143A               1198  .CONTINUE   JSR     PIEUPD
00001890                          1199  .DONE
00001890  4E75                    1200              RTS
00001892                          1201  
00001892                          1202  ; ------------------------------------------------------------------------------
00001892                          1203  GAMPLOT
00001892                          1204  ; PLOTS THE GAME
00001892                          1205  ; INPUT    : NONE
00001892                          1206  ; OUTPUT   : NONE
00001892                          1207  ; MODIFIES : NONE
00001892                          1208  ; ------------------------------------------------------------------------------
00001892  48E7 FE40               1209              MOVEM.L D0-D6/A1,-(A7)
00001896                          1210              
00001896  4EB8 13C8               1211              JSR     TABPLOT
0000189A                          1212              
0000189A  303C 0006               1213              MOVE.W  #BOXNCOL-1,D0
0000189E                          1214  .PLOT_NEXT_COL
0000189E  343C 0007               1215              MOVE.W  #BOXNCOL,D2
000018A2  9440                    1216              SUB.W   D0,D2
000018A4  33C2 00001DF8           1217              MOVE.W  D2,(BOXCOL)
000018AA                          1218              
000018AA  323C 0005               1219              MOVE.W  #BOXNROW-1,D1
000018AE                          1220  .PLOT_NEXT_ROW
000018AE  343C 0006               1221              MOVE.W  #BOXNROW,D2
000018B2  9441                    1222              SUB.W   D1,D2
000018B4  33C2 00001DFA           1223              MOVE.W  D2,(BOXROW)
000018BA                          1224              
000018BA  4EB8 1318               1225              JSR     BOXPLOT
000018BE                          1226              
000018BE  51C9 FFEE               1227              DBRA    D1,.PLOT_NEXT_ROW
000018C2  51C8 FFDA               1228              DBRA    D0,.PLOT_NEXT_COL
000018C6                          1229              
000018C6  3A39 00001E00           1230              MOVE.W  (PIEPOSX),D5
000018CC  3C39 00001E02           1231              MOVE.W  (PIEPOSY),D6
000018D2  1039 00001E38           1232              MOVE.B  (TURN),D0
000018D8  4EB8 1520               1233              JSR     PIEPLOT
000018DC  43F9 000018EC           1234              LEA     .TXT,A1
000018E2  4EB8 1800               1235              JSR     BOAPLOT                 
000018E6                          1236              
000018E6  4CDF 027F               1237              MOVEM.L (A7)+,D0-D6/A1
000018EA                          1238              
000018EA  4E75                    1239              RTS
000018EC                          1240  
000018EC= 50 4C 41 59 45 52 ...   1241  .TXT        DC.B    'PLAYER TURN: ',0            
000018FA                          1242              DS.W    0
000018FA                          1243  
000018FA                          1244  
000018FA                          1245  
000018FA                          1246  
000018FA                          1247  -------------------- end include --------------------
000018FA                          1248              INCLUDE "SCREENS/INTRO.X68"
000018FA                          1249  ; ---------------------------------------------------------------------
000018FA                          1250  ; INTRO SCREEN
000018FA                          1251  ; ---------------------------------------------------------------------
000018FA                          1252  
000018FA                          1253  ; ------------------------------------------------------------------------------
000018FA                          1254  ISCINIT
000018FA                          1255  ; INTRO SCREEN INIT
000018FA                          1256  ; INPUT    : NONE 
000018FA                          1257  ; OUTPUT   : NONE
000018FA                          1258  ; MODIFIES : NONE
000018FA                          1259  ; ------------------------------------------------------------------------------
000018FA                          1260              
000018FA  4279 00001E3A           1261              CLR.W   (TIMER)
00001900  4E75                    1262              RTS
00001902                          1263              
00001902                          1264  ; ------------------------------------------------------------------------------
00001902                          1265  ISCUPD
00001902                          1266  ; INTRO SCREEN UPDATE
00001902                          1267  ; INPUT    : NONE 
00001902                          1268  ; OUTPUT   : NONE
00001902                          1269  ; MODIFIES : NONE
00001902                          1270  ; ------------------------------------------------------------------------------
00001902                          1271              
00001902  0839 0004 00001EC5      1272              BTST.B  #4,(KBDEDGE)
0000190A  6700 000A               1273              BEQ     .CONT
0000190E  33FC 0001 00001E3E      1274              MOVE.W  #1,(STANEXT)
00001916                          1275  
00001916  1E3C 0003               1276  .CONT       MOVE.B  #SNDMUSIC,D7
0000191A  4E42                    1277              TRAP    #SNDPLTN
0000191C  5279 00001E3A           1278              ADDQ.W  #1,(TIMER)
00001922  0C79 0258 00001E3A      1279              CMP.W   #600,(TIMER)
0000192A  6D00 000A               1280              BLT     .DONE
0000192E  33FC 0003 00001E3E      1281              MOVE.W  #3,(STANEXT)
00001936                          1282  .DONE       
00001936  4E75                    1283              RTS
00001938                          1284              
00001938                          1285  ; ------------------------------------------------------------------------------
00001938                          1286  ISCPLOT
00001938                          1287  ; INTRO SCREEN PLOT
00001938                          1288  ; INPUT    : NONE 
00001938                          1289  ; OUTPUT   : NONE
00001938                          1290  ; MODIFIES : NONE
00001938                          1291  ; ------------------------------------------------------------------------------
00001938                          1292              
00001938  48E7 C0C0               1293              MOVEM.L D0-D1/A0-A1,-(A7)
0000193C                          1294              
0000193C                          1295              ; SET BACKGROUND COLOR
0000193C  103C 0051               1296              MOVE.B  #81,D0
00001940  7200                    1297              MOVE.L  #00000000,D1
00001942  4E4F                    1298              TRAP    #15
00001944                          1299              
00001944  103C 000B               1300              MOVE.B  #11,D0
00001948                          1301              
00001948  41F9 00001986           1302              LEA     .TXT1,A0
0000194E  4EB8 11B2               1303              JSR     UTLPRINT
00001952                          1304              
00001952  5800                    1305              ADDQ.B  #4,D0
00001954  43F9 00001A7A           1306              LEA     .TXTLST,A1
0000195A  2219                    1307  .LOOP       MOVE.L  (A1)+,D1
0000195C  6700 000A               1308              BEQ     .DONE1
00001960  2041                    1309              MOVE.L  D1,A0
00001962  4EB8 11B2               1310              JSR     UTLPRINT
00001966  60F2                    1311              BRA    .LOOP
00001968                          1312  .DONE1            
00001968  0839 0004 00001EC7      1313              BTST.B   #4,(SCRCYCCT)
00001970  6700 000E               1314              BEQ     .DONE2
00001974                          1315              
00001974  41F9 00001A64           1316              LEA     .TXT7,A0
0000197A  5C00                    1317              ADD.B   #6,D0
0000197C  4EB8 11B2               1318              JSR     UTLPRINT
00001980                          1319              
00001980  4CDF 0303               1320  .DONE2      MOVEM.L (A7)+,D0-D1/A0-A1
00001984                          1321              
00001984  4E75                    1322              RTS
00001986                          1323  
00001986= 43 4F 4E 4E 45 43 ...   1324  .TXT1       DC.B    'CONNECT-4',0
00001990= 54 52 59 20 54 4F ...   1325  .TXT2       DC.B    'TRY TO CONNECT 4 PIECES IN A LINE',0
000019B2= 55 53 45 20 4C 45 ...   1326  .TXT3       DC.B    'USE LEFT AND RIGHT ARROWS TO SELECT PIECE POSITION',0
000019E5= 50 52 45 53 53 20 ...   1327  .TXT4       DC.B    'PRESS SPACE TO PLACE A PIECE',0
00001A02= 41 46 54 45 52 20 ...   1328  .TXT5       DC.B    'AFTER PLACING A PIECE THE TURN WILL SWAP',0
00001A2B= 50 4C 41 59 45 52 ...   1329  .TXT6       DC.B    'PLAYER 1 HAVE RED PIECES AND PLAYER 2 HAVE YELLOW PIECES',0
00001A64= 50 52 45 53 53 20 ...   1330  .TXT7       DC.B    'PRESS SPACE TO START',0
00001A7A                          1331              DS.W    0
00001A7A= 00001990 000019B2 ...   1332  .TXTLST     DC.L    .TXT2,.TXT3,.TXT4,.TXT5,.TXT6,0
00001A92                          1333  
00001A92                          1334  
00001A92                          1335  
00001A92                          1336  
00001A92                          1337  
00001A92                          1338  
00001A92                          1339  
00001A92                          1340  
00001A92                          1341  
00001A92                          1342  
00001A92                          1343  
00001A92                          1344  
00001A92                          1345  
00001A92                          1346  -------------------- end include --------------------
00001A92                          1347              INCLUDE "SCREENS/ENDGAME.X68"
00001A92                          1348  ; ---------------------------------------------------------------------
00001A92                          1349  ; END GAME SCREEN
00001A92                          1350  ; ---------------------------------------------------------------------
00001A92                          1351  
00001A92                          1352  ; ------------------------------------------------------------------------------
00001A92                          1353  ENDINIT
00001A92                          1354  ; INTRO SCREEN INIT
00001A92                          1355  ; INPUT    : NONE 
00001A92                          1356  ; OUTPUT   : NONE
00001A92                          1357  ; MODIFIES : NONE
00001A92                          1358  ; ------------------------------------------------------------------------------
00001A92                          1359              
00001A92  4279 00001E3A           1360              CLR.W   (TIMER)
00001A98                          1361              
00001A98  33FC 01E0 00001E00      1362              MOVE.W  #SCRWIDTH/2,(PIEPOSX)
00001AA0  33FC 0168 00001E02      1363              MOVE.W  #SCRHEIGH/2,(PIEPOSY)
00001AA8                          1364              
00001AA8  4E75                    1365              RTS
00001AAA                          1366              
00001AAA                          1367  ; ------------------------------------------------------------------------------
00001AAA                          1368  ENDUPD
00001AAA                          1369  ; INTRO SCREEN UPDATE
00001AAA                          1370  ; INPUT    : NONE 
00001AAA                          1371  ; OUTPUT   : NONE
00001AAA                          1372  ; MODIFIES : NONE
00001AAA                          1373  ; ------------------------------------------------------------------------------
00001AAA                          1374              
00001AAA  0839 0004 00001EC5      1375              BTST.B  #4,(KBDEDGE)
00001AB2  6700 000A               1376              BEQ     .CONT
00001AB6  33FC 0000 00001E3E      1377              MOVE.W  #0,(STANEXT)
00001ABE                          1378  
00001ABE  1E3C 0003               1379  .CONT       MOVE.B  #SNDMUSIC,D7
00001AC2  4E42                    1380              TRAP    #SNDPLTN
00001AC4  5279 00001E3A           1381              ADDQ.W  #1,(TIMER)
00001ACA  0C79 0258 00001E3A      1382              CMP.W   #600,(TIMER)
00001AD2  6D00 000A               1383              BLT     .DONE
00001AD6  33FC 0000 00001E3E      1384              MOVE.W  #0,(STANEXT)
00001ADE                          1385  .DONE     
00001ADE  4E75                    1386              RTS
00001AE0                          1387              
00001AE0                          1388  ; ------------------------------------------------------------------------------
00001AE0                          1389  ENDPLOT
00001AE0                          1390  ; INTRO SCREEN PLOT
00001AE0                          1391  ; INPUT    : NONE 
00001AE0                          1392  ; OUTPUT   : NONE
00001AE0                          1393  ; MODIFIES : NONE
00001AE0                          1394  ; ------------------------------------------------------------------------------
00001AE0                          1395              
00001AE0  48E7 FE80               1396              MOVEM.L D0-D6/A0,-(A7)
00001AE4                          1397              
00001AE4                          1398              ; SET BACKGROUND COLOR
00001AE4  103C 0051               1399              MOVE.B  #81,D0
00001AE8  7200                    1400              MOVE.L  #00000000,D1
00001AEA  4E4F                    1401              TRAP    #15
00001AEC                          1402              
00001AEC  103C 000F               1403              MOVE.B  #15,D0
00001AF0                          1404              
00001AF0  0C39 0005 00001E39      1405              CMP.B   #5,(WINNER)
00001AF8  6700 000C               1406              BEQ     .PLAYER2_WIN
00001AFC  41F9 00001B30           1407              LEA     .TXT1,A0
00001B02  6000 0008               1408              BRA     .DONE
00001B06                          1409  .PLAYER2_WIN            
00001B06  41F9 00001B4A           1410              LEA     .TXT2,A0
00001B0C                          1411              
00001B0C  4EB8 11B2               1412  .DONE       JSR     UTLPRINT
00001B10                          1413              
00001B10  4285                    1414              CLR.L   D5
00001B12  4286                    1415              CLR.L   D6
00001B14  3A39 00001E00           1416              MOVE.W  (PIEPOSX),D5
00001B1A  3C39 00001E02           1417              MOVE.W  (PIEPOSY),D6
00001B20  1039 00001E39           1418              MOVE.B  (WINNER),D0
00001B26  4EB8 1520               1419              JSR     PIEPLOT
00001B2A                          1420              
00001B2A  4CDF 017F               1421              MOVEM.L (A7)+,D0-D6/A0
00001B2E                          1422              
00001B2E  4E75                    1423              RTS
00001B30                          1424  
00001B30= A1 A1 A1 A1 A1 20 ...   1425  .TXT1       DC.B    ' PLAYER 1 WINS !!!!!',0
00001B4A= A1 A1 A1 A1 A1 20 ...   1426  .TXT2       DC.B    ' PLAYER 2 WINS !!!!!',0
00001B64                          1427              DS.W    0
00001B64                          1428  
00001B64                          1429  
00001B64                          1430  
00001B64                          1431  
00001B64                          1432  -------------------- end include --------------------
00001B64                          1433              INCLUDE "ATTRACTMODE/FILE.X68"
00001B64                          1434  ; ==============================================================================
00001B64                          1435  ; FILE MANAGEMENT
00001B64                          1436  ; ==============================================================================
00001B64                          1437  
00001B64                          1438  ; ------------------------------------------------------------------------------
00001B64                          1439  FILEINIT
00001B64                          1440  ; INITIALIZE FILE
00001B64                          1441  ; INPUT    : NONE 
00001B64                          1442  ; OUTPUT   : NONE
00001B64                          1443  ; MODIFIES : NONE
00001B64                          1444  ; ------------------------------------------------------------------------------
00001B64                          1445  
00001B64  48E7 C040               1446              MOVEM.L  D0-D1/A1,-(A7)
00001B68                          1447              
00001B68                          1448              ; CLEAR THE STORADGE OF THE THING WE GONA READ
00001B68  43F9 00001E44           1449              LEA.L   READED,A1
00001B6E  703E                    1450              MOVE.L  #(126/2)-1,D0
00001B70  4259                    1451  .LOOP1      CLR.W   (A1)+
00001B72  51C8 FFFC               1452              DBRA    D0,.LOOP1
00001B76                          1453                   
00001B76  43F8 1000               1454              LEA.L   FILE,A1
00001B7A  7033                    1455              MOVE.L  #51,D0
00001B7C  4E4F                    1456              TRAP    #15
00001B7E                          1457              
00001B7E  23C1 00001E40           1458              MOVE.L  D1,(FILEID)             ;KEEP THE ID OF THE FILE
00001B84                          1459              
00001B84  4CDF 0203               1460              MOVEM.L  (A7)+,D0-D1/A1
00001B88  4E75                    1461              RTS    
00001B8A                          1462  
00001B8A                          1463  ; ------------------------------------------------------------------------------
00001B8A                          1464  READFILE
00001B8A                          1465  ; READ THE FILE THAT CONTAINS THE MOVES
00001B8A                          1466  ; INPUT    : NONE 
00001B8A                          1467  ; OUTPUT   : NONE
00001B8A                          1468  ; MODIFIES : NONE
00001B8A                          1469  ; ------------------------------------------------------------------------------
00001B8A                          1470  
00001B8A  48E7 E040               1471              MOVEM.L  D0-D2/A1,-(A7)
00001B8E                          1472              
00001B8E  43F9 00001E44           1473              LEA.L   READED,A1
00001B94  7035                    1474              MOVE.L  #53,D0
00001B96  2239 00001E40           1475              MOVE.L  (FILEID),D1
00001B9C  747E                    1476              MOVE.L  #126,D2
00001B9E  4E4F                    1477              TRAP    #15
00001BA0                          1478              
00001BA0                          1479              ;CEAN WHAT WE READED (PUTS A $3 IN THE HIGH 4 BITS ON EVERY POS.)
00001BA0  43F9 00001E44           1480              LEA.L   READED,A1
00001BA6  5302                    1481              SUBQ.B  #1,D2                   ;D2 = BYTES READED
00001BA8  0419 0030               1482  .LOOP2      SUB.B   #$30,(A1)+
00001BAC  51CA FFFA               1483              DBRA    D2,.LOOP2                
00001BB0                          1484              
00001BB0  4CDF 0207               1485              MOVEM.L  (A7)+,D0-D2/A1
00001BB4  4E75                    1486              RTS
00001BB6                          1487  
00001BB6                          1488  -------------------- end include --------------------
00001BB6                          1489              INCLUDE "ATTRACTMODE/AUTOGAME.X68"
00001BB6                          1490  ; ==============================================================================
00001BB6                          1491  ; AUTOMATIC GAME MANAGEMENT
00001BB6                          1492  ; ==============================================================================
00001BB6                          1493  
00001BB6                          1494  ; ------------------------------------------------------------------------------
00001BB6                          1495  AUTOINIT
00001BB6                          1496  ; INITIALIZES GAME.
00001BB6                          1497  ; INPUT    : NONE
00001BB6                          1498  ; OUTPUT   : NONE
00001BB6                          1499  ; MODIFIES : NONE
00001BB6                          1500  ; ------------------------------------------------------------------------------
00001BB6  4EB8 13AA               1501              JSR     TABINIT
00001BBA  4EB8 1304               1502              JSR     BOXINIT
00001BBE  4EB8 1400               1503              JSR     PIEINIT
00001BC2  4EB8 17D0               1504              JSR     PLAINIT
00001BC6  4EB8 1B64               1505              JSR     FILEINIT
00001BCA  4EB8 1B8A               1506              JSR     READFILE
00001BCE  4239 00001EC2           1507              CLR.B   (INDEXREAD)
00001BD4  4E75                    1508              RTS
00001BD6                          1509  
00001BD6                          1510  ; ------------------------------------------------------------------------------
00001BD6                          1511  AUTOUPD
00001BD6                          1512  ; UPDATES THE GAME
00001BD6                          1513  ; INPUT    : NONE
00001BD6                          1514  ; OUTPUT   : NONE
00001BD6                          1515  ; MODIFIES : NONE
00001BD6                          1516  ; ------------------------------------------------------------------------------
00001BD6                          1517                      
00001BD6  48E7 F040               1518              MOVEM.L  D0-D3/A1,-(A7)
00001BDA                          1519              
00001BDA  4280                    1520              CLR.L   D0
00001BDC  4283                    1521              CLR.L   D3
00001BDE                          1522      
00001BDE  0839 0004 00001EC5      1523              BTST.B  #4,(KBDEDGE)
00001BE6  6700 000E               1524              BEQ     .PASS
00001BEA  33FC 0000 00001E3E      1525              MOVE.W  #0,(STANEXT)
00001BF2  6000 00BA               1526              BRA     .DONE
00001BF6                          1527  .PASS
00001BF6  0C39 0000 00001E39      1528              CMP.B   #0,(WINNER)
00001BFE  6700 001C               1529              BEQ     .CONTINUE
00001C02  5279 00001E3A           1530              ADDQ.W  #1,(TIMER)
00001C08  0C79 00B4 00001E3A      1531              CMP.W   #180,(TIMER)
00001C10  6D00 009C               1532              BLT     .DONE
00001C14  33FC 0000 00001E3E      1533              MOVE.W  #0,(STANEXT)                      
00001C1C                          1534  .CONTINUE   
00001C1C  1639 00001EC7           1535              MOVE.B  (SCRCYCCT),D3
00001C22  C63C 00F8               1536              AND.B   #$F8,D3
00001C26  B639 00001EC7           1537              CMP.B   (SCRCYCCT),D3
00001C2C  6600 0080               1538              BNE     .DONE
00001C30  0C39 0000 00001E0C      1539              CMP.B   #0,(FALLING)
00001C38  6700 000A               1540              BEQ     .PASS1
00001C3C  4EB8 15A8               1541              JSR     PIEFALL
00001C40  6000 006C               1542              BRA     .DONE
00001C44                          1543  .PASS1            
00001C44  0C39 007D 00001EC2      1544              CMP.B   #125,(INDEXREAD)
00001C4C  6300 000E               1545              BLS     .PASS2
00001C50  33FC 0000 00001E3E      1546              MOVE.W  #0,(STANEXT)
00001C58  6000 0054               1547              BRA     .DONE
00001C5C                          1548  .PASS2      
00001C5C  3039 00001E00           1549              MOVE.W  (PIEPOSX),D0      
00001C62  43F9 00001E44           1550              LEA     READED,A1
00001C68  1639 00001EC2           1551              MOVE.B  (INDEXREAD),D3
00001C6E  D3C3                    1552              ADD.L   D3,A1
00001C70                          1553              ; 2 EQUALS PRESS LEFT ARROW
00001C70  0C11 0002               1554              CMP.B   #2,(A1)
00001C74  6700 0020               1555              BEQ     .AUTOLEFT
00001C78                          1556              ; 3 EQUALS PRESS RIGHT ARROW
00001C78  0C11 0003               1557              CMP.B   #3,(A1)
00001C7C  6700 0020               1558              BEQ     .AUTORIGHT
00001C80                          1559              ; 1 EQUALS PRESS FIRE 1
00001C80  1E3C 0001               1560              MOVE.B  #SNDFALL,D7
00001C84  4E42                    1561              TRAP    #SNDPLTN
00001C86  13FC 0001 00001E0C      1562              MOVE.B  #1,(FALLING)
00001C8E  4EB8 15A8               1563              JSR     PIEFALL
00001C92  6000 000E               1564              BRA     .JUMP            
00001C96  4EB8 14CA               1565  .AUTOLEFT   JSR     PRESSLEFT
00001C9A  6000 0006               1566              BRA     .JUMP
00001C9E  4EB8 14F6               1567  .AUTORIGHT  JSR     PRESSRIGHT
00001CA2                          1568              
00001CA2  33C0 00001E00           1569  .JUMP       MOVE.W  D0,(PIEPOSX)
00001CA8  5239 00001EC2           1570              ADDQ.B  #1,(INDEXREAD)
00001CAE                          1571              
00001CAE  4CDF 020F               1572  .DONE       MOVEM.L  (A7)+,D0-D3/A1
00001CB2  4E75                    1573              RTS
00001CB4                          1574  
00001CB4                          1575  ; ------------------------------------------------------------------------------
00001CB4                          1576  AUTOPLOT
00001CB4                          1577  ; PLOTS THE GAME
00001CB4                          1578  ; INPUT    : NONE
00001CB4                          1579  ; OUTPUT   : NONE
00001CB4                          1580  ; MODIFIES : NONE
00001CB4                          1581  ; ------------------------------------------------------------------------------
00001CB4  48E7 FE40               1582              MOVEM.L D0-D6/A1,-(A7)
00001CB8                          1583              
00001CB8  4EB8 13C8               1584              JSR     TABPLOT
00001CBC                          1585              
00001CBC  303C 0006               1586              MOVE.W  #BOXNCOL-1,D0
00001CC0                          1587  .PLOT_NEXT_COL
00001CC0  343C 0007               1588              MOVE.W  #BOXNCOL,D2
00001CC4  9440                    1589              SUB.W   D0,D2
00001CC6  33C2 00001DF8           1590              MOVE.W  D2,(BOXCOL)
00001CCC                          1591              
00001CCC  323C 0005               1592              MOVE.W  #BOXNROW-1,D1
00001CD0                          1593  .PLOT_NEXT_ROW
00001CD0  343C 0006               1594              MOVE.W  #BOXNROW,D2
00001CD4  9441                    1595              SUB.W   D1,D2
00001CD6  33C2 00001DFA           1596              MOVE.W  D2,(BOXROW)
00001CDC                          1597              
00001CDC  4EB8 1318               1598              JSR     BOXPLOT
00001CE0                          1599              
00001CE0  51C9 FFEE               1600              DBRA    D1,.PLOT_NEXT_ROW
00001CE4  51C8 FFDA               1601              DBRA    D0,.PLOT_NEXT_COL
00001CE8                          1602              
00001CE8  3A39 00001E00           1603              MOVE.W  (PIEPOSX),D5
00001CEE  3C39 00001E02           1604              MOVE.W  (PIEPOSY),D6
00001CF4  1039 00001E38           1605              MOVE.B  (TURN),D0
00001CFA  4EB8 1520               1606              JSR     PIEPLOT
00001CFE  43F9 00001D0E           1607              LEA     .TXT,A1
00001D04  4EB8 1800               1608              JSR     BOAPLOT                 
00001D08                          1609              
00001D08  4CDF 027F               1610              MOVEM.L (A7)+,D0-D6/A1
00001D0C                          1611              
00001D0C  4E75                    1612              RTS
00001D0E                          1613  
00001D0E= 41 55 54 4F 4D 41 ...   1614  .TXT        DC.B    'AUTOMATIC GAME /// PLAYER TURN: ',0            
00001D30                          1615              DS.W    0
00001D30                          1616  
00001D30                          1617  
00001D30                          1618  
00001D30                          1619  -------------------- end include --------------------
00001D30                          1620              INCLUDE "STATES.X68"
00001D30                          1621  ; =============================================================================
00001D30                          1622  ; GAME STATE MANAGEMENT
00001D30                          1623  ; =============================================================================
00001D30                          1624  
00001D30                          1625  ; -----------------------------------------------------------------------------
00001D30                          1626  STAINIT
00001D30                          1627  ; INITALIZES THE STATE MANAGER
00001D30                          1628  ; INPUT    - NONE
00001D30                          1629  ; OUTPUT   - NONE
00001D30                          1630  ; MODIFIES - NONE
00001D30                          1631  ; -----------------------------------------------------------------------------
00001D30  33FC FFFF 00001E3C      1632              MOVE.W  #STANONE,(STACUR)
00001D38  4279 00001E3E           1633              CLR.W   (STANEXT)
00001D3E  4E75                    1634              RTS
00001D40                          1635  
00001D40                          1636  ; -----------------------------------------------------------------------------
00001D40                          1637  STAUPD
00001D40                          1638  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00001D40                          1639  ; INPUT    - NONE
00001D40                          1640  ; OUTPUT   - NONE
00001D40                          1641  ; MODIFIES - NONE
00001D40                          1642  ; -----------------------------------------------------------------------------
00001D40  48E7 8080               1643              MOVEM.L D0/A0,-(A7)
00001D44  4280                    1644              CLR.L   D0
00001D46  3039 00001E3E           1645              MOVE.W  (STANEXT),D0
00001D4C  B079 00001E3C           1646              CMP.W   (STACUR),D0
00001D52  6700 0012               1647              BEQ     .DOUPD
00001D56  33C0 00001E3C           1648              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00001D5C  E588                    1649              LSL.L   #2,D0
00001D5E  2040                    1650              MOVE.L  D0,A0
00001D60  2068 1D7E               1651              MOVE.L  .INITBL(A0),A0
00001D64  4E90                    1652              JSR     (A0)
00001D66  4280                    1653  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00001D68  3039 00001E3C           1654              MOVE.W  (STACUR),D0
00001D6E  E588                    1655              LSL.L   #2,D0
00001D70  2040                    1656              MOVE.L  D0,A0
00001D72  2068 1D8E               1657              MOVE.L  .UPDTBL(A0),A0
00001D76  4E90                    1658              JSR     (A0)
00001D78  4CDF 0101               1659              MOVEM.L (A7)+,D0/A0
00001D7C  4E75                    1660              RTS
00001D7E= 000018FA 0000183C ...   1661  .INITBL     DC.L    ISCINIT,GAMINIT,ENDINIT,AUTOINIT
00001D8E= 00001902 0000184E ...   1662  .UPDTBL     DC.L    ISCUPD,GAMUPD,ENDUPD,AUTOUPD
00001D9E                          1663  
00001D9E                          1664  ; -----------------------------------------------------------------------------
00001D9E                          1665  STAPLOT
00001D9E                          1666  ; PERFORMS STATE PLOT
00001D9E                          1667  ; INPUT    - NONE
00001D9E                          1668  ; OUTPUT   - NONE
00001D9E                          1669  ; MODIFIES - NONE
00001D9E                          1670  ; -----------------------------------------------------------------------------
00001D9E  48E7 8080               1671              MOVEM.L D0/A0,-(A7)
00001DA2  4280                    1672              CLR.L   D0
00001DA4  3039 00001E3C           1673              MOVE.W  (STACUR),D0
00001DAA  E588                    1674              LSL.L   #2,D0
00001DAC  2040                    1675              MOVE.L  D0,A0
00001DAE  2068 1DBA               1676              MOVE.L  .PLTTBL(A0),A0
00001DB2  4E90                    1677              JSR     (A0)
00001DB4  4CDF 0101               1678              MOVEM.L (A7)+,D0/A0
00001DB8  4E75                    1679              RTS
00001DBA= 00001938 00001892 ...   1680  .PLTTBL     DC.L    ISCPLOT,GAMPLOT,ENDPLOT,AUTOPLOT
00001DCA                          1681  
00001DCA                          1682  ; -----------------------------------------------------------------------------
00001DCA                          1683  STAEMPTY
00001DCA                          1684  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00001DCA                          1685  ; INPUT    - NONE
00001DCA                          1686  ; OUTPUT   - NONE
00001DCA                          1687  ; MODIFIES - NONE
00001DCA                          1688  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00001DCA                          1689  ; -----------------------------------------------------------------------------
00001DCA  4E75                    1690              RTS
00001DCC                          1691  
00001DCC                          1692  
00001DCC                          1693  
00001DCC                          1694  
00001DCC                          1695  
00001DCC                          1696  
00001DCC                          1697  
00001DCC                          1698  
00001DCC                          1699  
00001DCC                          1700  
00001DCC                          1701  
00001DCC                          1702  
00001DCC                          1703  
00001DCC                          1704  -------------------- end include --------------------
00001DCC                          1705             
00001DCC                          1706  START
00001DCC                          1707  
00001DCC                          1708  ; --- INITIALIZATION -----------------------------------------------------------
00001DCC                          1709              
00001DCC  007C 0700               1710              ORI.W   #$0700,SR
00001DD0  4EB8 1012               1711              JSR     SYSINIT
00001DD4  4EB8 1D30               1712              JSR     STAINIT
00001DD8                          1713  
00001DD8                          1714  .LOOP
00001DD8                          1715  
00001DD8                          1716  ; --- UPDATE -------------------------------------------------------------------
00001DD8                          1717  
00001DD8                          1718  ; READ INPUT DEVICES
00001DD8                          1719  
00001DD8  4E41                    1720              TRAP    #KBDUPTN
00001DDA                          1721  
00001DDA                          1722  ; UPDATE GAME LOGIC
00001DDA                          1723  
00001DDA  4EB8 1D40               1724              JSR     STAUPD   
00001DDE                          1725                      
00001DDE                          1726  ; --- SYNC ---------------------------------------------------------------------
00001DDE                          1727  
00001DDE  4A39 00001EC6           1728  .WINT       TST.B   (SCRINTCT)
00001DE4  67F8                    1729              BEQ     .WINT
00001DE6  4239 00001EC6           1730              CLR.B   (SCRINTCT)
00001DEC                          1731  
00001DEC                          1732  ; --- PLOT ---------------------------------------------------------------------
00001DEC                          1733  
00001DEC  4EB8 1D9E               1734              JSR    STAPLOT
00001DF0                          1735  
00001DF0  4E40                    1736              TRAP    #SCRUPTN                ; UPDATE DOBLE BUFFER
00001DF2                          1737              
00001DF2  60E4                    1738              BRA     .LOOP
00001DF4                          1739  
00001DF4  FFFF FFFF               1740              SIMHALT
00001DF8                          1741              
00001DF8                          1742              INCLUDE "VARS.X68"
00001DF8                          1743  ; ==============================================================================
00001DF8                          1744  ; GAME VARIABLES
00001DF8                          1745  ; ==============================================================================
00001DF8                          1746  
00001DF8                          1747  ; --- BOX RELATED VARIABLES ----------------------------------------------------
00001DF8                          1748  
00001DF8                          1749  BOXCOL      DS.W    1                       ; COLUMN WHERE THE BOX IS PAINTED  
00001DFA                          1750  BOXROW      DS.W    1                       ; ROW WHERE THE BOX IS PAINTED
00001DFC                          1751  BOXPOSX     DS.W    1                       ; BOX X COORDINATE
00001DFE                          1752  BOXPOSY     DS.W    1                       ; BOX Y COORDINATE
00001E00                          1753  
00001E00                          1754  ; --- PIECE RELATED VARIABLES --------------------------------------------------
00001E00                          1755  
00001E00                          1756  PIEPOSX     DS.W    1                       ; PIECE X COORDINATE
00001E02                          1757  PIEPOSY     DS.W    1                       ; PIECE Y COORDINATE
00001E04                          1758  PIEVELX     DS.W    1                       ; X MOVEMENT
00001E06                          1759  PIEVELY     DS.W    1                       ; Y MOVEMENT
00001E08                          1760  POSX        DS.W    1                       ; POS. X IN THE MATRIX 
00001E0A                          1761  POSY        DS.W    1                       ; POS. Y IN THE MATRIX
00001E0C                          1762  FALLING     DS.B    1                       ; 1 A PIECE IS FALLING, 0 NOT
00001E0E                          1763              DS.W    0
00001E0E                          1764  
00001E0E                          1765  ; --- COLUMN RELATED VARIABLES -------------------------------------------------
00001E0E                          1766  
00001E0E                          1767  ROW1        DS.B    7
00001E15                          1768  ROW2        DS.B    7
00001E1C                          1769  ROW3        DS.B    7
00001E23                          1770  ROW4        DS.B    7
00001E2A                          1771  ROW5        DS.B    7
00001E31                          1772  ROW6        DS.B    7
00001E38                          1773              DS.W    0
00001E38                          1774  
00001E38                          1775  ; --- PLAYER VARIABLES ---------------------------------------------------------
00001E38                          1776  
00001E38                          1777  TURN        DS.B    1                       ; PLAYER WHO PLAY IN THAT TURN
00001E39                          1778  WINNER      DS.B    1                       ; 0 NONE, 1 OR 5 (PLAYER WHO WIN)
00001E3A                          1779              DS.W    0
00001E3A                          1780  
00001E3A                          1781  ; --- INTRO STATE RELATED VARAIBLES --------------------------------------------
00001E3A                          1782  
00001E3A                          1783  TIMER       DS.W    1                       ; INTRO TIMER 
00001E3C                          1784  
00001E3C                          1785  ; --- STATE RELATED VARAIBLES --------------------------------------------------
00001E3C                          1786  
00001E3C                          1787  STACUR      DS.W    1                       ; CURRENT STATE
00001E3E                          1788  STANEXT     DS.W    1                       ; NEXT STATE
00001E40                          1789  
00001E40                          1790  ; --- FILE VARAIBLES -----------------------------------------------------------
00001E40                          1791  
00001E40                          1792  FILEID      DS.L    1                       ; ID OF THE OPENED FILE
00001E44                          1793  READED      DS.B    126                     ; MOVEMENTS READ (42 BOXES * 3) 
00001EC2                          1794  INDEXREAD   DS.B    1                       ; INDEX TO TRAVEL READED   
00001EC4                          1795              DS.W    0 
00001EC4                          1796  
00001EC4                          1797  
00001EC4                          1798  
00001EC4                          1799  
00001EC4                          1800  
00001EC4                          1801  
00001EC4                          1802  
00001EC4                          1803  
00001EC4                          1804  
00001EC4                          1805  
00001EC4                          1806  
00001EC4                          1807  
00001EC4                          1808  
00001EC4                          1809  
00001EC4                          1810  
00001EC4                          1811  
00001EC4                          1812  
00001EC4                          1813  
00001EC4                          1814  
00001EC4                          1815  -------------------- end include --------------------
00001EC4                          1816              INCLUDE "SYS/SYSVARS.X68"
00001EC4                          1817  ; ==============================================================================
00001EC4                          1818  ; SYSTEM VARIABLES
00001EC4                          1819  ; ==============================================================================
00001EC4                          1820              
00001EC4                          1821  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00001EC4                          1822  
00001EC4                          1823  KBDVAL      DS.B    1                       ; KEY STATE
00001EC5                          1824  KBDEDGE     DS.B    1                       ; KEY EDGE
00001EC6                          1825  
00001EC6                          1826  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
00001EC6                          1827  
00001EC6                          1828  SCRINTCT   DS.B    1                       ; INTERRUPT COUNTER
00001EC7                          1829  SCRCYCCT   DS.B    1                       ; CYCLE COUNTER
00001EC8                          1830             DS.W    0
00001EC8                          1831  
00001EC8                          1832  -------------------- end include --------------------
00001EC8                          1833  
00001EC8                          1834              END     START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AUTOINIT            1BB6
AUTOPLOT            1CB4
AUTOPLOT:PLOT_NEXT_COL  1CC0
AUTOPLOT:PLOT_NEXT_ROW  1CD0
AUTOPLOT:TXT        1D0E
AUTOUPD             1BD6
AUTOUPD:AUTOLEFT    1C96
AUTOUPD:AUTORIGHT   1C9E
AUTOUPD:CONTINUE    1C1C
AUTOUPD:DONE        1CAE
AUTOUPD:JUMP        1CA2
AUTOUPD:PASS        1BF6
AUTOUPD:PASS1       1C44
AUTOUPD:PASS2       1C5C
BOAPLOT             1800
BOAPLOT:PASS        1830
BOAPLOT:PLAYER1     182C
BOXCOL              1DF8
BOXFCOL             0
BOXINIT             1304
BOXNCOL             7
BOXNROW             6
BOXPCOL             AA0000
BOXPLOT             1318
BOXPLOT:EMPTY       13A4
BOXPOSX             1DFC
BOXPOSY             1DFE
BOXRAD              2D
BOXROW              1DFA
BOXUPD              1316
CHECK_DIAGONALS     1790
CHECK_DIAGONALS:LOOP_DIA  17C4
CHECK_DIAGONALS:PLAYERWINS_DIA  17B2
CHKCOL              1636
CHKCOL:CHECK_NEXT_COL  1642
CHKCOL:CHECK_POSITION_COL  1648
CHKCOL:LOOP_COL     168C
CHKCOL:PLAYERWINS_COL  167A
CHKDIA              16FC
CHKDIA:FINISH_DIA   178A
CHKDIA:LOOP1        1712
CHKDIA:LOOP2        1732
CHKDIA:LOOP_DIAGONALS_ROW1  170E
CHKDIA:LOOP_TO_OTHER_SIDE  170A
CHKDIA:MINUS1       1774
CHKDIA:PASS_DIA     1776
CHKROW              169C
CHKROW:CHECK_NEXT_ROW  16A8
CHKROW:CHECK_POSITION_ROW  16AE
CHKROW:LOOP_ROW     16EC
CHKROW:PLAYERWINS_ROW  16DA
ENDINIT             1A92
ENDPLOT             1AE0
ENDPLOT:DONE        1B0C
ENDPLOT:PLAYER2_WIN  1B06
ENDPLOT:TXT1        1B30
ENDPLOT:TXT2        1B4A
ENDUPD              1AAA
ENDUPD:CONT         1ABE
ENDUPD:DONE         1ADE
FALLING             1E0C
FILE                1000
FILEID              1E40
FILEINIT            1B64
FILEINIT:LOOP1      1B70
GAMINIT             183C
GAMPLOT             1892
GAMPLOT:PLOT_NEXT_COL  189E
GAMPLOT:PLOT_NEXT_ROW  18AE
GAMPLOT:TXT         18EC
GAMUPD              184E
GAMUPD:CONT         1872
GAMUPD:CONTINUE     188C
GAMUPD:DONE         1890
INDEXREAD           1EC2
ISCINIT             18FA
ISCPLOT             1938
ISCPLOT:DONE1       1968
ISCPLOT:DONE2       1980
ISCPLOT:LOOP        195A
ISCPLOT:TXT1        1986
ISCPLOT:TXT2        1990
ISCPLOT:TXT3        19B2
ISCPLOT:TXT4        19E5
ISCPLOT:TXT5        1A02
ISCPLOT:TXT6        1A2B
ISCPLOT:TXT7        1A64
ISCPLOT:TXTLST      1A7A
ISCUPD              1902
ISCUPD:CONT         1916
ISCUPD:DONE         1936
KBDDOWN             28
KBDEDGE             1EC5
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1140
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              114E
KBDUPD:LOOP         1192
KBDUPD:PACK         118E
KBDUPTN             1
KBDVAL              1EC4
PIEFALL             15A8
PIEFALL:END         1606
PIEFALL:PASS        1600
PIEFCOL1            FF
PIEFCOL2            FFFF
PIEFCOL3            3FEB1D
PIEINIT             1400
PIEPCOL1            AA
PIEPCOL2            AAAA
PIEPCOL3            0
PIEPLOT             1520
PIEPLOT:COLOR1      1550
PIEPLOT:COLORWINNER  156C
PIEPLOT:JUMP        1584
PIEPOSX             1E00
PIEPOSY             1E02
PIERAD              23
PIESPEED            3
PIEUPD              143A
PIEUPD:CHKRIGHT     1484
PIEUPD:CHKSPACE     149A
PIEUPD:DONE         14BE
PIEUPD:DONE2        14C4
PIEUPD:PASS1        1468
PIEVELX             1E04
PIEVELY             1E06
PLAINIT             17D0
PLAUPD              17E0
PLAUPD:PLAYER2      17F6
POSX                1E08
POSY                1E0A
PRESSLEFT           14CA
PRESSLEFT:DONELEFT  14F4
PRESSRIGHT          14F6
PRESSRIGHT:DONERIGHT  151E
READED              1E44
READFILE            1B8A
READFILE:LOOP2      1BA8
ROW1                1E0E
ROW2                1E15
ROW3                1E1C
ROW4                1E23
ROW5                1E2A
ROW6                1E31
SCRCYCCT            1EC7
SCRFPS              3C
SCRHEIGH            2D0
SCRINIT             10D4
SCRINTCT            1EC6
SCRINTN             1
SCRPLOT             1118
SCRTIM              1132
SCRUPTN             0
SCRWIDTH            3C0
SNDFALL             1
SNDINIT             104C
SNDINIT:DONE        106A
SNDINIT:LOOP        1058
SNDINIT:SNDFALL     1082
SNDINIT:SNDLIST     10AE
SNDINIT:SNDMOVE     1070
SNDINIT:SNDMUSIC    10A0
SNDINIT:SNDWIN      1094
SNDMOVE             0
SNDMUSIC            3
SNDPLAY             10C2
SNDPLTN             2
SNDWIN              2
STACUR              1E3C
STAEMPTY            1DCA
STAINIT             1D30
STANEXT             1E3E
STANONE             FFFFFFFF
STAPLOT             1D9E
STAPLOT:PLTTBL      1DBA
START               1DCC
START:LOOP          1DD8
START:WINT          1DDE
STAUPD              1D40
STAUPD:DOUPD        1D66
STAUPD:INITBL       1D7E
STAUPD:UPDTBL       1D8E
SYSINIT             1012
TABFCOL             AA0000
TABINIT             13AA
TABINIT:LOOP        13B8
TABPCOL             FF0000
TABPLOT             13C8
TIMER               1E3A
TURN                1E38
UTLCHRWD            8
UTLINIT             119C
UTLPRINT            11B2
UTLPRINT:ENDLOOP    11C4
UTLPRINT:LOOP       11BA
UTLRAND             11E4
UTLRAND:RANDVEC     1202
UTLRNDIX            1302
WINNER              1E39
