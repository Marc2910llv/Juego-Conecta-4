00001DD8 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 16/01/2023 17:21:18

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE : CUATRO EN RAYA
00000000                             3  ; AUTHOR: MARC LLOBERA VILLALONGA
00000000                             4  ;         PERE ROIG VERDERA
00000000                             5  ; ==============================================================================
00000000                             6  
00001000                             7              ORG     $1000
00001000                             8              
00001000                             9              INCLUDE "CONST.X68"
00001000                            10  ; ==============================================================================
00001000                            11  ; GAME CONSTANTS
00001000                            12  ; ==============================================================================
00001000                            13  
00001000                            14  ; --- BOX RELATED CONTANTS ----------------------------------------------------
00001000                            15  
00001000  =00000007                 16  BOXNCOL     EQU     7                       ; NUMBER OF BOXES IN A COLUMN
00001000  =00000006                 17  BOXNROW     EQU     6                       ; NUMBER OF BOXES IN A ROW
00001000  =00AA0000                 18  BOXPCOL     EQU     $00AA0000               ; BOXCONTOUR COLOR
00001000  =00000000                 19  BOXFCOL     EQU     $00000000               ; BOX FILL COLOR
00001000  =0000002D                 20  BOXRAD      EQU     45                      ; BOX RADIUS
00001000                            21  
00001000                            22  ; --- PIECE RELATED CONTANTS ----------------------------------------------------
00001000                            23  
00001000  =000000AA                 24  PIEPCOL1    EQU     $000000AA               ; PIECE CONTOUR COLOR TURN 1
00001000  =000000FF                 25  PIEFCOL1    EQU     $000000FF               ; PIECE FILL COLOR TURN 1
00001000  =0000AAAA                 26  PIEPCOL2    EQU     $0000AAAA               ; PIECE CONTOUR COLOR TURN 2
00001000  =0000FFFF                 27  PIEFCOL2    EQU     $0000FFFF               ; PIECE FILL COLOR TURN 2               
00001000  =00000000                 28  PIEPCOL3    EQU     $00000000               ; PIECE CONTOUR COLOR WIN
00001000  =003FEB1D                 29  PIEFCOL3    EQU     $003FEB1D               ; PIECE FILL COLOR WIN
00001000  =00000023                 30  PIERAD      EQU     35                      ; PIECE RADIUS
00001000                            31  
00001000                            32  ; --- TABLE RELATED CONSTANTS ----------------------------------------------------
00001000                            33  
00001000  =00FF0000                 34  TABPCOL     EQU     $00FF0000               ; TAB CONTOUR COLOR
00001000  =00AA0000                 35  TABFCOL     EQU     $00AA0000               ; TAB FILL COLOR
00001000                            36  
00001000                            37  ; --- STATE RELATED CONSTANTS ----------------------------------------------------
00001000                            38  
00001000  =FFFFFFFF                 39  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001000                            40  
00001000                            41  ; --- FILE CONSTANTS -------------------------------------------------------------
00001000                            42  
00001000= 61 75 74 6F 6D 61 ...     43  FILE        DC.B    'automaticgame.txt',0   ; FILE NAME
00001012                            44              DS.W    0
00001012                            45  
00001012                            46  
00001012                            47  
00001012                            48  
00001012                            49  
00001012                            50  
00001012                            51  
00001012                            52  
00001012                            53  
00001012                            54  
00001012                            55  
00001012                            56  -------------------- end include --------------------
00001012                            57              INCLUDE "SYS/SYSCONST.X68"
00001012                            58  ; ==============================================================================
00001012                            59  ; SYSTEM CONSTANTS
00001012                            60  ; ==============================================================================
00001012                            61  
00001012                            62  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001012                            63  
00001012  =000003C0                 64  SCRWIDTH    EQU     960                     ; SCREEN WIDTH
00001012  =000002D0                 65  SCRHEIGH    EQU     720                     ; SCREEN HEIGHT
00001012  =0000003C                 66  SCRFPS      EQU     60                      ; SCREEN FRAMES PER SECOND
00001012                            67  
00001012                            68  ; --- KEYCODES -----------------------------------------------------------------
00001012                            69  
00001012  =00000025                 70  KBDLEFT     EQU     $25
00001012  =00000026                 71  KBDUP       EQU     $26
00001012  =00000027                 72  KBDRIGHT    EQU     $27
00001012  =00000028                 73  KBDDOWN     EQU     $28
00001012  =00000020                 74  KBDFIRE1    EQU     ' '
00001012  =0000004D                 75  KBDFIRE2    EQU     'M'
00001012  =00000010                 76  KBDFIRE3    EQU     $10
00001012  =00000050                 77  KBDPAUSE    EQU     'P'
00001012                            78  
00001012                            79  ; --- SOUND IDENTIFIERS --------------------------------------------------------
00001012                            80  
00001012  =00000000                 81  SNDMOVE     EQU     0
00001012  =00000001                 82  SNDFALL     EQU     1
00001012  =00000002                 83  SNDWIN      EQU     2
00001012  =00000003                 84  SNDMUSIC    EQU     3
00001012                            85  
00001012                            86  ; --- TRAP NUMBERS -------------------------------------------------------------
00001012                            87  
00001012  =00000000                 88  SCRUPTN     EQU     0                       ; SCREEN UPDATE TRAP NUMBER
00001012  =00000001                 89  KBDUPTN     EQU     1                       ; KEYBOARD UPDATE TRAP NUMBER
00001012  =00000002                 90  SNDPLTN     EQU     2                       ; SOUND PLAY TRAP NUMBER
00001012                            91  
00001012                            92  ; --- INTERRUPT NUMBERS  -------------------------------------------------------
00001012                            93  
00001012  =00000001                 94  SCRINTN     EQU     1                       ; TIMED INTERRUPT NUMBER
00001012                            95  
00001012                            96  
00001012                            97  
00001012                            98  -------------------- end include --------------------
00001012                            99              INCLUDE "SYS/SYSTEM.X68"
00001012                           100  ; ==============================================================================
00001012                           101  ; SYSTEM
00001012                           102  ; ==============================================================================
00001012                           103              
00001012                           104  ; ------------------------------------------------------------------------------
00001012                           105  SYSINIT
00001012                           106  ; INITIALIZE SYSTEM.
00001012                           107  ; INPUT    : NONE
00001012                           108  ; OUTPUT   : NONE
00001012                           109  ; MODIFIES : NONE
00001012                           110  ; ------------------------------------------------------------------------------
00001012                           111              
00001012  21FC 00001118 0080       112              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
0000101A  21FC 0000114E 0084       113              MOVE.L  #KBDUPD,($80+KBDUPTN*4)
00001022  21FC 000010C2 0088       114              MOVE.L  #SNDPLAY,($80+SNDPLTN*4)
0000102A  21FC 00001132 0064       115              MOVE.L  #SCRTIM,($60+SCRINTN*4)
00001032                           116              
00001032  4EB9 000010D4            117              JSR     SCRINIT
00001038  4EB9 00001140            118              JSR     KBDINIT
0000103E  4EB9 0000104C            119              JSR     SNDINIT
00001044                           120              
00001044  40E7                     121              MOVE.W  SR,-(A7)
00001046  0257 D8FF                122              ANDI.W  #$D8FF,(A7)
0000104A  4E73                     123              RTE
0000104C                           124     
0000104C                           125  ; ------------------------------------------------------------------------------
0000104C                           126  SNDINIT
0000104C                           127  ; SOUND SYSTEM INIT
0000104C                           128  ; INPUT    : NONE
0000104C                           129  ; OUTPUT   : NONE
0000104C                           130  ; MODIFIES : NONE
0000104C                           131  ; ------------------------------------------------------------------------------
0000104C                           132              
0000104C  48E7 C0C0                133              MOVEM.L D0-D1/A0-A1,-(A7)            
00001050  4201                     134              CLR.B   D1
00001052  41F9 000010AE            135              LEA     .SNDLIST,A0
00001058  2018                     136  .LOOP       MOVE.L  (A0)+,D0
0000105A  6700 000E                137              BEQ     .DONE
0000105E  2240                     138              MOVE.L  D0,A1
00001060  103C 0047                139              MOVE.B  #71,D0
00001064  4E4F                     140              TRAP    #15
00001066  5201                     141              ADDQ.B  #1,D1
00001068  60EE                     142              BRA     .LOOP
0000106A  4CDF 0303                143  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1      
0000106E  4E75                     144              RTS
00001070= 53 4E 44 2F 4D 4F ...    145  .SNDMOVE    DC.B    'SND/MOVEPIECE.wav',0
00001082= 53 4E 44 2F 50 49 ...    146  .SNDFALL    DC.B    'SND/PIECEFALL.wav',0
00001094= 53 4E 44 2F 57 49 ...    147  .SNDWIN     DC.B    'SND/WIN.wav',0
000010A0= 53 4E 44 2F 4D 55 ...    148  .SNDMUSIC   DC.B    'SND/MUSIC.wav',0
000010AE                           149              DS.W    0
000010AE= 00001070 00001082 ...    150  .SNDLIST    DC.L    .SNDMOVE,.SNDFALL,.SNDWIN,.SNDMUSIC,0
000010C2                           151              
000010C2                           152  ; ------------------------------------------------------------------------------
000010C2                           153  SNDPLAY
000010C2                           154  ; PLAY SOUND
000010C2                           155  ; INPUT    : D7 SOUND ID
000010C2                           156  ; OUTPUT   : NONE
000010C2                           157  ; MODIFIES : NONE
000010C2                           158  ; ------------------------------------------------------------------------------
000010C2                           159              
000010C2  48E7 C000                160              MOVEM.L D0-D1,-(A7)             
000010C6  103C 0048                161              MOVE.B  #72,D0
000010CA  1207                     162              MOVE.B  D7,D1
000010CC  4E4F                     163              TRAP    #15
000010CE  4CDF 0003                164              MOVEM.L (A7)+,D0-D1
000010D2  4E73                     165              RTE
000010D4                           166           
000010D4                           167  ; ------------------------------------------------------------------------------
000010D4                           168  SCRINIT
000010D4                           169  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
000010D4                           170  ; ENABLE DOBLE BUFFER, ENABLE TIMED INTERRUPT.
000010D4                           171  ; INPUT    : NONE
000010D4                           172  ; OUTPUT   : NONE
000010D4                           173  ; MODIFIES : NONE
000010D4                           174  ; ------------------------------------------------------------------------------
000010D4                           175  
000010D4  48E7 F000                176              MOVEM.L D0-D3,-(A7)
000010D8                           177  
000010D8                           178              ; SET SCREEN RESOLUTION
000010D8  103C 0021                179              MOVE.B  #33,D0
000010DC  223C 03C002D0            180              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
000010E2  4E4F                     181              TRAP    #15
000010E4                           182              
000010E4                           183              ; SET WINDOWED MODE
000010E4  7201                     184              MOVE.L  #1,D1
000010E6  4E4F                     185              TRAP    #15
000010E8                           186              
000010E8                           187              ; CLEAR SCREEN
000010E8  103C 000B                188              MOVE.B  #11,D0
000010EC  323C FF00                189              MOVE.W  #$FF00,D1
000010F0  4E4F                     190              TRAP    #15
000010F2                           191              
000010F2                           192              ; ENABLE DOUBLE BUFFER
000010F2  103C 005C                193              MOVE.B #92,D0
000010F6  123C 0011                194              MOVE.B #17,D1
000010FA  4E4F                     195              TRAP #15
000010FC                           196              
000010FC                           197              ; ENABLE TIMED INTERRUPT
000010FC  103C 0020                198              MOVE.B  #32,D0
00001100  123C 0006                199              MOVE.B  #6,D1
00001104  143C 0081                200              MOVE.B  #$80|SCRINTN,D2
00001108  7610                     201              MOVE.L  #1000/SCRFPS,D3
0000110A  4E4F                     202              TRAP    #15
0000110C                           203              
0000110C                           204              ; CLEAR INTERRUPT COUNTER
0000110C  4279 00001ED2            205              CLR.W   (SCRINTCT)
00001112                           206              
00001112  4CDF 000F                207              MOVEM.L (A7)+,D0-D3
00001116                           208              
00001116  4E75                     209              RTS
00001118                           210              
00001118                           211  ; ------------------------------------------------------------------------------
00001118                           212  SCRPLOT
00001118                           213  ; UPDATES DOBLE BUFFER
00001118                           214  ; INPUT    : NONE
00001118                           215  ; OUTPUT   : NONE
00001118                           216  ; MODIFIES : NONE
00001118                           217  ; ------------------------------------------------------------------------------
00001118                           218              
00001118  48A7 C000                219              MOVEM.W D0-D1,-(A7)
0000111C                           220  
0000111C                           221              ; SWITCH BUFFERS
0000111C  103C 005E                222              MOVE.B  #94,D0
00001120  4E4F                     223              TRAP    #15
00001122                           224              
00001122                           225              ; CLEAR HIDDEN BUFFER
00001122  103C 000B                226              MOVE.B  #11,D0
00001126  323C FF00                227              MOVE.W  #$FF00,D1
0000112A  4E4F                     228              TRAP    #15
0000112C                           229              
0000112C  4C9F 0003                230              MOVEM.W (A7)+,D0-D1
00001130                           231              
00001130  4E73                     232              RTE 
00001132                           233  
00001132                           234  ; ------------------------------------------------------------------------------
00001132                           235  SCRTIM
00001132                           236  ; TIMED INTERRUPT SERVICE ROUTINE
00001132                           237  ; INPUT    : NONE
00001132                           238  ; OUTPUT   : NONE
00001132                           239  ; MODIFIES : NONE
00001132                           240  ; ------------------------------------------------------------------------------
00001132                           241  
00001132  5239 00001ED2            242              ADDQ.B  #1,(SCRINTCT)
00001138  5239 00001ED3            243              ADDQ.B  #1,(SCRCYCCT)
0000113E  4E73                     244              RTE
00001140                           245              
00001140                           246  ; ------------------------------------------------------------------------------
00001140                           247  KBDINIT
00001140                           248  ; INIT KEYBOOARD
00001140                           249  ; INPUT    : NONE
00001140                           250  ; OUTPUT   : NONE
00001140                           251  ; MODIFIES : NONE
00001140                           252  ; ------------------------------------------------------------------------------
00001140                           253              
00001140  4239 00001ED0            254              CLR.B   (KBDVAL)
00001146  4239 00001ED1            255              CLR.B   (KBDEDGE)
0000114C  4E75                     256              RTS
0000114E                           257              
0000114E                           258  ; ------------------------------------------------------------------------------
0000114E                           259  KBDUPD
0000114E                           260  ; UPDATE KEYBOARD INFO.  
0000114E                           261  ; 7 -> PAUSE
0000114E                           262  ; 6 -> FIRE 3
0000114E                           263  ; 5 -> FIRE 2
0000114E                           264  ; 4 -> FIRE 1
0000114E                           265  ; 3 -> DOWN
0000114E                           266  ; 2 -> RIGHT
0000114E                           267  ; 1 -> UP
0000114E                           268  ; 0 -> LEFT
0000114E                           269  ; INPUT    : NONE
0000114E                           270  ; OUTPUT   : NONE
0000114E                           271  ; MODIFIES : NONE
0000114E                           272  ; ------------------------------------------------------------------------------
0000114E                           273  
0000114E  48E7 F000                274              MOVEM.L D0-D3,-(A7)
00001152                           275  
00001152                           276              ; READ FIRST PART
00001152  103C 0013                277              MOVE.B  #19,D0
00001156  223C 50104D20            278              MOVE.L  #KBDPAUSE<<24|KBDFIRE3<<16|KBDFIRE2<<8|KBDFIRE1,D1
0000115C  4E4F                     279              TRAP    #15
0000115E                           280              
0000115E                           281              ; CONVERT TO DESIRED FORMAT
0000115E  4EB9 0000118E            282              JSR     .PACK
00001164                           283  
00001164                           284              ; READ SECOND PART
00001164  223C 28272625            285              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
0000116A  4E4F                     286              TRAP    #15
0000116C                           287  
0000116C                           288              ; CONVERT TO DESIRED FORMAT
0000116C  4EB9 0000118E            289              JSR     .PACK
00001172                           290              
00001172                           291              ; COMPUTE KBDEDGE
00001172  1039 00001ED0            292              MOVE.B  (KBDVAL),D0
00001178  4600                     293              NOT.B   D0
0000117A  C002                     294              AND.B   D2,D0
0000117C  13C0 00001ED1            295              MOVE.B  D0,(KBDEDGE)
00001182                           296              
00001182                           297              ; STORE KBDVAL
00001182  13C2 00001ED0            298              MOVE.B  D2,(KBDVAL)
00001188                           299              
00001188  4CDF 000F                300              MOVEM.L (A7)+,D0-D3
0000118C                           301  
0000118C  4E73                     302              RTE
0000118E                           303              
0000118E  363C 0003                304  .PACK       MOVE.W  #3,D3
00001192  E189                     305  .LOOP       LSL.L   #8,D1
00001194  E312                     306              ROXL.B  #1,D2
00001196  51CB FFFA                307              DBRA.W  D3,.LOOP
0000119A  4E75                     308              RTS
0000119C                           309  
0000119C                           310              
0000119C                           311              
0000119C                           312  
0000119C                           313  
0000119C                           314  
0000119C                           315  
0000119C                           316  
0000119C                           317  -------------------- end include --------------------
0000119C                           318              INCLUDE "LIB/UTLCONST.X68"
0000119C                           319  ; ==============================================================================
0000119C                           320  ; UTIL CONSTANTS
0000119C                           321  ; ==============================================================================
0000119C                           322  
0000119C  =00000008                323  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
0000119C  =00000008                324  -------------------- end include --------------------
0000119C                           325              INCLUDE "LIB/UTLCODE.X68"
0000119C                           326  ; =============================================================================
0000119C                           327  ; UTILITY CODE
0000119C                           328  ; =============================================================================
0000119C                           329  
0000119C                           330  ; -----------------------------------------------------------------------------
0000119C                           331  UTLINIT
0000119C                           332  ; INITIALIZES UTILITY CODE
0000119C                           333  ; INPUT    - NONE
0000119C                           334  ; OUTPUT   - NONE
0000119C                           335  ; MODIFIES - NONE
0000119C                           336  ; -----------------------------------------------------------------------------
0000119C  48E7 C000                337              MOVEM.L D0-D1,-(A7)
000011A0  103C 0008                338              MOVE.B  #8,D0
000011A4  4E4F                     339              TRAP    #15
000011A6  13C1 00001302            340              MOVE.B  D1,(UTLRNDIX)
000011AC  4CDF 0003                341              MOVEM.L (A7)+,D0-D1
000011B0  4E75                     342              RTS
000011B2                           343  
000011B2                           344  ; -----------------------------------------------------------------------------
000011B2                           345  UTLPRINT
000011B2                           346  ; PRINT SCREEN CENTERED TEXT
000011B2                           347  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
000011B2                           348  ;            D0.B SCREEN ROW TO PRINT TEXT
000011B2                           349  ; OUTPUT   : D0.B NEXT ROW
000011B2                           350  ; MODIFIES : NONE (ASIDE OF OUTPUT)
000011B2                           351  ; -----------------------------------------------------------------------------
000011B2  48E7 C0C0                352              MOVEM.L D0-D1/A0-A1,-(A7)
000011B6  4201                     353              CLR.B   D1
000011B8  2248                     354              MOVE.L  A0,A1
000011BA  4A18                     355  .LOOP       TST.B   (A0)+
000011BC  6700 0006                356              BEQ     .ENDLOOP
000011C0  5201                     357              ADDQ.B  #1,D1
000011C2  60F6                     358              BRA     .LOOP
000011C4  E209                     359  .ENDLOOP    LSR.B   #1,D1
000011C6  0401 003C                360              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
000011CA  4401                     361              NEG.B   D1
000011CC  E141                     362              ASL.W   #8,D1
000011CE  8240                     363              OR.W    D0,D1
000011D0  103C 000B                364              MOVE.B  #11,D0
000011D4  4E4F                     365              TRAP    #15
000011D6  103C 000D                366              MOVE.B  #13,D0
000011DA  4E4F                     367              TRAP    #15
000011DC  4CDF 0303                368              MOVEM.L (A7)+,D0-D1/A0-A1
000011E0  5400                     369              ADDQ.B  #2,D0
000011E2  4E75                     370              RTS
000011E4                           371              
000011E4                           372              
000011E4                           373  
000011E4                           374  
000011E4                           375              ; (SCRWIDTH/UTLCHRWD)/2 - D1/2
000011E4                           376  
000011E4                           377  
000011E4                           378  ; -----------------------------------------------------------------------------
000011E4                           379  UTLRAND
000011E4                           380  ; PROVIDES A PSEUDO-RANDOM BYTE
000011E4                           381  ; INPUT    - NONE
000011E4                           382  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
000011E4                           383  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000011E4                           384  ; -----------------------------------------------------------------------------
000011E4  2F08                     385              MOVE.L  A0,-(A7)
000011E6  41F9 00001202            386              LEA     .RANDVEC,A0
000011EC  4280                     387              CLR.L   D0
000011EE  1039 00001302            388              MOVE.B  (UTLRNDIX),D0
000011F4  1030 0800                389              MOVE.B  (A0,D0.L),D0
000011F8  5239 00001302            390              ADDQ.B  #1,(UTLRNDIX)
000011FE  205F                     391              MOVE.L  (A7)+,A0
00001200  4E75                     392              RTS
00001202                           393  
00001202                           394  
00001202= A2 EE 9A 0C F5 24 ...    395  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
0000120A= 2A A3 51 26 E0 AC ...    396              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001212= 75 51 CA FD 33 EB ...    397              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
0000121A= 60 CC E7 B8 9A EB ...    398              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001222= 1D 76 B5 95 B0 89 ...    399              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
0000122A= 39 15 48 C9 6E CA ...    400              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001232= 43 E7 E2 7C 37 25 ...    401              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
0000123A= E9 94 CE E9 E4 52 ...    402              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001242= 37 6D 9A 84 A2 28 ...    403              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
0000124A= 19 E2 C6 77 80 D4 ...    404              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001252= 0A 5A 32 67 33 C2 ...    405              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
0000125A= 59 80 DC 0E 57 FC ...    406              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001262= 8A AB BC F7 07 4D ...    407              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
0000126A= EF D5 77 6E 1E BB ...    408              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001272= D6 E0 2A 8F BD 28 ...    409              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
0000127A= 13 4F 66 EC 0A 64 ...    410              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001282= 56 52 9A 16 9B 90 ...    411              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
0000128A= 06 8A A4 F7 01 DA ...    412              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001292= F2 E7 77 28 B1 76 ...    413              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
0000129A= A4 42 E3 81 B1 67 ...    414              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
000012A2= BF CE FA 16 BF 38 ...    415              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
000012AA= D1 8B 50 0C 5F 49 ...    416              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
000012B2= DE 4C 14 A2 40 DC ...    417              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
000012BA= B6 9B 0A 38 5D AB ...    418              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
000012C2= E2 1B DD 75 15 82 ...    419              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
000012CA= 8A 26 51 30 9F 47 ...    420              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
000012D2= 1E 8A BB 71 C6 6E ...    421              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
000012DA= 9F 47 E5 34 94 27 ...    422              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
000012E2= 7D 06 D6 BA 30 0F ...    423              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
000012EA= EC 7F 7E 03 CF 2D ...    424              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
000012F2= 94 5B 23 F2 8B CD ...    425              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
000012FA= 74 33 EC B9 0F D5 ...    426              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001302                           427  
00001302                           428  
00001302                           429  
00001302                           430  -------------------- end include --------------------
00001302                           431              INCLUDE "LIB/UTLVARS.X68"
00001302                           432  ; =============================================================================
00001302                           433  ; UTILITY VARIABLES
00001302                           434  ; =============================================================================
00001302                           435  
00001302                           436  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001304                           437              DS.W    0
00001304                           438  -------------------- end include --------------------
00001304                           439              INCLUDE "BOX.X68"
00001304                           440  ; ==============================================================================
00001304                           441  ; BOX MANAGEMENT
00001304                           442  ; ==============================================================================
00001304                           443              
00001304                           444  ; ------------------------------------------------------------------------------
00001304                           445  BOXINIT
00001304                           446  ; INITIALIZE BOX.
00001304                           447  ; INPUT    : NONE 
00001304                           448  ; OUTPUT   : NONE
00001304                           449  ; MODIFIES : NONE
00001304                           450  ; ------------------------------------------------------------------------------
00001304                           451              
00001304  33FC 0083 00001E08       452              MOVE.W  #BOXRAD*2+41,(BOXPOSX)
0000130C  33FC 0064 00001E0A       453              MOVE.W  #BOXRAD*2+10,(BOXPOSY)
00001314                           454              
00001314  4E75                     455              RTS
00001316                           456              
00001316                           457  ; ------------------------------------------------------------------------------
00001316                           458  BOXPLOT
00001316                           459  ; PLOT THE BOX.
00001316                           460  ; INPUT    : NONE 
00001316                           461  ; OUTPUT   : NONE
00001316                           462  ; MODIFIES : NONE
00001316                           463  ; ------------------------------------------------------------------------------
00001316  48E7 FE40                464              MOVEM.L D0-D6/A1,-(A7)
0000131A                           465  
0000131A                           466              ; SET PEN COLOR
0000131A  103C 0050                467              MOVE.B  #80,D0
0000131E  223C 00AA0000            468              MOVE.L  #BOXPCOL,D1
00001324  4E4F                     469              TRAP    #15
00001326                           470              
00001326                           471              ; SET FILL COLOR
00001326  103C 0051                472              MOVE.B  #81,D0
0000132A  7200                     473              MOVE.L  #BOXFCOL,D1                                                                     
0000132C  4E4F                     474              TRAP    #15                                                                             
0000132E                           475              
0000132E                           476              ; DEFINE COORDINATES
0000132E  3239 00001E08            477              MOVE.W  (BOXPOSX),D1
00001334  3439 00001E04            478              MOVE.W  (BOXCOL),D2
0000133A  C3C2                     479              MULS.W  D2,D1
0000133C  0441 005A                480              SUB.W   #BOXRAD*2,D1
00001340                           481              
00001340  3439 00001E0A            482              MOVE.W  (BOXPOSY),D2
00001346  3639 00001E06            483              MOVE.W  (BOXROW),D3
0000134C  C5C3                     484              MULS.W  D3,D2
0000134E  0642 005A                485              ADD.W   #PIERAD*2+20,D2
00001352  0442 0055                486              SUB.W   #BOXRAD*2-5,D2
00001356                           487              
00001356  3601                     488              MOVE.W  D1,D3
00001358  0643 005A                489              ADD.W   #BOXRAD*2,D3
0000135C                           490              
0000135C  3802                     491              MOVE.W  D2,D4
0000135E  0644 005A                492              ADD.W   #BOXRAD*2,D4
00001362                           493              
00001362                           494              ; DRAW CIRCLE
00001362  103C 0058                495              MOVE.B  #88,D0
00001366  4E4F                     496              TRAP    #15
00001368                           497              
00001368                           498              ; CHECK IF THERE IS A PIECE INSIDE
00001368  43F9 00001E1A            499              LEA     ROW1,A1
0000136E  3639 00001E04            500              MOVE.W  (BOXCOL),D3
00001374  3839 00001E06            501              MOVE.W  (BOXROW),D4
0000137A  5343                     502              SUBQ.W  #1,D3
0000137C  5344                     503              SUBQ.W  #1,D4
0000137E  D2C3                     504              ADD.W   D3,A1   
00001380  C9FC 0007                505              MULS.W  #7,D4
00001384  D2C4                     506              ADD.W   D4,A1 
00001386  0C11 0000                507              CMP.B   #0,(A1)
0000138A  6700 0016                508              BEQ     .EMPTY
0000138E                           509              
0000138E                           510              ; PLOT THE PIECE WITH THE RIGHT COLOR
0000138E  3A01                     511              MOVE.W  D1,D5
00001390  0645 002D                512              ADD.W   #BOXRAD,D5
00001394  3C02                     513              MOVE.W  D2,D6
00001396  0646 002D                514              ADD.W   #BOXRAD,D6
0000139A  1011                     515              MOVE.B  (A1),D0
0000139C  4EB9 00001522            516              JSR     PIEPLOT
000013A2                           517              
000013A2  4CDF 027F                518  .EMPTY      MOVEM.L (A7)+,D0-D6/A1
000013A6                           519  
000013A6  4E75                     520              RTS
000013A8                           521  
000013A8                           522  
000013A8                           523  
000013A8                           524  
000013A8                           525  
000013A8                           526  
000013A8                           527  
000013A8                           528  
000013A8                           529  
000013A8                           530  
000013A8                           531  
000013A8                           532  -------------------- end include --------------------
000013A8                           533              INCLUDE "TABLE.X68"
000013A8                           534  ; ==============================================================================
000013A8                           535  ; TABLE MANAGEMENT
000013A8                           536  ; ==============================================================================
000013A8                           537              
000013A8                           538  ; ------------------------------------------------------------------------------
000013A8                           539  TABINIT
000013A8                           540  ; INITIALIZE TABLE.
000013A8                           541  ; INPUT    : NONE 
000013A8                           542  ; OUTPUT   : NONE
000013A8                           543  ; MODIFIES : NONE
000013A8                           544  ; ------------------------------------------------------------------------------
000013A8                           545  
000013A8  48E7 8040                546              MOVEM.L D0/A1,-(A7)
000013AC                           547  
000013AC                           548              ;INITIALICE ROWS VALUES
000013AC  303C 0029                549              MOVE.W  #6*7-1,D0
000013B0  43F9 00001E1A            550              LEA.L   ROW1,A1
000013B6                           551  .LOOP       
000013B6  12BC 0000                552              MOVE.B  #0,(A1)
000013BA  5289                     553              ADD.L  #1,A1
000013BC  51C8 FFF8                554              DBRA    D0,.LOOP
000013C0                           555  
000013C0  4CDF 0201                556              MOVEM.L (A7)+,D0/A1
000013C4                           557  
000013C4  4E75                     558              RTS
000013C6                           559              
000013C6                           560  ; ------------------------------------------------------------------------------
000013C6                           561  TABPLOT
000013C6                           562  ; PLOT THE TABLE.
000013C6                           563  ; INPUT    : NONE 
000013C6                           564  ; OUTPUT   : NONE
000013C6                           565  ; MODIFIES : NONE
000013C6                           566  ; ------------------------------------------------------------------------------
000013C6                           567  
000013C6  48E7 F800                568              MOVEM.L D0-D4,-(A7)
000013CA                           569  
000013CA                           570              ; SET CONTOUR COLOR
000013CA  103C 0050                571              MOVE.B  #80,D0
000013CE  223C 00FF0000            572              MOVE.L  #TABPCOL,D1
000013D4  4E4F                     573              TRAP    #15
000013D6                           574              
000013D6                           575              ; SET FILL COLOR
000013D6  103C 0051                576              MOVE.B  #81,D0
000013DA  223C 00AA0000            577              MOVE.L  #TABFCOL,D1
000013E0  4E4F                     578              TRAP    #15
000013E2                           579              
000013E2                           580              ; DEFINE COORDINATES
000013E2  323C 0005                581              MOVE.W  #5,D1
000013E6  343C 005A                582              MOVE.W  #PIERAD*2+20,D2
000013EA  363C 03BB                583              MOVE.W  #SCRWIDTH-5,D3
000013EE  383C 02CB                584              MOVE.W  #SCRHEIGH-5,D4
000013F2                           585              
000013F2                           586              ; DRAW RECTANGLE
000013F2  103C 0057                587              MOVE.B  #87,D0
000013F6  4E4F                     588              TRAP    #15
000013F8                           589              
000013F8  4CDF 001F                590              MOVEM.L (A7)+,D0-D4
000013FC                           591  
000013FC  4E75                     592              RTS
000013FE                           593  
000013FE                           594  
000013FE                           595  
000013FE                           596  
000013FE                           597  
000013FE                           598  
000013FE                           599  
000013FE                           600  
000013FE                           601  
000013FE                           602  
000013FE                           603  
000013FE                           604  
000013FE                           605  
000013FE                           606  
000013FE                           607  
000013FE                           608  
000013FE                           609  -------------------- end include --------------------
000013FE                           610              INCLUDE "PIECE.X68"
000013FE                           611  ; ==============================================================================
000013FE                           612  ; PIECE MANAGEMENT
000013FE                           613  ; ==============================================================================
000013FE                           614              
000013FE                           615  ; ------------------------------------------------------------------------------
000013FE                           616  PIEINIT
000013FE                           617  ; INITIALIZE THE PIECE.
000013FE                           618  ; INPUT    : NONE 
000013FE                           619  ; OUTPUT   : NONE
000013FE                           620  ; MODIFIES : NONE
000013FE                           621  ; ------------------------------------------------------------------------------
000013FE                           622  
000013FE  33FC 01DF 00001E0C       623              MOVE.W  #SCRWIDTH/2-1,(PIEPOSX)
00001406  33FC 002D 00001E0E       624              MOVE.W  #PIERAD+10,(PIEPOSY)
0000140E                           625              
0000140E  33F9 00001E08 00001E10   626              MOVE.W  (BOXPOSX),(PIEVELX)
00001418  33FC 0064 00001E12       627              MOVE.W  #100,(PIEVELY)
00001420                           628              
00001420  33FC 0003 00001E14       629              MOVE.W  #3,(POSX)               ; IN THE MIDDLE
00001428  33FC FFFF 00001E16       630              MOVE.W  #-1,(POSY)              ; OUTSIDE THE MATRIX
00001430                           631              
00001430  4239 00001E18            632              CLR.B   (FALLING)
00001436                           633              
00001436  4E75                     634              RTS
00001438                           635              
00001438                           636  ; ------------------------------------------------------------------------------
00001438                           637  PIEUPD
00001438                           638  ; UPDATE THE PIECE.
00001438                           639  ; INPUT    : NONE 
00001438                           640  ; OUTPUT   : NONE
00001438                           641  ; MODIFIES : NONE
00001438                           642  ; ------------------------------------------------------------------------------
00001438                           643              
00001438  48A7 F000                644              MOVEM.W  D0-D3,-(A7)
0000143C                           645              
0000143C                           646              ; CHECK IF THE PIECE STILL HAVE TO FALL
0000143C  0C39 0000 00001E18       647              CMP.B   #0,(FALLING)
00001444  6700 0020                648              BEQ     .PASS1
00001448  1639 00001ED3            649              MOVE.B  (SCRCYCCT),D3
0000144E  C63C 00F0                650              AND.B   #$F0,D3
00001452  B639 00001ED3            651              CMP.B   (SCRCYCCT),D3
00001458  6600 0068                652              BNE     .DONE2
0000145C  4EB9 000015AA            653              JSR     PIEFALL
00001462  6000 005E                654              BRA     .DONE2
00001466                           655              
00001466                           656  .PASS1             
00001466                           657              ; UPDATE X POSITION
00001466  3039 00001E0C            658              MOVE.W  (PIEPOSX),D0
0000146C                           659              
0000146C                           660              ; CHECK LEFT ARROW KEY
0000146C  0839 0000 00001ED1       661              BTST.B  #0,(KBDEDGE)
00001474  6700 000C                662              BEQ     .CHKRIGHT
00001478  4EB9 000014C8            663              JSR     PRESSLEFT
0000147E  6000 003C                664              BRA     .DONE
00001482                           665              
00001482                           666              ;CHECK RIGHT ARROW KEY
00001482  0839 0002 00001ED1       667  .CHKRIGHT   BTST.B  #2,(KBDEDGE)
0000148A  6700 000C                668              BEQ     .CHKSPACE
0000148E  4EB9 000014F4            669              JSR     PRESSRIGHT
00001494  6000 0026                670              BRA     .DONE
00001498                           671              
00001498                           672              ; CHECK SPACE KEY
00001498  0839 0004 00001ED1       673  .CHKSPACE   BTST.B  #4,(KBDEDGE)
000014A0  6700 0020                674              BEQ     .DONE2
000014A4  1E3C 0001                675              MOVE.B  #SNDFALL,D7
000014A8  4E42                     676              TRAP    #SNDPLTN
000014AA  13FC 0001 00001E18       677              MOVE.B  #1,(FALLING)
000014B2  4EB9 000015AA            678              JSR     PIEFALL
000014B8  6000 0008                679              BRA     .DONE2
000014BC                           680  
000014BC                           681              ; UPDATE VARIABLE
000014BC  33C0 00001E0C            682  .DONE       MOVE.W  D0,(PIEPOSX) 
000014C2                           683  
000014C2  4C9F 000F                684  .DONE2      MOVEM.W  (A7)+,D0-D3             
000014C6                           685  
000014C6  4E75                     686              RTS
000014C8                           687  
000014C8                           688  PRESSLEFT   ; LEFT ARROW PRESSED
000014C8  1E3C 0000                689              MOVE.B  #SNDMOVE,D7
000014CC  4E42                     690              TRAP    #SNDPLTN
000014CE  9079 00001E10            691              SUB.W   (PIEVELX),D0
000014D4  5379 00001E14            692              SUBQ.W  #1,(POSX)
000014DA                           693              
000014DA                           694              ; CHECK COLISIONS LEFT
000014DA  3239 00001E10            695              MOVE.W  (PIEVELX),D1
000014E0  0441 002C                696              SUB.W   #BOXRAD-1,D1
000014E4  B041                     697              CMP.W   D1,D0
000014E6  6C00 000A                698              BGE     .DONELEFT
000014EA  3001                     699              MOVE.W  D1,D0
000014EC  4279 00001E14            700              CLR.W   (POSX)
000014F2  4E75                     701  .DONELEFT   RTS   
000014F4                           702  
000014F4                           703  PRESSRIGHT  ; RIGHT ARROW PRESSED
000014F4  1E3C 0000                704              MOVE.B  #SNDMOVE,D7
000014F8  4E42                     705              TRAP    #SNDPLTN
000014FA  D079 00001E10            706              ADD.W   (PIEVELX),D0
00001500  5279 00001E14            707              ADDQ.W  #1,(POSX)
00001506                           708              
00001506                           709              ; CHECK COLISIONS RIGHT
00001506  323C 03EC                710              MOVE.W  #SCRWIDTH+BOXRAD-1,D1
0000150A  9279 00001E10            711              SUB.W   (PIEVELX),D1
00001510  B041                     712              CMP.W   D1,D0
00001512  6F00 000C                713              BLE     .DONERIGHT
00001516  3001                     714              MOVE.W  D1,D0
00001518  33FC 0006 00001E14       715              MOVE.W  #6,(POSX)
00001520  4E75                     716  .DONERIGHT  RTS            
00001522                           717  
00001522                           718  ; ------------------------------------------------------------------------------
00001522                           719  PIEPLOT
00001522                           720  ; PLOT THE PIECE.
00001522                           721  ; INPUT    : D5.W AS COORDINATE X OF PIECE, D6.W AS COORDINATE Y OF PIECE,
00001522                           722  ;            D0.B INDICATES COLOR OF THE PIECE
00001522                           723  ; OUTPUT   : NONE
00001522                           724  ; MODIFIES : NONE
00001522                           725  ; ------------------------------------------------------------------------------
00001522  48E7 7800                726              MOVEM.L D1-D4,-(A7)
00001526                           727  
00001526  B03C 0001                728              CMP.B   #1,D0
0000152A  6700 0026                729              BEQ     .COLOR1
0000152E  B03C 0015                730              CMP.B   #21,D0                  ; CHECK IF ITS WIN TO PLOT GREEN
00001532  6700 003A                731              BEQ     .COLORWINNER
00001536                           732              
00001536                           733              ; SET PEN COLOR
00001536  103C 0050                734              MOVE.B  #80,D0
0000153A  223C 0000AAAA            735              MOVE.L  #PIEPCOL2,D1
00001540  4E4F                     736              TRAP    #15
00001542                           737              
00001542                           738              ; SET FILL COLOR
00001542  103C 0051                739              MOVE.B  #81,D0
00001546  223C 0000FFFF            740              MOVE.L  #PIEFCOL2,D1
0000154C  4E4F                     741              TRAP    #15
0000154E                           742              
0000154E  6000 0036                743              BRA     .JUMP
00001552                           744              
00001552                           745  .COLOR1            
00001552                           746              ; SET PEN COLOR
00001552  103C 0050                747              MOVE.B  #80,D0
00001556  223C 000000AA            748              MOVE.L  #PIEPCOL1,D1
0000155C  4E4F                     749              TRAP    #15
0000155E                           750              
0000155E                           751              ; SET FILL COLOR
0000155E  103C 0051                752              MOVE.B  #81,D0
00001562  223C 000000FF            753              MOVE.L  #PIEFCOL1,D1
00001568  4E4F                     754              TRAP    #15
0000156A                           755              
0000156A  6000 001A                756              BRA     .JUMP
0000156E                           757  
0000156E                           758  .COLORWINNER
0000156E                           759              ; SET PEN COLOR
0000156E  103C 0050                760              MOVE.B  #80,D0
00001572  7200                     761              MOVE.L  #PIEPCOL3,D1
00001574  4E4F                     762              TRAP    #15
00001576                           763              
00001576                           764              ; SET FILL COLOR
00001576  103C 0051                765              MOVE.B  #81,D0
0000157A  223C 003FEB1D            766              MOVE.L  #PIEFCOL3,D1
00001580  4E4F                     767              TRAP    #15
00001582                           768              
00001582  6000 0002                769              BRA     .JUMP
00001586                           770  
00001586                           771  .JUMP            
00001586                           772              ; DEFINE COORDINATES
00001586  3205                     773              MOVE.W  D5,D1
00001588  0441 0023                774              SUB.W   #PIERAD,D1
0000158C                           775              
0000158C  3406                     776              MOVE.W  D6,D2
0000158E  0442 0023                777              SUB.W   #PIERAD,D2
00001592                           778              
00001592  3605                     779              MOVE.W  D5,D3
00001594  0643 0023                780              ADD.W   #PIERAD,D3
00001598                           781              
00001598  3806                     782              MOVE.W  D6,D4
0000159A  0644 0023                783              ADD.W   #PIERAD,D4
0000159E                           784              
0000159E                           785              ; DRAW PIECE
0000159E  103C 0058                786              MOVE.B  #88,D0
000015A2  4E4F                     787              TRAP    #15
000015A4                           788              
000015A4  4CDF 001E                789              MOVEM.L (A7)+,D1-D4
000015A8                           790  
000015A8  4E75                     791              RTS
000015AA                           792              
000015AA                           793  ; ------------------------------------------------------------------------------
000015AA                           794  PIEFALL
000015AA                           795  ; LET A PIECE FALL ONE POSITION IN A COLUMN
000015AA                           796  ; INPUT    : NONE
000015AA                           797  ; OUTPUT   : NONE
000015AA                           798  ; MODIFIES : NONE
000015AA                           799  ; ------------------------------------------------------------------------------
000015AA                           800              
000015AA  48E7 C040                801              MOVEM.L D0-D1/A1,-(A7)
000015AE                           802              
000015AE  4280                     803              CLR.L   D0
000015B0  43F9 00001E1A            804              LEA.L   ROW1,A1
000015B6  5279 00001E16            805              ADDQ.W  #1,(POSY)
000015BC  3039 00001E16            806              MOVE.W  (POSY),D0
000015C2  C1FC 0007                807              MULS.W  #7,D0
000015C6  D2C0                     808              ADD.W   D0,A1
000015C8  3039 00001E14            809              MOVE.W  (POSX),D0
000015CE  D2C0                     810              ADD.W   D0,A1
000015D0                           811              
000015D0                           812              ; CHECK IF THE BOTTOM POSITION IS THE FINAL
000015D0  0C79 0006 00001E16       813              CMP.W   #6,(POSY)
000015D8  6700 002E                814              BEQ     .END 
000015DC                           815              
000015DC                           816              ; CHECK IF THE BOTTOM POSITION HVAE OTHER PIECE
000015DC  0C11 0000                817              CMP.B   #0,(A1)
000015E0  6600 0026                818              BNE     .END
000015E4                           819              
000015E4                           820              ; MOVE THE PIECE 1 POSITION DOWN
000015E4  3239 00001E12            821              MOVE.W  (PIEVELY),D1
000015EA  D379 00001E0E            822              ADD.W   D1,(PIEPOSY)
000015F0  0C79 0000 00001E16       823              CMP.W   #0,(POSY)
000015F8  6600 0008                824              BNE     .PASS
000015FC  5A79 00001E0E            825              ADDQ.W  #5,(PIEPOSY) 
00001602  4CDF 0203                826  .PASS       MOVEM.L (A7)+,D0-D1/A1
00001606                           827  
00001606  4E75                     828              RTS
00001608                           829  
00001608                           830              ; CAN'T FALL MORE
00001608  5F89                     831  .END        SUBQ.L  #7,A1
0000160A  5379 00001E16            832              SUBQ.W  #1,(POSY)
00001610  12B9 00001E44            833              MOVE.B  (TURN),(A1)
00001616  4EB9 00001638            834              JSR     CHKCOL                  ;CHECK 4 CONNECT IN COLUMNS
0000161C  4EB9 0000169E            835              JSR     CHKROW                  ;CHECK 4 CONNECT IN ROWS
00001622  4EB9 000016FE            836              JSR     CHKDIA                  ;CHECK 4 CONNECT IN DIAGONALS
00001628  4EB9 000017E2            837              JSR     PLAUPD
0000162E  4EB8 13FE                838              JSR     PIEINIT
00001632                           839              
00001632  4CDF 0203                840              MOVEM.L (A7)+,D0-D1/A1
00001636                           841  
00001636  4E75                     842              RTS
00001638                           843              
00001638                           844  ; ------------------------------------------------------------------------------
00001638                           845  CHKCOL
00001638                           846  ; CHECK IF SOME COLUMN HAVE 4 PIECES CONNECTED
00001638                           847  ; INPUT    : NONE
00001638                           848  ; OUTPUT   : NONE
00001638                           849  ; MODIFIES : NONE
00001638                           850  ; ------------------------------------------------------------------------------
00001638                           851  
00001638  48E7 E070                852              MOVEM.L D0-D2/A1-A3,-(A7)
0000163C                           853              
0000163C  43F9 00001E1A            854              LEA.L   ROW1,A1
00001642  7006                     855              MOVE.L  #BOXNCOL-1,D0
00001644                           856  .CHECK_NEXT_COL
00001644  2449                     857              MOVE.L  A1,A2
00001646  5289                     858              ADD.L   #1,A1
00001648  7202                     859              MOVE.L  #BOXNROW-3-1,D1
0000164A                           860             
0000164A                           861              ; ONLY 3 POSITIONS OF THE COLUMN CAN CONNECT 4 PIECES 
0000164A                           862  .CHECK_POSITION_COL                         
0000164A  264A                     863              MOVE.L  A2,A3
0000164C  5E8A                     864              ADD.L   #7,A2
0000164E                           865              
0000164E  4282                     866              CLR.L   D2
00001650  1413                     867              MOVE.B  (A3),D2
00001652  5E8B                     868              ADD.L   #7,A3
00001654  D413                     869              ADD.B   (A3),D2
00001656  5E8B                     870              ADD.L   #7,A3
00001658  D413                     871              ADD.B   (A3),D2
0000165A  5E8B                     872              ADD.L   #7,A3
0000165C  D413                     873              ADD.B   (A3),D2
0000165E                           874              
0000165E  B43C 0004                875              CMP.B   #4,D2
00001662  6700 0018                876              BEQ     .PLAYERWINS_COL
00001666  B43C 0014                877              CMP.B   #20,D2
0000166A  6700 0010                878              BEQ     .PLAYERWINS_COL
0000166E                           879              
0000166E  51C9 FFDA                880              DBRA    D1,.CHECK_POSITION_COL
00001672                           881              
00001672  51C8 FFD0                882              DBRA    D0,.CHECK_NEXT_COL
00001676                           883              
00001676  4CDF 0E07                884              MOVEM.L (A7)+,D0-D2/A1-A3
0000167A                           885              
0000167A  4E75                     886              RTS
0000167C                           887              
0000167C                           888              ; THERE IS 4 PIECES CONNECTED
0000167C                           889  .PLAYERWINS_COL
0000167C  13F9 00001E44 00001E45   890              MOVE.B  (TURN),(WINNER)
00001686  1E3C 0002                891              MOVE.B  #SNDWIN,D7
0000168A  4E42                     892              TRAP    #SNDPLTN  
0000168C                           893  
0000168C  7003                     894              MOVE.L  #3,D0
0000168E                           895  .LOOP_COL
0000168E  16BC 0015                896              MOVE.B  #21,(A3)
00001692  5F8B                     897              SUB.L   #7,A3
00001694  51C8 FFF8                898              DBRA    D0,.LOOP_COL
00001698                           899                      
00001698  4CDF 0E07                900              MOVEM.L (A7)+,D0-D2/A1-A3
0000169C  4E75                     901              RTS
0000169E                           902  
0000169E                           903  ; ------------------------------------------------------------------------------
0000169E                           904  CHKROW
0000169E                           905  ; CHECK IF SOME ROW HAVE 4 PIECES CONNECTED
0000169E                           906  ; INPUT    : NONE
0000169E                           907  ; OUTPUT   : NONE
0000169E                           908  ; MODIFIES : NONE
0000169E                           909  ; ------------------------------------------------------------------------------
0000169E                           910  
0000169E  48E7 E070                911              MOVEM.L D0-D2/A1-A3,-(A7)
000016A2                           912              
000016A2  43F9 00001E1A            913              LEA.L   ROW1,A1
000016A8  7005                     914              MOVE.L  #BOXNROW-1,D0
000016AA                           915  .CHECK_NEXT_ROW
000016AA  2449                     916              MOVE.L  A1,A2
000016AC  5E89                     917              ADD.L   #7,A1
000016AE  7203                     918              MOVE.L  #BOXNCOL-3-1,D1
000016B0                           919              
000016B0                           920              ; ONLY 4 POSITIONS OF THE ROW CAN CONNECT 4 PIECES
000016B0                           921  .CHECK_POSITION_ROW
000016B0  264A                     922              MOVE.L  A2,A3
000016B2  528A                     923              ADD.L   #1,A2
000016B4                           924              
000016B4  4282                     925              CLR.L   D2
000016B6  141B                     926              MOVE.B   (A3)+,D2
000016B8  D41B                     927              ADD.B   (A3)+,D2
000016BA  D41B                     928              ADD.B   (A3)+,D2
000016BC  D413                     929              ADD.B   (A3),D2
000016BE                           930              
000016BE  B43C 0004                931              CMP.B   #4,D2
000016C2  6700 0018                932              BEQ     .PLAYERWINS_ROW
000016C6  B43C 0014                933              CMP.B   #20,D2
000016CA  6700 0010                934              BEQ     .PLAYERWINS_ROW
000016CE                           935              
000016CE  51C9 FFE0                936              DBRA    D1,.CHECK_POSITION_ROW
000016D2                           937              
000016D2  51C8 FFD6                938              DBRA    D0,.CHECK_NEXT_ROW
000016D6                           939              
000016D6  4CDF 0E07                940              MOVEM.L (A7)+,D0-D2/A1-A3
000016DA                           941              
000016DA  4E75                     942              RTS
000016DC                           943  
000016DC                           944              ; THERE IS 4 PIECES CONNECTED
000016DC                           945  .PLAYERWINS_ROW
000016DC  13F9 00001E44 00001E45   946              MOVE.B  (TURN),(WINNER)
000016E6  1E3C 0002                947              MOVE.B  #SNDWIN,D7
000016EA  4E42                     948              TRAP    #SNDPLTN
000016EC                           949              
000016EC  7003                     950              MOVE.L  #3,D0
000016EE                           951  .LOOP_ROW
000016EE  16BC 0015                952              MOVE.B  #21,(A3)
000016F2  538B                     953              SUB.L   #1,A3
000016F4  51C8 FFF8                954              DBRA    D0,.LOOP_ROW
000016F8                           955              
000016F8  4CDF 0E07                956              MOVEM.L (A7)+,D0-D2/A1-A3
000016FC  4E75                     957              RTS
000016FE                           958  
000016FE                           959  ; ------------------------------------------------------------------------------
000016FE                           960  CHKDIA
000016FE                           961  ; CHECK IF SOME DIAGONAL HAVE 4 PIECES CONNECTED
000016FE                           962  ; INPUT    : NONE
000016FE                           963  ; OUTPUT   : NONE
000016FE                           964  ; MODIFIES : NONE
000016FE                           965  ; ------------------------------------------------------------------------------
000016FE                           966  
000016FE  48E7 FE70                967              MOVEM.L D0-D6/A1-A3,-(A7)
00001702                           968              
00001702  43F9 00001E1A            969              LEA.L   ROW1,A1
00001708                           970             
00001708  7C08                     971              MOVE.L  #8,D6
0000170A  7201                     972              MOVE.L  #1,D1
0000170C                           973  .LOOP_TO_OTHER_SIDE 
0000170C                           974             
0000170C  7A07                     975              MOVE.L  #7,D5
0000170E  7401                     976              MOVE.L  #1,D2
00001710                           977  .LOOP_DIAGONALS_ROW1
00001710                           978  
00001710  2449                     979              MOVE.L  A1,A2
00001712                           980              ;DIAGONAL OF (0,0) AND (6,0) / (1,0) AND (5,0)            
00001712  7602                     981              MOVE.L  #2,D3
00001714                           982  .LOOP1
00001714  264A                     983              MOVE.L  A2,A3
00001716  D5C6                     984              ADD.L   D6,A2
00001718                           985              
00001718  4EB9 00001792            986              JSR     CHECK_DIAGONALS
0000171E  0C39 0000 00001E45       987              CMP.B   #0,(WINNER)
00001726  6600 0064                988              BNE     .FINISH_DIA
0000172A                           989             
0000172A  51CB FFE8                990              DBRA    D3,.LOOP1
0000172E                           991              
0000172E                           992              ;DIAGONAL OF (0,1) AND (6,1) / (2,0) AND (4,0)
0000172E  2449                     993              MOVE.L  A1,A2
00001730  D5C5                     994              ADD.L   D5,A2
00001732                           995              
00001732  7601                     996              MOVE.L  #1,D3
00001734                           997  .LOOP2
00001734  264A                     998              MOVE.L  A2,A3
00001736  D5C6                     999              ADD.L   D6,A2
00001738                          1000              
00001738  4EB9 00001792           1001              JSR     CHECK_DIAGONALS
0000173E  0C39 0000 00001E45      1002              CMP.B   #0,(WINNER)
00001746  6600 0044               1003              BNE     .FINISH_DIA
0000174A                          1004             
0000174A  51CB FFE8               1005              DBRA    D3,.LOOP2
0000174E                          1006              
0000174E                          1007              ;DIAGONAL OF (0,2) AND (6,2) / (3,0)
0000174E  2649                    1008              MOVE.L  A1,A3
00001750  D7C5                    1009              ADD.L   D5,A3
00001752  D7C5                    1010              ADD.L   D5,A3
00001754                          1011              
00001754  4EB9 00001792           1012              JSR     CHECK_DIAGONALS
0000175A  0C39 0000 00001E45      1013              CMP.B   #0,(WINNER)
00001762  6600 0028               1014              BNE     .FINISH_DIA          
00001766                          1015              
00001766  B2BC 00000000           1016              CMP.L   #0,D1
0000176C  6700 0008               1017              BEQ     .MINUS1
00001770  7A01                    1018              MOVE.L  #1,D5
00001772  6000 0004               1019              BRA     .PASS_DIA
00001776  7AFF                    1020  .MINUS1     MOVE.L  #-1,D5
00001778  D3C5                    1021  .PASS_DIA   ADD.L   D5,A1
0000177A  51CA FF94               1022              DBRA    D2,.LOOP_DIAGONALS_ROW1
0000177E                          1023              
0000177E  43F9 00001E1A           1024              LEA     ROW1,A1
00001784  5C89                    1025              ADDQ.L  #6,A1
00001786  7C06                    1026              MOVE.L  #6,D6
00001788  51C9 FF82               1027              DBRA    D1,.LOOP_TO_OTHER_SIDE
0000178C                          1028  
0000178C                          1029  .FINISH_DIA
0000178C  4CDF 0E7F               1030              MOVEM.L (A7)+,D0-D6/A1-A3            
00001790  4E75                    1031              RTS
00001792                          1032  
00001792                          1033              ; CHECK THE DIAGONAL OF THE SELECTED POSITION
00001792                          1034  CHECK_DIAGONALS
00001792  4280                    1035              CLR.L   D0
00001794  1013                    1036              MOVE.B  (A3),D0
00001796  D7C6                    1037              ADD.L   D6,A3
00001798  D013                    1038              ADD.B   (A3),D0
0000179A  D7C6                    1039              ADD.L   D6,A3
0000179C  D013                    1040              ADD.B   (A3),D0
0000179E  D7C6                    1041              ADD.L   D6,A3
000017A0  D013                    1042              ADD.B   (A3),D0
000017A2                          1043              
000017A2  B03C 0004               1044              CMP.B   #4,D0
000017A6  6700 000C               1045              BEQ     .PLAYERWINS_DIA
000017AA  B03C 0014               1046              CMP.B   #20,D0
000017AE  6700 0004               1047              BEQ     .PLAYERWINS_DIA
000017B2                          1048              
000017B2  4E75                    1049              RTS
000017B4                          1050              
000017B4                          1051              ; THERE 4 PIECES CONNECTED
000017B4                          1052  .PLAYERWINS_DIA
000017B4  13F9 00001E44 00001E45  1053              MOVE.B  (TURN),(WINNER)
000017BE  1E3C 0002               1054              MOVE.B  #SNDWIN,D7
000017C2  4E42                    1055              TRAP    #SNDPLTN  
000017C4                          1056  
000017C4  7003                    1057              MOVE.L  #3,D0
000017C6                          1058  .LOOP_DIA
000017C6  16BC 0015               1059              MOVE.B  #21,(A3)
000017CA  97C6                    1060              SUB.L   D6,A3
000017CC  51C8 FFF8               1061              DBRA    D0,.LOOP_DIA
000017D0                          1062                     
000017D0  4E75                    1063              RTS
000017D2                          1064  
000017D2                          1065  
000017D2                          1066  
000017D2                          1067  
000017D2                          1068  
000017D2                          1069  
000017D2                          1070  
000017D2                          1071  
000017D2                          1072  
000017D2                          1073  
000017D2                          1074  
000017D2                          1075  
000017D2                          1076  
000017D2                          1077  
000017D2                          1078  
000017D2                          1079  
000017D2                          1080  -------------------- end include --------------------
000017D2                          1081              INCLUDE "PLAYER.X68"
000017D2                          1082  ; ==============================================================================
000017D2                          1083  ; PLAYERS MANAGEMENT
000017D2                          1084  ; ==============================================================================
000017D2                          1085             
000017D2                          1086  ; ------------------------------------------------------------------------------
000017D2                          1087  PLAINIT
000017D2                          1088  ; INITIALIZE PLAYER.
000017D2                          1089  ; INPUT    : NONE 
000017D2                          1090  ; OUTPUT   : NONE
000017D2                          1091  ; MODIFIES : NONE
000017D2                          1092  ; ------------------------------------------------------------------------------
000017D2                          1093              
000017D2  13FC 0001 00001E44      1094              MOVE.B  #1,(TURN)               ; STARTS THE PLAYER 1
000017DA  4239 00001E45           1095              CLR.B   (WINNER)
000017E0                          1096              
000017E0  4E75                    1097              RTS
000017E2                          1098              
000017E2                          1099  ; ------------------------------------------------------------------------------
000017E2                          1100  PLAUPD
000017E2                          1101  ; UPDATES THE PLAYER.
000017E2                          1102  ; INPUT    : NONE 
000017E2                          1103  ; OUTPUT   : NONE
000017E2                          1104  ; MODIFIES : NONE
000017E2                          1105  ; ------------------------------------------------------------------------------
000017E2                          1106              
000017E2  0C39 0001 00001E44      1107              CMP.B   #1,(TURN)               
000017EA  6700 000C               1108              BEQ     .PLAYER2                ; SWAPS TURN
000017EE  13FC 0001 00001E44      1109              MOVE.B  #1,(TURN)               ; PLAYER 1 TURN   
000017F6                          1110              
000017F6  4E75                    1111              RTS
000017F8                          1112              
000017F8  13FC 0005 00001E44      1113  .PLAYER2    MOVE.B  #5,(TURN)               ; PLAYER 2 TURN
00001800                          1114              
00001800  4E75                    1115              RTS
00001802                          1116              
00001802                          1117  
00001802                          1118  
00001802                          1119  
00001802                          1120  
00001802                          1121  
00001802                          1122  
00001802                          1123  
00001802                          1124  -------------------- end include --------------------
00001802                          1125              INCLUDE "BOARD.X68"
00001802                          1126  ; ==============================================================================
00001802                          1127  ; BOARD MANAGEMENT
00001802                          1128  ; ==============================================================================
00001802                          1129              
00001802                          1130  ; ------------------------------------------------------------------------------
00001802                          1131  BOAPLOT
00001802                          1132  ; PLOT A BOARD WITH INFORMATION
00001802                          1133  ; INPUT    : A1 POINTER TO A NULL-TERMINATED STRING 
00001802                          1134  ; OUTPUT   : NONE
00001802                          1135  ; MODIFIES : NONE
00001802                          1136  ; ------------------------------------------------------------------------------
00001802                          1137  
00001802  48E7 C040               1138              MOVEM.L D0-D1/A1,-(A7)
00001806                          1139  
00001806                          1140              ; SET BACKGROUND COLOR
00001806  103C 0051               1141              MOVE.B  #81,D0
0000180A  7200                    1142              MOVE.L  #00000000,D1
0000180C  4E4F                    1143              TRAP    #15
0000180E                          1144              
0000180E                          1145              ; SET FIRST LINE POSITION (SCREEN ARRAY COLUMNS = 120 ROWS = 47)
0000180E  103C 000B               1146              MOVE.B  #11,D0
00001812  323C 0000               1147              MOVE.W  #$0000,D1               ; UP LEFT CORNER
00001816  4E4F                    1148              TRAP    #15
00001818                          1149  
00001818                          1150              ; PRINT LINE
00001818  0C39 0001 00001E44      1151              CMP.B   #1,(TURN)               ; PRINTS THE TURN OF THE PLAYER
00001820  6700 0008               1152              BEQ     .PLAYER1
00001824  7202                    1153              MOVE.L  #2,D1
00001826  6000 0004               1154              BRA     .PASS
0000182A                          1155              
0000182A  7201                    1156  .PLAYER1    MOVE.L  #1,D1
0000182C                          1157  
0000182C  103C 0011               1158  .PASS       MOVE.B  #17,D0
00001830  4E4F                    1159              TRAP    #15
00001832                          1160              
00001832  4CDF 0203               1161              MOVEM.L (A7)+,D0-D1/A1
00001836  4E75                    1162              RTS
00001838                          1163  
00001838                          1164  
00001838                          1165  
00001838                          1166  
00001838                          1167  
00001838                          1168  
00001838                          1169  
00001838                          1170  
00001838                          1171  
00001838                          1172  
00001838                          1173  
00001838                          1174  
00001838                          1175  -------------------- end include --------------------
00001838                          1176              INCLUDE "GAME.X68"
00001838                          1177  ; ==============================================================================
00001838                          1178  ; GAME MANAGEMENT
00001838                          1179  ; ==============================================================================
00001838                          1180  
00001838                          1181  ; ------------------------------------------------------------------------------
00001838                          1182  GAMINIT
00001838                          1183  ; INITIALIZES GAME.
00001838                          1184  ; INPUT    : NONE
00001838                          1185  ; OUTPUT   : NONE
00001838                          1186  ; MODIFIES : NONE
00001838                          1187  ; ------------------------------------------------------------------------------
00001838  4EB8 13A8               1188              JSR     TABINIT
0000183C  4EB8 1304               1189              JSR     BOXINIT
00001840  4EB8 13FE               1190              JSR     PIEINIT
00001844  4EB8 17D2               1191              JSR     PLAINIT
00001848  4279 00001E46           1192              CLR.W   (TIMER)                 ; RESET TIMER
0000184E  4E75                    1193              RTS
00001850                          1194  
00001850                          1195  ; ------------------------------------------------------------------------------
00001850                          1196  GAMUPD
00001850                          1197  ; UPDATES THE GAME
00001850                          1198  ; INPUT    : NONE
00001850                          1199  ; OUTPUT   : NONE
00001850                          1200  ; MODIFIES : NONE
00001850                          1201  ; ------------------------------------------------------------------------------
00001850                          1202              
00001850                          1203              ; IF THERE IS NO WINNER DON'T CHANGE THE STATE            
00001850  0C39 0000 00001E45      1204              CMP.B   #0,(WINNER)
00001858  6700 0034               1205              BEQ     .CONTINUE
0000185C                          1206              
0000185C                          1207              ; CHANGE STATE WITH FIRE1 OR IN 3 SECONDS
0000185C  0839 0004 00001ED1      1208              BTST.B  #4,(KBDEDGE)
00001864  6700 000E               1209              BEQ     .CONT
00001868  33FC 0002 00001E4A      1210              MOVE.W  #2,(STANEXT)
00001870  6000 0020               1211              BRA     .DONE
00001874  5279 00001E46           1212  .CONT       ADDQ.W  #1,(TIMER)
0000187A  0C79 00B4 00001E46      1213              CMP.W   #SCRFPS*3,(TIMER)
00001882  6D00 000E               1214              BLT     .DONE
00001886  33FC 0002 00001E4A      1215              MOVE.W  #2,(STANEXT)                      
0000188E  4EB8 1438               1216  .CONTINUE   JSR     PIEUPD
00001892                          1217  .DONE
00001892  4E75                    1218              RTS
00001894                          1219  
00001894                          1220  ; ------------------------------------------------------------------------------
00001894                          1221  GAMPLOT
00001894                          1222  ; PLOTS THE GAME
00001894                          1223  ; INPUT    : NONE
00001894                          1224  ; OUTPUT   : NONE
00001894                          1225  ; MODIFIES : NONE
00001894                          1226  ; ------------------------------------------------------------------------------
00001894  48E7 FE40               1227              MOVEM.L D0-D6/A1,-(A7)
00001898                          1228              
00001898                          1229              ; PLOT TABLE
00001898  4EB8 13C6               1230              JSR     TABPLOT
0000189C                          1231              
0000189C                          1232              ; PLOT EVERY BOX OF THE TABLE, REPRESENTS POSITIONS OF THE MATRIX
0000189C  303C 0006               1233              MOVE.W  #BOXNCOL-1,D0
000018A0                          1234  .PLOT_NEXT_COL
000018A0  343C 0007               1235              MOVE.W  #BOXNCOL,D2
000018A4  9440                    1236              SUB.W   D0,D2
000018A6  33C2 00001E04           1237              MOVE.W  D2,(BOXCOL)
000018AC                          1238              
000018AC  323C 0005               1239              MOVE.W  #BOXNROW-1,D1
000018B0                          1240  .PLOT_NEXT_ROW
000018B0  343C 0006               1241              MOVE.W  #BOXNROW,D2
000018B4  9441                    1242              SUB.W   D1,D2
000018B6  33C2 00001E06           1243              MOVE.W  D2,(BOXROW)
000018BC                          1244              
000018BC  4EB8 1316               1245              JSR     BOXPLOT
000018C0                          1246              
000018C0  51C9 FFEE               1247              DBRA    D1,.PLOT_NEXT_ROW
000018C4  51C8 FFDA               1248              DBRA    D0,.PLOT_NEXT_COL
000018C8                          1249              
000018C8                          1250              ; PRINT THE PIECE IN HIS RIGHT POSITION AND THE BOARD INFORMATION
000018C8  3A39 00001E0C           1251              MOVE.W  (PIEPOSX),D5
000018CE  3C39 00001E0E           1252              MOVE.W  (PIEPOSY),D6
000018D4  1039 00001E44           1253              MOVE.B  (TURN),D0
000018DA  4EB8 1522               1254              JSR     PIEPLOT
000018DE  43F9 000018EE           1255              LEA     .TXT,A1
000018E4  4EB8 1802               1256              JSR     BOAPLOT                 
000018E8                          1257              
000018E8  4CDF 027F               1258              MOVEM.L (A7)+,D0-D6/A1
000018EC                          1259              
000018EC  4E75                    1260              RTS
000018EE                          1261  
000018EE= 50 4C 41 59 45 52 ...   1262  .TXT        DC.B    'PLAYER TURN: ',0            
000018FC                          1263              DS.W    0
000018FC                          1264  
000018FC                          1265  
000018FC                          1266  
000018FC                          1267  
000018FC                          1268  
000018FC                          1269  
000018FC                          1270  -------------------- end include --------------------
000018FC                          1271              INCLUDE "SCREENS/INTRO.X68"
000018FC                          1272  ; ---------------------------------------------------------------------
000018FC                          1273  ; INTRO SCREEN
000018FC                          1274  ; ---------------------------------------------------------------------
000018FC                          1275  
000018FC                          1276  ; ------------------------------------------------------------------------------
000018FC                          1277  ISCINIT
000018FC                          1278  ; INTRO SCREEN INIT
000018FC                          1279  ; INPUT    : NONE 
000018FC                          1280  ; OUTPUT   : NONE
000018FC                          1281  ; MODIFIES : NONE
000018FC                          1282  ; ------------------------------------------------------------------------------
000018FC                          1283              
000018FC  4279 00001E46           1284              CLR.W   (TIMER)                 ; RESET TIMER
00001902  4E75                    1285              RTS
00001904                          1286              
00001904                          1287  ; ------------------------------------------------------------------------------
00001904                          1288  ISCUPD
00001904                          1289  ; INTRO SCREEN UPDATE
00001904                          1290  ; INPUT    : NONE 
00001904                          1291  ; OUTPUT   : NONE
00001904                          1292  ; MODIFIES : NONE
00001904                          1293  ; ------------------------------------------------------------------------------
00001904                          1294              
00001904                          1295              ; JUMP TO THE GAME IF WE PRESS FIRE1
00001904  0839 0004 00001ED1      1296              BTST.B  #4,(KBDEDGE)           
0000190C  6700 000E               1297              BEQ     .CONT
00001910  33FC 0001 00001E4A      1298              MOVE.W  #1,(STANEXT)
00001918  6000 0022               1299              BRA     .DONE
0000191C                          1300              
0000191C                          1301              ; STAY IN THIS STATE FOR 10 SECONDS THEN GO AUTOGAME STATE
0000191C  1E3C 0003               1302  .CONT       MOVE.B  #SNDMUSIC,D7
00001920  4E42                    1303              TRAP    #SNDPLTN
00001922  5279 00001E46           1304              ADDQ.W  #1,(TIMER)
00001928  0C79 0258 00001E46      1305              CMP.W   #SCRFPS*10,(TIMER)
00001930  6D00 000A               1306              BLT     .DONE
00001934  33FC 0003 00001E4A      1307              MOVE.W  #3,(STANEXT)
0000193C                          1308  .DONE       
0000193C  4E75                    1309              RTS
0000193E                          1310              
0000193E                          1311  ; ------------------------------------------------------------------------------
0000193E                          1312  ISCPLOT
0000193E                          1313  ; INTRO SCREEN PLOT
0000193E                          1314  ; INPUT    : NONE 
0000193E                          1315  ; OUTPUT   : NONE
0000193E                          1316  ; MODIFIES : NONE
0000193E                          1317  ; ------------------------------------------------------------------------------
0000193E                          1318              
0000193E  48E7 C0C0               1319              MOVEM.L D0-D1/A0-A1,-(A7)
00001942                          1320              
00001942                          1321              ; SET BACKGROUND COLOR
00001942  103C 0051               1322              MOVE.B  #81,D0
00001946  7200                    1323              MOVE.L  #00000000,D1
00001948  4E4F                    1324              TRAP    #15
0000194A                          1325              
0000194A                          1326              ; PLOT ALL THE INTRODUCTION TO THE GAME
0000194A  103C 000B               1327              MOVE.B  #11,D0
0000194E                          1328              
0000194E  41F9 0000198C           1329              LEA     .TXT1,A0
00001954  4EB8 11B2               1330              JSR     UTLPRINT
00001958                          1331              
00001958  5800                    1332              ADDQ.B  #4,D0
0000195A  43F9 00001A7E           1333              LEA     .TXTLST,A1
00001960  2219                    1334  .LOOP       MOVE.L  (A1)+,D1
00001962  6700 000A               1335              BEQ     .DONE1
00001966  2041                    1336              MOVE.L  D1,A0
00001968  4EB8 11B2               1337              JSR     UTLPRINT
0000196C  60F2                    1338              BRA    .LOOP
0000196E                          1339  .DONE1            
0000196E  0839 0004 00001ED3      1340              BTST.B   #4,(SCRCYCCT)          ; PLOT AN INTERMITENT TEXT
00001976  6700 000E               1341              BEQ     .DONE2
0000197A                          1342              
0000197A  41F9 00001A68           1343              LEA     .TXT7,A0
00001980  5C00                    1344              ADD.B   #6,D0
00001982  4EB8 11B2               1345              JSR     UTLPRINT
00001986                          1346              
00001986  4CDF 0303               1347  .DONE2      MOVEM.L (A7)+,D0-D1/A0-A1
0000198A                          1348              
0000198A  4E75                    1349              RTS
0000198C                          1350  
0000198C= 43 4F 4E 4E 45 43 ...   1351  .TXT1       DC.B    'CONNECT-4',0
00001996= 54 52 59 20 54 4F ...   1352  .TXT2       DC.B    'TRY TO CONNECT 4 PIECES IN A LINE',0
000019B8= 55 53 45 20 4C 45 ...   1353  .TXT3       DC.B    'USE LEFT AND RIGHT ARROWS TO SELECT PIECE POSITION',0
000019EB= 50 52 45 53 53 20 ...   1354  .TXT4       DC.B    'PRESS SPACE TO PLACE A PIECE',0
00001A08= 41 46 54 45 52 20 ...   1355  .TXT5       DC.B    'AFTER PLACING A PIECE THE TURN WILL SWAP',0
00001A31= 50 4C 41 59 45 52 ...   1356  .TXT6       DC.B    'PLAYER 1 HAS RED PIECES AND PLAYER 2 HAS YELLOW PIECES',0
00001A68= 50 52 45 53 53 20 ...   1357  .TXT7       DC.B    'PRESS SPACE TO START',0
00001A7E                          1358              DS.W    0
00001A7E= 00001996 000019B8 ...   1359  .TXTLST     DC.L    .TXT2,.TXT3,.TXT4,.TXT5,.TXT6,0
00001A96                          1360  
00001A96                          1361  
00001A96                          1362  
00001A96                          1363  
00001A96                          1364  
00001A96                          1365  
00001A96                          1366  
00001A96                          1367  
00001A96                          1368  
00001A96                          1369  
00001A96                          1370  
00001A96                          1371  
00001A96                          1372  
00001A96                          1373  
00001A96                          1374  
00001A96                          1375  
00001A96                          1376  
00001A96                          1377  
00001A96                          1378  -------------------- end include --------------------
00001A96                          1379              INCLUDE "SCREENS/ENDGAME.X68"
00001A96                          1380  ; ---------------------------------------------------------------------
00001A96                          1381  ; END GAME SCREEN
00001A96                          1382  ; ---------------------------------------------------------------------
00001A96                          1383  
00001A96                          1384  ; ------------------------------------------------------------------------------
00001A96                          1385  ENDINIT
00001A96                          1386  ; INTRO SCREEN INIT
00001A96                          1387  ; INPUT    : NONE 
00001A96                          1388  ; OUTPUT   : NONE
00001A96                          1389  ; MODIFIES : NONE
00001A96                          1390  ; ------------------------------------------------------------------------------
00001A96                          1391              
00001A96  4279 00001E46           1392              CLR.W   (TIMER)                 ; RESET TIMER
00001A9C                          1393              ; PUT THE PIECE OF THE WINNER IN THE MIDDLE OF THE SCREEN
00001A9C  33FC 01E0 00001E0C      1394              MOVE.W  #SCRWIDTH/2,(PIEPOSX)
00001AA4  33FC 0168 00001E0E      1395              MOVE.W  #SCRHEIGH/2,(PIEPOSY)
00001AAC                          1396              
00001AAC  4E75                    1397              RTS
00001AAE                          1398              
00001AAE                          1399  ; ------------------------------------------------------------------------------
00001AAE                          1400  ENDUPD
00001AAE                          1401  ; INTRO SCREEN UPDATE
00001AAE                          1402  ; INPUT    : NONE 
00001AAE                          1403  ; OUTPUT   : NONE
00001AAE                          1404  ; MODIFIES : NONE
00001AAE                          1405  ; ------------------------------------------------------------------------------
00001AAE                          1406              
00001AAE                          1407              ; JUMP TO THE INTRO IF WE PRESS FIRE1
00001AAE  0839 0004 00001ED1      1408              BTST.B  #4,(KBDEDGE)
00001AB6  6700 000E               1409              BEQ     .CONT
00001ABA  33FC 0000 00001E4A      1410              MOVE.W  #0,(STANEXT)
00001AC2  6000 0022               1411              BRA     .DONE
00001AC6                          1412              
00001AC6                          1413              ; STAY IN THIS STATE FOR 10 SECONDS, THEN GO TO INTRO
00001AC6  1E3C 0003               1414  .CONT       MOVE.B  #SNDMUSIC,D7
00001ACA  4E42                    1415              TRAP    #SNDPLTN
00001ACC  5279 00001E46           1416              ADDQ.W  #1,(TIMER)
00001AD2  0C79 0258 00001E46      1417              CMP.W   #SCRFPS*10,(TIMER)
00001ADA  6D00 000A               1418              BLT     .DONE
00001ADE  33FC 0000 00001E4A      1419              MOVE.W  #0,(STANEXT)
00001AE6                          1420  .DONE     
00001AE6  4E75                    1421              RTS
00001AE8                          1422              
00001AE8                          1423  ; ------------------------------------------------------------------------------
00001AE8                          1424  ENDPLOT
00001AE8                          1425  ; INTRO SCREEN PLOT
00001AE8                          1426  ; INPUT    : NONE 
00001AE8                          1427  ; OUTPUT   : NONE
00001AE8                          1428  ; MODIFIES : NONE
00001AE8                          1429  ; ------------------------------------------------------------------------------
00001AE8                          1430              
00001AE8  48E7 FE80               1431              MOVEM.L D0-D6/A0,-(A7)
00001AEC                          1432              
00001AEC                          1433              ; SET BACKGROUND COLOR
00001AEC  103C 0051               1434              MOVE.B  #81,D0
00001AF0  7200                    1435              MOVE.L  #00000000,D1
00001AF2  4E4F                    1436              TRAP    #15
00001AF4                          1437              
00001AF4  103C 000F               1438              MOVE.B  #15,D0
00001AF8                          1439              
00001AF8  0C39 0005 00001E45      1440              CMP.B   #5,(WINNER)
00001B00  6700 000C               1441              BEQ     .PLAYER2_WIN
00001B04  41F9 00001B38           1442              LEA     .TXT1,A0
00001B0A  6000 0008               1443              BRA     .DONE
00001B0E                          1444  .PLAYER2_WIN            
00001B0E  41F9 00001B52           1445              LEA     .TXT2,A0
00001B14                          1446              
00001B14  4EB8 11B2               1447  .DONE       JSR     UTLPRINT
00001B18                          1448              
00001B18  4285                    1449              CLR.L   D5
00001B1A  4286                    1450              CLR.L   D6
00001B1C  3A39 00001E0C           1451              MOVE.W  (PIEPOSX),D5
00001B22  3C39 00001E0E           1452              MOVE.W  (PIEPOSY),D6
00001B28  1039 00001E45           1453              MOVE.B  (WINNER),D0
00001B2E  4EB8 1522               1454              JSR     PIEPLOT
00001B32                          1455              
00001B32  4CDF 017F               1456              MOVEM.L (A7)+,D0-D6/A0
00001B36                          1457              
00001B36  4E75                    1458              RTS
00001B38                          1459  
00001B38= A1 A1 A1 A1 A1 20 ...   1460  .TXT1       DC.B    ' PLAYER 1 WINS !!!!!',0
00001B52= A1 A1 A1 A1 A1 20 ...   1461  .TXT2       DC.B    ' PLAYER 2 WINS !!!!!',0
00001B6C                          1462              DS.W    0
00001B6C                          1463  
00001B6C                          1464  
00001B6C                          1465  
00001B6C                          1466  
00001B6C                          1467  
00001B6C                          1468  
00001B6C                          1469  
00001B6C                          1470  -------------------- end include --------------------
00001B6C                          1471              INCLUDE "ATTRACTMODE/FILE.X68"
00001B6C                          1472  ; ==============================================================================
00001B6C                          1473  ; FILE MANAGEMENT
00001B6C                          1474  ; ==============================================================================
00001B6C                          1475  
00001B6C                          1476  ; ------------------------------------------------------------------------------
00001B6C                          1477  FILEINIT
00001B6C                          1478  ; INITIALIZE FILE
00001B6C                          1479  ; INPUT    : NONE 
00001B6C                          1480  ; OUTPUT   : NONE
00001B6C                          1481  ; MODIFIES : NONE
00001B6C                          1482  ; ------------------------------------------------------------------------------
00001B6C                          1483  
00001B6C  48E7 C040               1484              MOVEM.L  D0-D1/A1,-(A7)
00001B70                          1485              
00001B70                          1486              ; CLEAR THE STORADGE OF THE THING WE GONA READ
00001B70  43F9 00001E50           1487              LEA.L   READED,A1
00001B76  703E                    1488              MOVE.L  #(126/2)-1,D0
00001B78  4259                    1489  .LOOP1      CLR.W   (A1)+
00001B7A  51C8 FFFC               1490              DBRA    D0,.LOOP1
00001B7E                          1491                   
00001B7E  43F8 1000               1492              LEA.L   FILE,A1
00001B82  7033                    1493              MOVE.L  #51,D0
00001B84  4E4F                    1494              TRAP    #15
00001B86                          1495              
00001B86  23C1 00001E4C           1496              MOVE.L  D1,(FILEID)             ; KEEP THE ID OF THE FILE
00001B8C                          1497              
00001B8C  4CDF 0203               1498              MOVEM.L  (A7)+,D0-D1/A1
00001B90  4E75                    1499              RTS    
00001B92                          1500  
00001B92                          1501  ; ------------------------------------------------------------------------------
00001B92                          1502  READFILE
00001B92                          1503  ; READ THE FILE THAT CONTAINS THE MOVES
00001B92                          1504  ; INPUT    : NONE 
00001B92                          1505  ; OUTPUT   : NONE
00001B92                          1506  ; MODIFIES : NONE
00001B92                          1507  ; ------------------------------------------------------------------------------
00001B92                          1508  
00001B92  48E7 E040               1509              MOVEM.L  D0-D2/A1,-(A7)
00001B96                          1510              ; READ MANY BITES AS MOVES CAN BE DONE
00001B96  43F9 00001E50           1511              LEA.L   READED,A1
00001B9C  7035                    1512              MOVE.L  #53,D0
00001B9E  2239 00001E4C           1513              MOVE.L  (FILEID),D1
00001BA4  747E                    1514              MOVE.L  #126,D2                 
00001BA6  4E4F                    1515              TRAP    #15
00001BA8                          1516              
00001BA8                          1517              ; CEAN WHAT WE READED (PUTS A $3 IN THE HIGH 4 BITS ON EVERY POS.)
00001BA8  43F9 00001E50           1518              LEA.L   READED,A1
00001BAE  5302                    1519              SUBQ.B  #1,D2                   ;D2 = BYTES READED
00001BB0  0419 0030               1520  .LOOP2      SUB.B   #$30,(A1)+
00001BB4  51CA FFFA               1521              DBRA    D2,.LOOP2                
00001BB8                          1522              
00001BB8  4CDF 0207               1523              MOVEM.L  (A7)+,D0-D2/A1
00001BBC  4E75                    1524              RTS
00001BBE                          1525  
00001BBE                          1526  
00001BBE                          1527  -------------------- end include --------------------
00001BBE                          1528              INCLUDE "ATTRACTMODE/AUTOGAME.X68"
00001BBE                          1529  ; ==============================================================================
00001BBE                          1530  ; AUTOMATIC GAME MANAGEMENT
00001BBE                          1531  ; ==============================================================================
00001BBE                          1532  
00001BBE                          1533  ; ------------------------------------------------------------------------------
00001BBE                          1534  AUTOINIT
00001BBE                          1535  ; INITIALIZES AUTOGAME.
00001BBE                          1536  ; INPUT    : NONE
00001BBE                          1537  ; OUTPUT   : NONE
00001BBE                          1538  ; MODIFIES : NONE
00001BBE                          1539  ; ------------------------------------------------------------------------------
00001BBE  4EB8 13A8               1540              JSR     TABINIT
00001BC2  4EB8 1304               1541              JSR     BOXINIT
00001BC6  4EB8 13FE               1542              JSR     PIEINIT
00001BCA  4EB8 17D2               1543              JSR     PLAINIT
00001BCE  4EB8 1B6C               1544              JSR     FILEINIT
00001BD2  4EB8 1B92               1545              JSR     READFILE
00001BD6  4239 00001ECE           1546              CLR.B   (INDEXREAD)             ; RESET INDEX ARRAY MOVEMENTS
00001BDC  4279 00001E46           1547              CLR.W   (TIMER)                 ; RESET TIMER
00001BE2  4E75                    1548              RTS
00001BE4                          1549  
00001BE4                          1550  ; ------------------------------------------------------------------------------
00001BE4                          1551  AUTOUPD
00001BE4                          1552  ; UPDATES THE AUTOGAME
00001BE4                          1553  ; INPUT    : NONE
00001BE4                          1554  ; OUTPUT   : NONE
00001BE4                          1555  ; MODIFIES : NONE
00001BE4                          1556  ; ------------------------------------------------------------------------------
00001BE4                          1557                      
00001BE4  48E7 F040               1558              MOVEM.L  D0-D3/A1,-(A7)
00001BE8                          1559              
00001BE8  4280                    1560              CLR.L   D0
00001BEA  4283                    1561              CLR.L   D3
00001BEC                          1562              
00001BEC                          1563              ; RETURN TO START STATE IF WE PRESS SPACE
00001BEC  0839 0004 00001ED1      1564              BTST.B  #4,(KBDEDGE)
00001BF4  6700 000E               1565              BEQ     .PASS
00001BF8  33FC 0000 00001E4A      1566              MOVE.W  #0,(STANEXT)
00001C00  6000 00BA               1567              BRA     .DONE
00001C04                          1568  .PASS       ; CHECK IF THERE IS A WINNER TO RETURN TO THE START STATE
00001C04  0C39 0000 00001E45      1569              CMP.B   #0,(WINNER)
00001C0C  6700 001C               1570              BEQ     .CONTINUE
00001C10  5279 00001E46           1571              ADDQ.W  #1,(TIMER)
00001C16  0C79 00B4 00001E46      1572              CMP.W   #SCRFPS*3,(TIMER)
00001C1E  6D00 009C               1573              BLT     .DONE
00001C22  33FC 0000 00001E4A      1574              MOVE.W  #0,(STANEXT)                      
00001C2A                          1575  .CONTINUE   ; CHECK IF A PIECE IS FALLING
00001C2A  1639 00001ED3           1576              MOVE.B  (SCRCYCCT),D3
00001C30  C63C 00F8               1577              AND.B   #$F8,D3
00001C34  B639 00001ED3           1578              CMP.B   (SCRCYCCT),D3
00001C3A  6600 0080               1579              BNE     .DONE
00001C3E  0C39 0000 00001E18      1580              CMP.B   #0,(FALLING)
00001C46  6700 000A               1581              BEQ     .PASS1
00001C4A  4EB8 15AA               1582              JSR     PIEFALL
00001C4E  6000 006C               1583              BRA     .DONE
00001C52                          1584  .PASS1      ; CHECK IF THE ARRAY OF MOVEMENTS IS FINISHED
00001C52  0C39 007D 00001ECE      1585              CMP.B   #125,(INDEXREAD)
00001C5A  6300 000E               1586              BLS     .PASS2
00001C5E  33FC 0000 00001E4A      1587              MOVE.W  #0,(STANEXT)
00001C66  6000 0054               1588              BRA     .DONE
00001C6A                          1589  .PASS2      ; MAKE THE MOVES
00001C6A  3039 00001E0C           1590              MOVE.W  (PIEPOSX),D0      
00001C70  43F9 00001E50           1591              LEA     READED,A1
00001C76  1639 00001ECE           1592              MOVE.B  (INDEXREAD),D3
00001C7C  D3C3                    1593              ADD.L   D3,A1
00001C7E                          1594              ; 2 EQUALS PRESS LEFT ARROW
00001C7E  0C11 0002               1595              CMP.B   #2,(A1)
00001C82  6700 0020               1596              BEQ     .AUTOLEFT
00001C86                          1597              ; 3 EQUALS PRESS RIGHT ARROW
00001C86  0C11 0003               1598              CMP.B   #3,(A1)
00001C8A  6700 0020               1599              BEQ     .AUTORIGHT
00001C8E                          1600              ; 1 EQUALS PRESS FIRE 1
00001C8E  1E3C 0001               1601              MOVE.B  #SNDFALL,D7
00001C92  4E42                    1602              TRAP    #SNDPLTN
00001C94  13FC 0001 00001E18      1603              MOVE.B  #1,(FALLING)
00001C9C  4EB8 15AA               1604              JSR     PIEFALL
00001CA0  6000 000E               1605              BRA     .JUMP            
00001CA4  4EB8 14C8               1606  .AUTOLEFT   JSR     PRESSLEFT
00001CA8  6000 0006               1607              BRA     .JUMP
00001CAC  4EB8 14F4               1608  .AUTORIGHT  JSR     PRESSRIGHT
00001CB0                          1609              
00001CB0  33C0 00001E0C           1610  .JUMP       MOVE.W  D0,(PIEPOSX)
00001CB6  5239 00001ECE           1611              ADDQ.B  #1,(INDEXREAD)          ; GO TO THE NEXT MOVE
00001CBC                          1612              
00001CBC  4CDF 020F               1613  .DONE       MOVEM.L  (A7)+,D0-D3/A1
00001CC0  4E75                    1614              RTS
00001CC2                          1615  
00001CC2                          1616  ; ------------------------------------------------------------------------------
00001CC2                          1617  AUTOPLOT
00001CC2                          1618  ; PLOTS THE AUTOGAME
00001CC2                          1619  ; INPUT    : NONE
00001CC2                          1620  ; OUTPUT   : NONE
00001CC2                          1621  ; MODIFIES : NONE
00001CC2                          1622  ; ------------------------------------------------------------------------------
00001CC2  48E7 FE40               1623              MOVEM.L D0-D6/A1,-(A7)
00001CC6                          1624              
00001CC6  4EB8 13C6               1625              JSR     TABPLOT
00001CCA                          1626              
00001CCA  303C 0006               1627              MOVE.W  #BOXNCOL-1,D0
00001CCE                          1628  .PLOT_NEXT_COL
00001CCE  343C 0007               1629              MOVE.W  #BOXNCOL,D2
00001CD2  9440                    1630              SUB.W   D0,D2
00001CD4  33C2 00001E04           1631              MOVE.W  D2,(BOXCOL)
00001CDA                          1632              
00001CDA  323C 0005               1633              MOVE.W  #BOXNROW-1,D1
00001CDE                          1634  .PLOT_NEXT_ROW
00001CDE  343C 0006               1635              MOVE.W  #BOXNROW,D2
00001CE2  9441                    1636              SUB.W   D1,D2
00001CE4  33C2 00001E06           1637              MOVE.W  D2,(BOXROW)
00001CEA                          1638              
00001CEA  4EB8 1316               1639              JSR     BOXPLOT
00001CEE                          1640              
00001CEE  51C9 FFEE               1641              DBRA    D1,.PLOT_NEXT_ROW
00001CF2  51C8 FFDA               1642              DBRA    D0,.PLOT_NEXT_COL
00001CF6                          1643              
00001CF6  3A39 00001E0C           1644              MOVE.W  (PIEPOSX),D5
00001CFC  3C39 00001E0E           1645              MOVE.W  (PIEPOSY),D6
00001D02  1039 00001E44           1646              MOVE.B  (TURN),D0
00001D08  4EB8 1522               1647              JSR     PIEPLOT
00001D0C  43F9 00001D1C           1648              LEA     .TXT,A1
00001D12  4EB8 1802               1649              JSR     BOAPLOT                 
00001D16                          1650              
00001D16  4CDF 027F               1651              MOVEM.L (A7)+,D0-D6/A1
00001D1A                          1652              
00001D1A  4E75                    1653              RTS
00001D1C                          1654  
00001D1C= 41 54 54 52 41 43 ...   1655  .TXT        DC.B    'ATTRACT MODE /// PLAYER TURN: ',0            
00001D3C                          1656              DS.W    0
00001D3C                          1657  
00001D3C                          1658  
00001D3C                          1659  
00001D3C                          1660  
00001D3C                          1661  
00001D3C                          1662  
00001D3C                          1663  
00001D3C                          1664  -------------------- end include --------------------
00001D3C                          1665              INCLUDE "STATES.X68"
00001D3C                          1666  ; =============================================================================
00001D3C                          1667  ; GAME STATE MANAGEMENT
00001D3C                          1668  ; =============================================================================
00001D3C                          1669  
00001D3C                          1670  ; -----------------------------------------------------------------------------
00001D3C                          1671  STAINIT
00001D3C                          1672  ; INITALIZES THE STATE MANAGER
00001D3C                          1673  ; INPUT    - NONE
00001D3C                          1674  ; OUTPUT   - NONE
00001D3C                          1675  ; MODIFIES - NONE
00001D3C                          1676  ; -----------------------------------------------------------------------------
00001D3C  33FC FFFF 00001E48      1677              MOVE.W  #STANONE,(STACUR)
00001D44  4279 00001E4A           1678              CLR.W   (STANEXT)
00001D4A  4E75                    1679              RTS
00001D4C                          1680  
00001D4C                          1681  ; -----------------------------------------------------------------------------
00001D4C                          1682  STAUPD
00001D4C                          1683  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00001D4C                          1684  ; INPUT    - NONE
00001D4C                          1685  ; OUTPUT   - NONE
00001D4C                          1686  ; MODIFIES - NONE
00001D4C                          1687  ; -----------------------------------------------------------------------------
00001D4C  48E7 8080               1688              MOVEM.L D0/A0,-(A7)
00001D50  4280                    1689              CLR.L   D0
00001D52  3039 00001E4A           1690              MOVE.W  (STANEXT),D0
00001D58  B079 00001E48           1691              CMP.W   (STACUR),D0
00001D5E  6700 0012               1692              BEQ     .DOUPD
00001D62  33C0 00001E48           1693              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00001D68  E588                    1694              LSL.L   #2,D0
00001D6A  2040                    1695              MOVE.L  D0,A0
00001D6C  2068 1D8A               1696              MOVE.L  .INITBL(A0),A0
00001D70  4E90                    1697              JSR     (A0)
00001D72  4280                    1698  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00001D74  3039 00001E48           1699              MOVE.W  (STACUR),D0
00001D7A  E588                    1700              LSL.L   #2,D0
00001D7C  2040                    1701              MOVE.L  D0,A0
00001D7E  2068 1D9A               1702              MOVE.L  .UPDTBL(A0),A0
00001D82  4E90                    1703              JSR     (A0)
00001D84  4CDF 0101               1704              MOVEM.L (A7)+,D0/A0
00001D88  4E75                    1705              RTS
00001D8A= 000018FC 00001838 ...   1706  .INITBL     DC.L    ISCINIT,GAMINIT,ENDINIT,AUTOINIT
00001D9A= 00001904 00001850 ...   1707  .UPDTBL     DC.L    ISCUPD,GAMUPD,ENDUPD,AUTOUPD
00001DAA                          1708  
00001DAA                          1709  ; -----------------------------------------------------------------------------
00001DAA                          1710  STAPLOT
00001DAA                          1711  ; PERFORMS STATE PLOT
00001DAA                          1712  ; INPUT    - NONE
00001DAA                          1713  ; OUTPUT   - NONE
00001DAA                          1714  ; MODIFIES - NONE
00001DAA                          1715  ; -----------------------------------------------------------------------------
00001DAA  48E7 8080               1716              MOVEM.L D0/A0,-(A7)
00001DAE  4280                    1717              CLR.L   D0
00001DB0  3039 00001E48           1718              MOVE.W  (STACUR),D0
00001DB6  E588                    1719              LSL.L   #2,D0
00001DB8  2040                    1720              MOVE.L  D0,A0
00001DBA  2068 1DC6               1721              MOVE.L  .PLTTBL(A0),A0
00001DBE  4E90                    1722              JSR     (A0)
00001DC0  4CDF 0101               1723              MOVEM.L (A7)+,D0/A0
00001DC4  4E75                    1724              RTS
00001DC6= 0000193E 00001894 ...   1725  .PLTTBL     DC.L    ISCPLOT,GAMPLOT,ENDPLOT,AUTOPLOT
00001DD6                          1726  
00001DD6                          1727  ; -----------------------------------------------------------------------------
00001DD6                          1728  STAEMPTY
00001DD6                          1729  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00001DD6                          1730  ; INPUT    - NONE
00001DD6                          1731  ; OUTPUT   - NONE
00001DD6                          1732  ; MODIFIES - NONE
00001DD6                          1733  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00001DD6                          1734  ; -----------------------------------------------------------------------------
00001DD6  4E75                    1735              RTS
00001DD8                          1736  
00001DD8                          1737  
00001DD8                          1738  
00001DD8                          1739  
00001DD8                          1740  
00001DD8                          1741  
00001DD8                          1742  
00001DD8                          1743  
00001DD8                          1744  
00001DD8                          1745  
00001DD8                          1746  
00001DD8                          1747  
00001DD8                          1748  
00001DD8                          1749  -------------------- end include --------------------
00001DD8                          1750             
00001DD8                          1751  START
00001DD8                          1752  
00001DD8                          1753  ; --- INITIALIZATION -----------------------------------------------------------
00001DD8                          1754              
00001DD8  007C 0700               1755              ORI.W   #$0700,SR
00001DDC  4EB8 1012               1756              JSR     SYSINIT
00001DE0  4EB8 1D3C               1757              JSR     STAINIT
00001DE4                          1758  
00001DE4                          1759  .LOOP
00001DE4                          1760  
00001DE4                          1761  ; --- UPDATE -------------------------------------------------------------------
00001DE4                          1762  
00001DE4                          1763  ; READ INPUT DEVICES
00001DE4                          1764  
00001DE4  4E41                    1765              TRAP    #KBDUPTN
00001DE6                          1766  
00001DE6                          1767  ; UPDATE GAME LOGIC
00001DE6                          1768  
00001DE6  4EB8 1D4C               1769              JSR     STAUPD   
00001DEA                          1770                      
00001DEA                          1771  ; --- SYNC ---------------------------------------------------------------------
00001DEA                          1772  
00001DEA  4A39 00001ED2           1773  .WINT       TST.B   (SCRINTCT)
00001DF0  67F8                    1774              BEQ     .WINT
00001DF2  4239 00001ED2           1775              CLR.B   (SCRINTCT)
00001DF8                          1776  
00001DF8                          1777  ; --- PLOT ---------------------------------------------------------------------
00001DF8                          1778  
00001DF8  4EB8 1DAA               1779              JSR    STAPLOT
00001DFC                          1780  
00001DFC  4E40                    1781              TRAP    #SCRUPTN                ; UPDATE DOBLE BUFFER
00001DFE                          1782              
00001DFE  60E4                    1783              BRA     .LOOP
00001E00                          1784  
00001E00  FFFF FFFF               1785              SIMHALT
00001E04                          1786              
00001E04                          1787              INCLUDE "VARS.X68"
00001E04                          1788  ; ==============================================================================
00001E04                          1789  ; GAME VARIABLES
00001E04                          1790  ; ==============================================================================
00001E04                          1791  
00001E04                          1792  ; --- BOX RELATED VARIABLES ----------------------------------------------------
00001E04                          1793  
00001E04                          1794  BOXCOL      DS.W    1                       ; COLUMN WHERE THE BOX IS PAINTED  
00001E06                          1795  BOXROW      DS.W    1                       ; ROW WHERE THE BOX IS PAINTED
00001E08                          1796  BOXPOSX     DS.W    1                       ; BOX X COORDINATE
00001E0A                          1797  BOXPOSY     DS.W    1                       ; BOX Y COORDINATE
00001E0C                          1798  
00001E0C                          1799  ; --- PIECE RELATED VARIABLES --------------------------------------------------
00001E0C                          1800  
00001E0C                          1801  PIEPOSX     DS.W    1                       ; PIECE X COORDINATE
00001E0E                          1802  PIEPOSY     DS.W    1                       ; PIECE Y COORDINATE
00001E10                          1803  PIEVELX     DS.W    1                       ; X MOVEMENT
00001E12                          1804  PIEVELY     DS.W    1                       ; Y MOVEMENT
00001E14                          1805  POSX        DS.W    1                       ; POS. X IN THE MATRIX 
00001E16                          1806  POSY        DS.W    1                       ; POS. Y IN THE MATRIX
00001E18                          1807  FALLING     DS.B    1                       ; 1 A PIECE IS FALLING, 0 NOT
00001E1A                          1808              DS.W    0
00001E1A                          1809  
00001E1A                          1810  ; --- COLUMN RELATED VARIABLES -------------------------------------------------
00001E1A                          1811  
00001E1A                          1812  ROW1        DS.B    7                       ; REPRESENTS THE MATRIX
00001E21                          1813  ROW2        DS.B    7
00001E28                          1814  ROW3        DS.B    7
00001E2F                          1815  ROW4        DS.B    7
00001E36                          1816  ROW5        DS.B    7
00001E3D                          1817  ROW6        DS.B    7
00001E44                          1818              DS.W    0
00001E44                          1819  
00001E44                          1820  ; --- PLAYER VARIABLES ---------------------------------------------------------
00001E44                          1821  
00001E44                          1822  TURN        DS.B    1                       ; PLAYER WHO PLAY IN THAT TURN
00001E45                          1823  WINNER      DS.B    1                       ; 0 NONE, 1 OR 5 (PLAYER WHO WIN)
00001E46                          1824              DS.W    0
00001E46                          1825  
00001E46                          1826  ; --- TIME STATE RELATED VARAIBLES ---------------------------------------------
00001E46                          1827  
00001E46                          1828  TIMER       DS.W    1                       ; TIMER
00001E48                          1829  
00001E48                          1830  ; --- STATE RELATED VARAIBLES --------------------------------------------------
00001E48                          1831  
00001E48                          1832  STACUR      DS.W    1                       ; CURRENT STATE
00001E4A                          1833  STANEXT     DS.W    1                       ; NEXT STATE
00001E4C                          1834  
00001E4C                          1835  ; --- FILE VARAIBLES -----------------------------------------------------------
00001E4C                          1836  
00001E4C                          1837  FILEID      DS.L    1                       ; ID OF THE OPENED FILE
00001E50                          1838  READED      DS.B    126                     ; MOVEMENTS READ (42 BOXES * 3) 
00001ECE                          1839  INDEXREAD   DS.B    1                       ; INDEX TO TRAVEL READED   
00001ED0                          1840              DS.W    0 
00001ED0                          1841  
00001ED0                          1842  
00001ED0                          1843  
00001ED0                          1844  
00001ED0                          1845  
00001ED0                          1846  
00001ED0                          1847  
00001ED0                          1848  
00001ED0                          1849  
00001ED0                          1850  
00001ED0                          1851  
00001ED0                          1852  
00001ED0                          1853  
00001ED0                          1854  
00001ED0                          1855  
00001ED0                          1856  
00001ED0                          1857  
00001ED0                          1858  
00001ED0                          1859  
00001ED0                          1860  
00001ED0                          1861  -------------------- end include --------------------
00001ED0                          1862              INCLUDE "SYS/SYSVARS.X68"
00001ED0                          1863  ; ==============================================================================
00001ED0                          1864  ; SYSTEM VARIABLES
00001ED0                          1865  ; ==============================================================================
00001ED0                          1866              
00001ED0                          1867  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00001ED0                          1868  
00001ED0                          1869  KBDVAL      DS.B    1                       ; KEY STATE
00001ED1                          1870  KBDEDGE     DS.B    1                       ; KEY EDGE
00001ED2                          1871  
00001ED2                          1872  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
00001ED2                          1873  
00001ED2                          1874  SCRINTCT   DS.B    1                       ; INTERRUPT COUNTER
00001ED3                          1875  SCRCYCCT   DS.B    1                       ; CYCLE COUNTER
00001ED4                          1876             DS.W    0
00001ED4                          1877  
00001ED4                          1878  -------------------- end include --------------------
00001ED4                          1879  
00001ED4                          1880              END     START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AUTOINIT            1BBE
AUTOPLOT            1CC2
AUTOPLOT:PLOT_NEXT_COL  1CCE
AUTOPLOT:PLOT_NEXT_ROW  1CDE
AUTOPLOT:TXT        1D1C
AUTOUPD             1BE4
AUTOUPD:AUTOLEFT    1CA4
AUTOUPD:AUTORIGHT   1CAC
AUTOUPD:CONTINUE    1C2A
AUTOUPD:DONE        1CBC
AUTOUPD:JUMP        1CB0
AUTOUPD:PASS        1C04
AUTOUPD:PASS1       1C52
AUTOUPD:PASS2       1C6A
BOAPLOT             1802
BOAPLOT:PASS        182C
BOAPLOT:PLAYER1     182A
BOXCOL              1E04
BOXFCOL             0
BOXINIT             1304
BOXNCOL             7
BOXNROW             6
BOXPCOL             AA0000
BOXPLOT             1316
BOXPLOT:EMPTY       13A2
BOXPOSX             1E08
BOXPOSY             1E0A
BOXRAD              2D
BOXROW              1E06
CHECK_DIAGONALS     1792
CHECK_DIAGONALS:LOOP_DIA  17C6
CHECK_DIAGONALS:PLAYERWINS_DIA  17B4
CHKCOL              1638
CHKCOL:CHECK_NEXT_COL  1644
CHKCOL:CHECK_POSITION_COL  164A
CHKCOL:LOOP_COL     168E
CHKCOL:PLAYERWINS_COL  167C
CHKDIA              16FE
CHKDIA:FINISH_DIA   178C
CHKDIA:LOOP1        1714
CHKDIA:LOOP2        1734
CHKDIA:LOOP_DIAGONALS_ROW1  1710
CHKDIA:LOOP_TO_OTHER_SIDE  170C
CHKDIA:MINUS1       1776
CHKDIA:PASS_DIA     1778
CHKROW              169E
CHKROW:CHECK_NEXT_ROW  16AA
CHKROW:CHECK_POSITION_ROW  16B0
CHKROW:LOOP_ROW     16EE
CHKROW:PLAYERWINS_ROW  16DC
ENDINIT             1A96
ENDPLOT             1AE8
ENDPLOT:DONE        1B14
ENDPLOT:PLAYER2_WIN  1B0E
ENDPLOT:TXT1        1B38
ENDPLOT:TXT2        1B52
ENDUPD              1AAE
ENDUPD:CONT         1AC6
ENDUPD:DONE         1AE6
FALLING             1E18
FILE                1000
FILEID              1E4C
FILEINIT            1B6C
FILEINIT:LOOP1      1B78
GAMINIT             1838
GAMPLOT             1894
GAMPLOT:PLOT_NEXT_COL  18A0
GAMPLOT:PLOT_NEXT_ROW  18B0
GAMPLOT:TXT         18EE
GAMUPD              1850
GAMUPD:CONT         1874
GAMUPD:CONTINUE     188E
GAMUPD:DONE         1892
INDEXREAD           1ECE
ISCINIT             18FC
ISCPLOT             193E
ISCPLOT:DONE1       196E
ISCPLOT:DONE2       1986
ISCPLOT:LOOP        1960
ISCPLOT:TXT1        198C
ISCPLOT:TXT2        1996
ISCPLOT:TXT3        19B8
ISCPLOT:TXT4        19EB
ISCPLOT:TXT5        1A08
ISCPLOT:TXT6        1A31
ISCPLOT:TXT7        1A68
ISCPLOT:TXTLST      1A7E
ISCUPD              1904
ISCUPD:CONT         191C
ISCUPD:DONE         193C
KBDDOWN             28
KBDEDGE             1ED1
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1140
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              114E
KBDUPD:LOOP         1192
KBDUPD:PACK         118E
KBDUPTN             1
KBDVAL              1ED0
PIEFALL             15AA
PIEFALL:END         1608
PIEFALL:PASS        1602
PIEFCOL1            FF
PIEFCOL2            FFFF
PIEFCOL3            3FEB1D
PIEINIT             13FE
PIEPCOL1            AA
PIEPCOL2            AAAA
PIEPCOL3            0
PIEPLOT             1522
PIEPLOT:COLOR1      1552
PIEPLOT:COLORWINNER  156E
PIEPLOT:JUMP        1586
PIEPOSX             1E0C
PIEPOSY             1E0E
PIERAD              23
PIEUPD              1438
PIEUPD:CHKRIGHT     1482
PIEUPD:CHKSPACE     1498
PIEUPD:DONE         14BC
PIEUPD:DONE2        14C2
PIEUPD:PASS1        1466
PIEVELX             1E10
PIEVELY             1E12
PLAINIT             17D2
PLAUPD              17E2
PLAUPD:PLAYER2      17F8
POSX                1E14
POSY                1E16
PRESSLEFT           14C8
PRESSLEFT:DONELEFT  14F2
PRESSRIGHT          14F4
PRESSRIGHT:DONERIGHT  1520
READED              1E50
READFILE            1B92
READFILE:LOOP2      1BB0
ROW1                1E1A
ROW2                1E21
ROW3                1E28
ROW4                1E2F
ROW5                1E36
ROW6                1E3D
SCRCYCCT            1ED3
SCRFPS              3C
SCRHEIGH            2D0
SCRINIT             10D4
SCRINTCT            1ED2
SCRINTN             1
SCRPLOT             1118
SCRTIM              1132
SCRUPTN             0
SCRWIDTH            3C0
SNDFALL             1
SNDINIT             104C
SNDINIT:DONE        106A
SNDINIT:LOOP        1058
SNDINIT:SNDFALL     1082
SNDINIT:SNDLIST     10AE
SNDINIT:SNDMOVE     1070
SNDINIT:SNDMUSIC    10A0
SNDINIT:SNDWIN      1094
SNDMOVE             0
SNDMUSIC            3
SNDPLAY             10C2
SNDPLTN             2
SNDWIN              2
STACUR              1E48
STAEMPTY            1DD6
STAINIT             1D3C
STANEXT             1E4A
STANONE             FFFFFFFF
STAPLOT             1DAA
STAPLOT:PLTTBL      1DC6
START               1DD8
START:LOOP          1DE4
START:WINT          1DEA
STAUPD              1D4C
STAUPD:DOUPD        1D72
STAUPD:INITBL       1D8A
STAUPD:UPDTBL       1D9A
SYSINIT             1012
TABFCOL             AA0000
TABINIT             13A8
TABINIT:LOOP        13B6
TABPCOL             FF0000
TABPLOT             13C6
TIMER               1E46
TURN                1E44
UTLCHRWD            8
UTLINIT             119C
UTLPRINT            11B2
UTLPRINT:ENDLOOP    11C4
UTLPRINT:LOOP       11BA
UTLRAND             11E4
UTLRAND:RANDVEC     1202
UTLRNDIX            1302
WINNER              1E45
